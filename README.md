# atolchat.github.io
Wireless Network Engineering Software

Task Automation Guide

Version 3.5.0

AT350_TAG_E3

Atoll 3.5.0 Task Automation Guide
Release: AT350_TAG_E3 (March 2022)
© Copyright 1997-2022 Forsk. All Rights Reserved.
Published by:
Forsk
7 rue des Briquetiers
31700 Blagnac, France
Tel: +33 562 747 210
Fax: +33 562 747 211
The software described in this document is provided under a license agreement. The software may only be used or copied under the terms and
conditions of the license agreement. No part of the contents of this document may be reproduced or transmitted in any form or by any means
without written permission from the publisher.
The software shall be used by a human user in interactive mode, or in autonomous batch mode via scripts as described in the software
documentation. Licensee shall not drive or activate the software through a robot or through an external application that is not part of the
software.
The product or brand names mentioned in this document are trademarks or registered trademarks of their respective registering parties.
Third party services that are not part of Atoll are governed by the terms and conditions of their respective providers, which are subject to change
without notice.
The publisher has taken care in the preparation of this document, but makes no expressed or implied warranty of any kind and assumes no
responsibility for errors or omissions. No liability is assumed for incidental or consequential damages in connection with or arising out of the
use of the information contained herein.

Atoll 3.5.0 Task Automation Guide
Table of Contents

AT350_TAG_E3

Table of Contents

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
1

Getting Started . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
1.1

Supported Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

1.2
1.2.1
1.2.2
1.2.3
1.2.4
1.2.5

on page 24Script Tutorial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
Writing a VBScript File. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .16
Testing the Script . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .16
Scheduling the Script. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .17
Debugging the Script . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .17
Error Management. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .17

1.3
1.3.1
1.3.2
1.3.3

Macro Tutorial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Adding Macros to Atoll . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .19
Running a Macro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .21
Saving a List of Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .21

1.4

Windows Script Host, 32-bit vs 64-bit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

2

Object Model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
2.1

Interfaces Implemented by Objects. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

2.2
2.2.1
2.2.2

Properties and Methods Provided by Objects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .24
Error Information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .25

3

Application Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
3.1

How to Access the Application Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

3.2

Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.3

Parent . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.4

Active . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.5

Active . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

3.6

Documents . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

3.7

Name. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

3.8

FullName. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

3.9

Path . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

3.10

ActiveDocument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

3.11

WindowStatus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

3.12

WindowStatus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

3.13

StatusBar . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

3.14

Visible . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

3.15

Visible . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

3.16

Version . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

3.17

Quit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

3.18

LogMessage. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

3.19

CreatePropertyContainer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

3.20

IniFileFullPath. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

3.21

IniFileFullPath. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

© 2022 Forsk. All Rights Reserved.

3

Atoll 3.5.0 Task Automation Guide
Table of Contents

3.22

GetOption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

3.23

SetOption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

3.24

Sleep . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

3.25

SetAddinInfoEx. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

3.26

OLENotRespondingDialog . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

3.27

OLEBusyDialog. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

3.28

OLEMessagePendingDelay. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

3.29

GetProperty. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

3.30

SetProperty . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38

3.31

CreateCoordinateSystem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38

3.32

MacroFullName . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38

3.33
3.33.1
3.33.2
3.33.3
3.33.4
3.33.5
3.33.6
3.33.7
3.33.8
3.33.9
3.33.10
3.33.11
3.33.12
3.33.13
3.33.14
3.33.15
3.33.16
3.33.17

Application Events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillQuitApp . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
DocumentOpenComplete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillCloseDocument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillSaveDocument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
DocumentSaveComplete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
DocumentNewComplete. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillRefreshDocument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
RefreshDocumentComplete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillArchiveDocument. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
ArchiveDocumentComplete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillRun . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
RunComplete. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
LicenceAcquireComplete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
LicenceReleaseComplete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillNewDocumentFromDatabase. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
WillUpgradeDocument. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
DocumentUpgradeComplete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

Documents Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
4.1

How to Access a Documents Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

4.2

Count . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.3

Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.4

Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.5

Parent . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.6

Open . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

4.7

Add . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

4.8

OpenFromDatabase. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

4.9

CloseAll . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

4.10

SaveAll . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

5

4

38
39
39
39
40
40
40
40
40
41
41
41
42
42
43
44
44
44

Document Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
5.1

How to Access a Document Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

5.2

Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

5.3

Parent . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

5.4

FullName. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

5.5

Name . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

5.6

Path . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

5.7

ReadOnly . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

5.8

Saved. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

5.9

CoordSystemProjection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Table of Contents

AT350_TAG_E3

5.10

putref_CoordSystemProjection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

5.11

CoordSystemDisplay . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

5.12

putref_CoordSystemDisplay. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56

5.13

CoordSystemInternal. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56

5.14

TransmissionUnit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56

5.15

TransmissionUnit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56

5.16

ReceptionUnit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

5.17

ReceptionUnit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

5.18

DistanceUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

5.19

DistanceUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

5.20

Close . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

5.21

FilePrint. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

5.22

Save. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

5.23

Refresh . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

5.24

Archive . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

5.25

Run . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

5.26

SetConfig . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

5.27

Import . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

5.28

GetRecords. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

5.29

Redraw . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61

5.30

CenterMapOn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61

5.31

GetRootFolder . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

5.32

RunPathloss . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

5.33

GetService . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

5.34

ExportConfig. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

5.35

GetCommandDefaults . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

5.36

InvokeCommand . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

5.37

RadiatedPowerUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

5.38

RadiatedPowerUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

5.39

AntennaGainUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

5.40

AntennaGainUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

5.41

HeightOffsetUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

5.42

HeightOffsetUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66

5.43

DatabaseConnectionString. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66

5.44

HasRunningTask . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66

5.45

RunEx . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66

5.46

DatabaseSchemaString . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

5.47

DisplayApplicationDialogues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

5.48

DisplayApplicationDialogues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

5.49

PutDatabaseSchemaString . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

5.50

PutDatabaseConnectionString. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

5.51

ChangeDatabaseConnection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

5.52

TemperatureUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

5.53

TemperatureUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

5.54

GetDocumentProperties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

5.55

SetDocumentProperties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

5.56

RadioTableNames . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

5.57

LogMessage. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

5.58

GetProperty . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

© 2022 Forsk. All Rights Reserved.

5

Atoll 3.5.0 Task Automation Guide
Table of Contents

5.59

6

TabularData Object. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
6.1

How to Access a TabularData Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

6.2

ColumnCount . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

6.3

RowCount . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

6.4

Edit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

6.5

AddNew. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

6.6

Update . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

6.7

Delete . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

6.8

GetValue . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

6.9

SetValue . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80

6.10

GetPrimaryKey . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

6.11

FindPrimaryKey . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

6.12

Find . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82

6.13

GetFormattedValue . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83

6.14

CancelUpdate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83

6.15

ColumnNumber . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83

6.16

CanEdit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

6.17

CanAddNew . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

6.18

CanFilterSort. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

6.19

Filter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

6.20

Filter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

6.21

Sort . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

6.22

Sort . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

6.23

GetOriginalValue . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

6.24

RowStatus. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87

6.25

Columns . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87

6.26

SetValues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88

6.27

ITabularData5::get_HasGUIRights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89

7

Zones and Predictions Tabular Data Objects . . . . . . . . . . . . . . . . . . . . . . . 91
7.1

Zones Tabular Data Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91

7.2

Predictions Tabular Data Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92

8

6

SetProperty . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72

CoordSystem Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
8.1

How to Access a CoordSystem Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95

8.2

Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

8.3

ConvertCoordsTo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

8.4

Datum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97

8.5

DatumName . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97

8.6

Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97

8.7

Ellipsoid. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

8.8

EllipsoidName . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

8.9

Name . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

8.10

Pick . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

8.11

ProjMethod . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

8.12

ProjParameter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

8.13

SetDatum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

8.14

SetProjection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

8.15

Unit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Table of Contents

AT350_TAG_E3

9

ChildFolder Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .101
9.1

How to Access a ChildFolder Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102

9.2

Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102

9.3

Parent . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

9.4

Name. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

9.5

Name. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

9.6

Count. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

9.7

Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

9.8

_NewEnum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

9.9

Visible . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

9.10

Visible . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105

9.11

Selected . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105

9.12

Selected . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106

9.13

Export . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106

9.14

CentreOnMap . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108

9.15

Redraw . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108

9.16

AddChild . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

9.17

Remove . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

9.18

position . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

9.19

position . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

9.20

Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

9.21

dispatch . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

9.22

ObjectKind . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

9.23

GetProperty . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

9.24

SetProperty. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

9.25

GetPropertiesInfo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

9.26

PropertyIsPropertyContainer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

9.27

PropertyIsTabularData . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

9.28

LoadProperties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

9.29

SaveProperties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

9.30

RemoveItem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

9.31

SetCustomIcon . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

9.32

OpenPropertySheet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

9.33

IChildFolder9::get_UniqueID . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

10

PropertyContainer Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .117

10.1

Get . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117

10.2

Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

10.3

GetInfo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

10.4

IsPropertyContainer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

10.5

IsTabularData. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

10.6

Load. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

10.7

Save. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

10.8

RemoveAll. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

10.9

Remove . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

11

ChildFolder Object Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .121

11.1

How to Access ChildFolder Object Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121

11.2
11.2.1

Common ChildFolder Object Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
Group, Filter, and Sort Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

© 2022 Forsk. All Rights Reserved.

7

Atoll 3.5.0 Task Automation Guide
Table of Contents

11.3

Predictions Folder Properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

11.4
11.4.1
11.4.2
11.4.3
11.4.4
11.4.5
11.4.6

Coverage Prediction Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
General Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
Non-Simulation-based Coverage Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
Simulation-based Coverage Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130
Shadowing and Indoor Coverage Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
KPI Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
Display Properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133

11.5

GSM Simulation Group Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135

11.6

UMTS Simulation Group Properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136

11.7

WiMAX and LTE Simulation Group Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137

11.8

Multi-RAT Simulation Group Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

11.9

Standard Propagation Model Properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

11.10

CW Measurement Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141

11.11

Drive Test Data Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142

11.12

Custom ChildFolder Object Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142

11.13

Master Link Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

11.14

Link Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

11.15
11.15.1

Vector Layer Properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
Display Properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144

11.16

Online Map Properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145

11.17

Multi-point Analysis Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146

12

8

ChildFolder Feature Objects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147

12.1
12.1.1
12.1.2
12.1.3
12.1.4
12.1.5

Clutter Feature Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
How to Access the Clutter Feature Object. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
Source. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
ClassAttributes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
DefaultAttributes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
Accessing Clutter Class Attributes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149

12.2
12.2.1
12.2.2
12.2.3
12.2.4
12.2.5

Traffic Feature Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
How to Access the Traffic Feature Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
Source. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
ScenarioProvider . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
ExportCumulatedTraffic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
HasTrafficForService . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152

12.3
12.3.1
12.3.2

UMTS Traffic Scenario Provider Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
GetMeanSize . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
Create . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153

12.4
12.4.1
12.4.2
12.4.3
12.4.4
12.4.5

Environment Based Traffic Map Feature Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
How to Access Environment Based Traffic Map Feature Objects . . . . . . . . . . . . . . . . . . . . . . . 155
Source. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
ClassAttributes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
DefaultAttributes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
Accessing Environment Based Traffic Maps Attributes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 156

12.5
12.5.1
12.5.2
12.5.3
12.5.4
12.5.5
12.5.6
12.5.7

Simulation Feature Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157
How to Access Simulation Feature Objects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157
Source. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
Statistics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
Cells. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
Sites . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159
Mobiles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159

12.6

Simulation Group Feature Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Table of Contents

AT350_TAG_E3

12.6.1
12.6.2
12.6.3
12.6.4
12.6.5
12.6.6

How to Access Simulation Group Feature Objects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
MeanSimulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
StdDevSimulation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Accessing Mobiles, Cells, Sites, for Simulations and Simulation Groups . . . . . . . . . . . . . . . . .

160
161
162
162
162
163

12.7
12.7.1
12.7.2
12.7.3
12.7.4

Multi-RAT Simulation Group Feature Object. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
MeanSimulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
StdDevSimulation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

166
166
167
167
167

12.8
12.8.1
12.8.2
12.8.3
12.8.4
12.8.5
12.8.6
12.8.7
12.8.8
12.8.9
12.8.10
12.8.11
12.8.12
12.8.13
12.8.14
12.8.15
12.8.16
12.8.17
12.8.18

GSM Interference Matrix Feature Object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
How to Access GSM Interference Matrix Feature Objects. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Load . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
CompleteScopeInfo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Active . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Active . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Type . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Type . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
BasedOnTraffic. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
BasedOnTraffic. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Resolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Resolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
StdDev . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
StdDev . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
InfoQuantityIndicator. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
InfoQuantityIndicator. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
CdfTab . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

168
169
169
169
169
170
170
170
171
172
172
172
173
173
173
173
174
174
174

13

Document Commands . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .177

13.1

How to Invoke a Document Command . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178

13.2

IMPORTXML. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178

13.3

EXPORTXML. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179

13.4

APPENDTABLECOLUMN . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179

13.5

IMPORTVECTORFILE. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181

13.6

IMPORTRASTERFILE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181

13.7

CALCULATEPOINTS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182

13.8

IMPORTTESTMOBILEDATA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183

13.9

RUNNEIGHBOURALLOCATION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183

13.10

RUNINTERTECHNOLOGYNEIGHBOURALLOCATION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184

13.11

RUNINTRACARRIERNEIGHBOURALLOCATION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185

13.12

RUNINTERCARRIERNEIGHBOURALLOCATION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 186

13.13

CLONESTUDY. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187

13.14

DUPLICATESTUDY. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187

13.15

COMPARESTUDY. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188

13.16

CALCULATEEQUIPMENTLOSSES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188

13.17

CALCULATEREPEATERS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189

13.18

CALCULATEREMOTEANTENNAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190

13.19

EXPORTACTIVESETANALYSIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190

13.20

CALCULATEPOINTSECI0 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193

13.21

RUNALLCARRIERSALLOCATION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194

© 2022 Forsk. All Rights Reserved.

9

Atoll 3.5.0 Task Automation Guide
Table of Contents

13.22

RUNMASTERCARRIERALLOCATION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195

13.23

MWRUN. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195

13.24

EXPORTMAPWINDOW . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204

13.25

IMPORTPLANETDATAFILE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205

13.26

EXPORTMWLINKANALYSISPROFILEPICTURE. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206

13.27

GETPOWERMODE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 207

13.28

SETPOWERMODE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 207

13.29

APPENDVECTORDATACOLUMN . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 208

13.30

LOADSAVEPRINTSETUP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 208

13.31

CALCULATEPATHLOSS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209

13.32

MWLINKSCUSTOMEXPORT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210

13.33

ARCHIVETODATABASE. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210

13.34

REFRESHFROMDATABASE. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 211

13.35

MWCALCULATEPROFILES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 211

13.36

RUNBEAMUSAGECALCULATION. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 212

14

Enumerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215

14.1
14.1.1
14.1.1.1
14.1.1.2
14.1.1.3
14.1.1.4
14.1.1.5
14.1.1.6
14.1.1.7
14.1.1.8
14.1.1.9
14.1.1.10
14.1.1.11
14.1.1.12
14.1.1.13
14.1.1.14
14.1.1.15
14.1.1.16
14.1.1.17

14.1.2
14.1.2.1
14.1.2.2
14.1.2.3

10

Enumerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
Atoll Type Library Enumerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
AtoSaveStatus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
AtoSaveChanges . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
AtoRefreshPriority . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
AtoArchiveStatus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
AtoWindowStatus. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
AtoLogType . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
AtoCompareOp . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
AtoTransmissionUnit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
AtoReceptionUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
AtoDistanceUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
AtoRadiatedPowerUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
AtoAntennaGainUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
AtoHeightOffsetUnit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
AtoRootType . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
AtoRowFilter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
AtoRowStatus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
AtoTemperatureUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218

FSKGISLib Type Library Enumerations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
GeographicUnit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
ProjectionMethod. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
ProjParameterIndices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Introduction

AT350_TAG_E3

Introduction

This Task Automation Guide is aimed at advanced administrators who plan to write scripts or macros to enhance
the functionalities that are available in Atoll.
This manual assumes that the reader has an advanced knowledge of Atoll and radio network planning and is
familiar with Microsoft script technologies and the VBScript language in particular.

About Atoll
Atoll is a multi-technology wireless network design and optimisation platform that supports wireless operators
throughout the network lifecycle, from initial design to densification and optimisation. Atoll offers unique
capabilities of using both predictions and live network data throughout the network planning and optimisation
process.
Atoll includes integrated single RAN–multiple RAT network design capabilities for both 3GPP and 3GPP2 radio
access technologies including 5G NR, LTE, NB-IoT, UMTS, GSM, and CDMA. It provides operators and vendors with
a powerful framework for designing and optimising current and future integrated multi-technology networks.
Atoll supports the latest technology advances such as massive MIMO, 3D beamforming, and mmWave propagation
for the design and roll-out of 5G networks.
Atoll Microwave is a state-of-the-art point-to-point and point-to-multipoint backhaul planning and optimisation
software. It allows designing large microwave link networks, according to ITU recommendations, industry
standards, and operator guidelines.
Atoll’s integration and customisation features help operators smoothly streamline planning and optimisation
processes. Atoll supports a wide range of implementation scenarios, from standalone to enterprise-wide serverbased configurations. Atoll has become the industry standard for radio network planning and optimisation.
If you are interested in learning more about Atoll, please contact your Forsk representative to inquire about our
training solutions.

About Forsk
Forsk is an independent software company providing operators and vendors with wireless network design and
optimisation products. Atoll, Forsk’s flagship product, is the market-leading wireless network planning and
optimisation software on the market; it allows operators to streamline planning and optimisation activities by
combining predictions and live network data.
With more than 9000 active licenses installed with 500+ customers in 140 countries, Atoll has become the industry
standard for wireless network design and optimisation.
Forsk distributes and supports Atoll directly from offices and technical support centres in France, USA, and China
as well as through a worldwide network of distributors and partners.

© 2022 Forsk. All Rights Reserved.

11

Atoll 3.5.0 Task Automation Guide
Introduction

Getting Help
The online help system that is installed with Atoll is designed to give you quick access to the information you need
to use the product effectively. The Online Help system provides information and guidance for using Atoll as well as
context-sensitive help about elements of the user interface. It contains the same material as the Atoll 3.5.0 User
Manual.
You can open the Online Help in Atoll from the Help menu or you can get context-sensitive help about any dialog
box by pressing F1 or clicking ’?’.
You can browse the online help from the Contents view, the Index view, or you can use the built-in Search feature.
You can click the Feedback button at the bottom of each page to send comments and suggestions to Forsk to help
us improve our documentation. Do not use the Documentation Feedback form for help using the product or for
technical support.
You can also download Atoll documentation from the Forsk web site at:
http://downloads.forsk.com/

About Atoll Documentation
PDF manuals are available to customers with a valid maintenance contract and can be downloaded from the Forsk
web site at:
http://downloads.forsk.com/
To read PDF manuals, download Adobe Reader from the Adobe web site at:
http://get.adobe.com/reader/

Contacting Technical Support
Forsk provides global technical support for its products and services. To contact the Forsk support team, visit the
Forsk web site at:
http://downloads.forsk.com
Alternatively, depending on your geographic location, contact one of the following support teams:
Forsk US
For North and Central America, contact the Forsk US support team:


Tel.: 1-888-GO-ATOLL (1-888-462-8655)



Fax: 1-312-674-4822



Email: support_us@forsk.com

Opening Hours: Monday to Friday 8.00 am to 8.00 pm (Eastern Standard Time)
Forsk China
For Asia (except Japan), contact the Forsk China support team:


Tel: +86 20 8557 0016



Fax: +86 20 8553 8285



Email: atollsupport@forsk.com.cn

Opening Hours: Monday to Friday 9.00am to 5.30pm (GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi.

12

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Introduction

AT350_TAG_E3

Forsk Head Office
For all other regions, contact the Forsk Head Office support team:


Tel.: +33 562 747 225



Fax: +33 562 747 211



Email: support@forsk.com

Opening Hours: Monday to Friday 9.00 am to 6.00 pm (GMT +1:00)

© 2022 Forsk. All Rights Reserved.

13

Atoll 3.5.0 Task Automation Guide
Introduction

14

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

AT350_TAG_E3

1 Getting Started
Atoll provides an application programming interface that enables you to extend and customise Atoll.

q

The software license agreement states that Atoll shall be used only by a human
user in interactive mode, or in autonomous batch mode as described in the current
documentation. You are not allowed to drive or activate Atoll through a robot or
through an external application that is not part of the Atoll.
If you are in doubt whether your extension or customisation complies with the Forsk
Software License Agreement, contact your Forsk representative.

If you plan to write scripts or macros, you must be familiar with Microsoft Windows Script Technologies, especially
with the VBScript language.
You can start by:
◼

Going through the section "Supported Extensions" on page 15 to learn which types of extensions can be
developed.

◼

Reading the following tutorials before starting your own development:
◼

"on page 24Script Tutorial" on page 15,

◼

"Macro Tutorial" on page 19,

1.1 Supported Extensions
The following types of extensions are available.
◼

Scripts
A script is a sequence of VBScript statements in a text file, executable from outside Atoll (Windows Script
Host). Scripts allow task automation in Atoll when no interaction with the user is needed. Scripts do not require
any setup and are specially useful for scheduling tasks in batch mode. Scripts use COM inter-process
communication for communicating with Atoll.
Several scripts are available for download at www.forsk.com.

◼

Macros
A macro is a sequence of VBScript statements in a text file, executable from within Atoll. Macros allow task
automation in Atoll. Macros may interact with the user, but the interaction is limited by VBScript. Macros must
be added to Atoll in order to be available for execution. They can be saved in Atoll user configuration files.
Macro commands can be added to toolbars. Macros use COM in-process communication for communicating
with Atoll.
Several macros are available for download at www.forsk.com.

1.2

on page 24

Script Tutorial

Through this tutorial, you will learn to automate some simple tasks, such as archiving data to databases, running
calculations, and executing scripts on a scheduled time.

© 2022 Forsk. All Rights Reserved.

15

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

1.2.1

Writing a VBScript File
Open a text editor, and type in the following code:
Option Explicit
Dim var
Dim myapp
Dim doc
Sub Atoll_RunComplete(arg1, arg2)
var = 1
End Sub
Set myapp = CreateObject("Atoll.Application")
WScript.ConnectObject myapp, "Atoll_"
myapp.Visible = False
Set doc = myapp.Documents.OpenFromDatabase(
"Provider=SQLOLEDB.1;Integrated Security=SSPI;Initial Catalog=myAtollDbName;Data Source=myServer", "dbo;<ALL>;")
doc.Run True
var = 0
Do While var = 0
WScript.Sleep 1000
Loop
doc.Save("C:\mydoc.atl")
WScript.DisconnectObject myapp
doc = Null
Const atoSaveNo = 0
myapp.Documents.CloseAll atoSaveNo
myapp.Quit atoSaveNo
myapp = Null
WScript.Quit 0
You must replace all the parameters beginning with "my" with your own values in the above connection string. This
script:
1. Starts an invisible session.
2. Opens a new document from an existing database.
3. Runs all the calculations in this document.
4. Waits for the end of calculations.
Event RunComplete is thrown when calculations are done. The syntax for catching any event is to concatenate
the name of the event to the string "Atoll_". As these parameters have not been used in the above example,
they have been named "arg1" and "arg2". Moreover, we connect and disconnect the script using the
appropriate method of WScript.
5. Saves the document.
6. Exits the Atoll session.
Save your script file as a VBScript file, for example “C:\Atollmacros\tutorial.vbs”.

1.2.2

Testing the Script
To test the script:
1. Double-click the C:\Atollmacros\tutorial.vbs file in Windows Explorer.

16

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

AT350_TAG_E3

2. Check a few minutes later whether “C:\TEMP\mydoc.atl” has been created or not.

1.2.3

Scheduling the Script
You can schedule scripts using the Windows Task Scheduler. Usage of the Task Scheduler depends on the version
of Windows.

+

In some cases, scheduled tasks may not be allocated sufficient resources in
Windows, which can cause an "Out of memory" error. To solve this problem,
increase the desktop heap size allocated by performing the following steps:
1. In Windows, run the Registry Editor (regedit.exe).
2. Locate and select the following registry subkey:
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
Manager\SubSystems
3. Right-click the Windows entry and select Modify.
4. In the Value data section of the Edit String dialog box, locate the
SharedSection entry and increase the third value for this entry from 768 to
2048.
If the problem persists, it might be necessary to increase the desktop heap size
even further. You can do so in increments of 2048 (2048, 4096, 6144, and so on) up
to a maximum value of 20480.
For more information, see the following Microsoft support article:
https://support.microsoft.com/en-gb/help/947246

1.2.4

Debugging the Script
To debug the script, use a command prompt console and the wscript "//X" command line option:
wscript tutorial.vbs //X
You will be prompted for the debugger you want to use. Microsoft provides a specialised script debugger to debug
VBScript code, which is available in the free downloads section of Microsoft’s website. You can set breakpoints and
inspect the contents of variables using this debugger.
While debugging, you can temporarily make Atoll visible on the desktop using:
Myapp.Visible = True

1.2.5

Error Management
It is important to check for any error that might occur during the execution of the script. Microsoft Visual Basic
scripting language provides "On Error Resume Next" along with the "Err" object to manage errors. Here is our sample
script with error management:
Option Explicit
Dim var
Dim myapp
Dim doc
On Error Resume Next

© 2022 Forsk. All Rights Reserved.

17

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

Sub CatchError
If Err Then
myapp.LogMessage Err.Description, 1
WScript.Echo Err.Description
End If
WScript.Echo "Script failed."
myapp.LogMessage "Script failed.", 1
Const atoSaveNo = 0
If IsObject(doc) Then
doc.Close atoSaveNo
doc = Null
End If
If IsObject(myapp) Then
myapp.Documents.CloseAll atoSaveNo
myapp.Quit 0
myapp = Null
End If
WScript.Quit -1
End Sub
Sub Atoll_RunComplete(arg1, arg2)
var = 1
End Sub
Set myapp = CreateObject("Atoll.Application")
If Err Then
WScript.Echo "Can't create 'Atoll.Application' object."
Err.Clear
Call CatchError
End If
WScript.ConnectObject myapp, "Atoll_"
myapp.Visible = False
Set doc = myapp.Documents.OpenFromDatabase(
"Provider=SQLOLEDB.1;Integrated Security=SSPI;Initial Catalog=myAtollDbName;Data Source=myServer", "dbo;<ALL>;")
If Err Then Call CatchError End If
doc.Run True
If Err Then Call CatchError End If
var = 0
Do While var = 0
WScript.Sleep 1000
Loop
doc.Save("C:\mydoc.atl")
If Err Then Call CatchError End If
WScript.DisconnectObject myapp
doc = Null
myapp.Documents.CloseAll atoSaveNo
myapp.Quit atoSaveNo
myapp = Null
WScript.Quit 0

18

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

AT350_TAG_E3

Error checking is activated with "On Error Resume Next". When an error occurs, the script continues execution from
the next line and the "Err" object is set accordingly. You can check for Err.Number, or for Err (because Number is its
default property) to catch any error.

1.3 Macro Tutorial
Macros are run by Atoll upon being invoked by the user. Macros are written in VBScript, like scripts. The difference
between scripts and macros is the execution context.
When a macro is launched from Atoll, an instance of an Atoll Application object is automatically added as a scriptlevel variable available to the macro code. Therefore, CreateObject or GetObject to access an Application object
must not be called.
The first line of your macro can be directly:
mydoc = Atoll.ActiveDocument
The script-level variable name for the Atoll Application object is "Atoll" and it is optional. So, the above line is
equivalent to:
mydoc = ActiveDocument
Macros can also be invoked in response to application events.
Example
Sub Atoll_DocumentSaveComplete(doc)
LogMessage "Archive on save running ..."
Dim status
On Error Resume Next
status = doc.Archive
Const atoError = 1
Const atoArchiveCanceled = 1
If Err.Number <> 0 Then
LogMessage "Archive on save failed. " & Err.Description & ".", atoError
Else
If status = atoArchiveCanceled Then
LogMessage "Archive on save failed.", atoError
LogMessage "You must resolve the conflicts manually.", atoError
MsgBox
manually."

"Archive

on

save

failed.

You

must

resolve

the

conflicts

Else
LogMessage "Archive on save completed successfully."
End If
End If
End Sub
The above example shows a macro used to automatically archive a document once it has been saved.

1.3.1

Adding Macros to Atoll
You can add a macro to your Atoll session as follows:

© 2022 Forsk. All Rights Reserved.

19

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

1. Select Tools > Add-ins and Macros. The Add-ins and Macros dialogue opens.
2. Under Macros, click the Add button.
Browse for your script file. You can create a new macro file by typing a name for the new (empty) macro file
in the file selection box. Atoll will initialize this new file with minimal VBScript script. Atoll interprets your file
and lists all public macros found in the file in an explorer.
If you create an empty macro file, it is initialised with the following code:
Public Sub Main
End Sub
You can then edit the file and add any command in the sub Main, or add another sub and execute it..
3. Expand the explorer entry, select a macro and click the Run button to start the macro.
To edit a macro file:
1. Under Macros, select the macro in the list of macros.
2. Click the Edit button. The macro file is opened in the default editor.
3. Modify the code.
4. Save the file.
5. Close the file editor
6. In the Add-ins and Macros dialogue, click the Refresh button. Atoll will update the macro.

Figure 1.1: Adding Macros in Atoll
To associate an icon file to a macro:
1. Under Macros, select the macro in the list of macros.
2. Click the Icon button.
3. Select the icon file to be used for the macro.
A toolbar button is added for the macro in Atoll, which you can click to run the macro.
For macros returning values, only functions, and not subroutines, may be defined. This is the case, for example, of
all "OnWill…" calls as the returned value, the status value, allows the user to bypass the standard behaviour.
For functions, the name of the returned value is the same as the name of the function:
Function Atoll_WillRun(doc, success)
doc.Save
Atoll_WillRun = False ‘ Intercepts the run order and cancels
‘ it by returning False
End Function

20

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

AT350_TAG_E3

1.3.2

Running a Macro
To run a macro:
◼

Select a macro in the Add-ins and Macros dialogue and click Run, or

◼

Select a macro in the Add-ins and Macros dialogue and double-click it, or

◼

Click the macro’s button in the toolbar.

If a problem occurs during the macro execution, an error message is displayed in a dialogue box with the line
number indicated. The same message is also logged in the Atoll Event Viewer.

1.3.3

Saving a List of Macros
Once macros have been added to an Atoll session, they can be saved in a configuration file. If no document is open
in Atoll, you can still use the Tools > User Configurations > Save command for saving the macros in the
configuration file.
Similar to all other configuration file contents, if the configuration file is named Atoll.cfg and is stored at the same
location as Atoll.exe, Atoll will always be started with the list of macros saved in this configuration file. Macros will
be available even if no Atoll document is open. For more information on configuration files, please refer to the
Administrator Manual.

1.4 Windows Script Host, 32-bit vs 64-bit
Microsoft Windows Script Host is used to run scripts.
On a 64-bit OS, there is a 32-bit and a 64-bit version of Windows Script Host available. Both can be used to script
Atoll. The Atoll version used by a script depends on the Atoll versions installed (32/64 bit) and on the Windows Script
Host version used to run the script.
The following table shows the Atoll version launched by Windows Script Host:

Only 32-bit Atoll installed

Only 64-bit Atoll installed

Both 32-bit and 64-bit Atoll
installed

32-bit WSH used to run the
script

32-bit Atoll is launched

64-bit Atoll is launched

32-bit Atoll is launched

64-bit WSH used to run the
script

32-bit Atoll is launched

64-bit Atoll is launched

64-bit Atoll is launched

You need to explicitly use 32-bit or 64-bit Windows Script Host on machines where both 32-bit Atoll and 64-bit Atoll
are installed.

© 2022 Forsk. All Rights Reserved.

21

Atoll 3.5.0 Task Automation Guide
Chapter 1: Getting Started

22

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 2: Object Model

AT350_TAG_E3

2 Object Model
This chapter describes the Atoll object model. Figure 2.1 on page 23 provides an overview of the Atoll object model.
Application
Documents
Document 1
TabularData 1

Document 2

PropertyContainer 1

TabularData 1
PropertyContainer 2

TabularData 2

TabularData 2

ChildFolder 1

ChildFolder 1

ChildFolder 2

ChildFolder 2

CoordSystem

CoordSystem

Figure 2.1: Atoll Object Model
Atoll exposes a number of objects of various types. These objects provide access to Atoll components through
properties and methods. Properties and methods usually have input and output parameters.
The objects exposed by Atoll are:
Name

Description

Application Object

The Application object provides an entry point for clients to retrieve and navigate
through the Atoll object model.

Documents Object

The Documents object is used to create a new document or to iterate through
open documents in an Atoll session.

Document Object

The Document object provides access to ATL documents and database connections.

TabularData Object

The TabularData object provides access to Atoll tables whether an Atoll document is connected to a database or not. It also provides access to other tables
which are not database tables, such as PREDICTIONS and ZONES.

CoordSystem Object

This object contains the entire definition of a coordinate system.

ChildFolder Object

A ChildFolder object represents an item in the Atoll Explorer window.

PropertyContainer Object

The PropertyContainer object is a generic container containing a set of named
properties of arbitrary types

Transmitter Object

The Transmitter object provides read-only access to antenna patterns, antenna
losses, and some transmitter properties.

© 2022 Forsk. All Rights Reserved.

23

Atoll 3.5.0 Task Automation Guide
Chapter 2: Object Model

2.1 Interfaces Implemented by Objects
Atoll objects provide access to Atoll components through properties and methods.

2.2 Properties and Methods Provided by Objects
Access to Atoll components is available through properties and methods. Properties and methods usually have
input and output parameters.
In the rest of this document, VBS properties and methods of an object "Obj" are described according to their IDL
(Interface Design Language) syntax :
HRESULT Property([out]Parameter par) : Read
HRESULT Property([in]Parameter par) :Write
For reading and writing a property in VBScript, you write:
value = object.property ’for reading a property
object.property = value ’for writing a property
For calling a method, you write:
object.method

2.2.1

Parameters
Properties and methods may have parameters.
Input Parameters
Input parameters are marked with [in]. Input parameters are not mutated by methods or property setters
implementation. Input parameters are specified by value.
Output Parameters
Output parameters are marked with [out]. Output parameters are specified by reference. Upon successful
completion of methods or property getters, the referenced value is changed.
Input/Output Data Types
◼

BSTR
BSTR may be used as a method parameter data type. It is used to specify a character string. In VBScript, it
corresponds to the String data type.

◼

VARIANT
VARIANT may be used as a method parameter data type. It is used to specify values of many different types,
especially arrays. It can be used by VBScript.

24

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 2: Object Model

AT350_TAG_E3

2.2.2

Error Information
When an error is returned by a property or method, an error information context is created and an exception is
thrown. If the script or macro does not use the On Error Resume Next statement, it will be terminated due to the error.
If the script or macro uses the On Error Resume Next statement, the error information is available as properties of
the script-level Err object. For example, Err.Description which provides the error description:
In

Dim strDescription
If Err Then
strDescription = Err.Description
End If

Please refer to the VBScript Language Reference for more information about VBScript, error handling, and the Err
script-level variable.

© 2022 Forsk. All Rights Reserved.

25

Atoll 3.5.0 Task Automation Guide
Chapter 2: Object Model

26

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

3 Application Object
The Application object provides an entry point for clients to retrieve and navigate through the Atoll object model.
◼
◼

The Application object provides the following properties and methods:
Name
Application

Description

Attributes

Returns the Atoll Application object.

Type: Application object
Access: Read

Parent

Returns the Atoll Application object.

Type: Application object
Access: Read

Active
Active

Returns whether the Atoll window is active or
not.

Type: Boolean

Sets the Atoll window active.

Type: Boolean

Access: Read/Write
Access: Read/Write

Documents

Returns the Documents object.

Type: Documents object
Access: Read

Name

Returns the application name. The application Type: String
name is always "Atoll".
Access: Read

FullName

Returns the full path of the executable.

Type: String
Access: Read

Path

Returns the path of the executable.

Type: String
Access: Read

ActiveDocument

Returns the active document.

Type: Document object
Access: Read

WindowStatus

Returns the window status of the Atoll applica- Type: Integer
tion.
Access: Read/Write

WindowStatus

Sets the window status of the Atoll application. Type: Integer
Access: Read/Write

StatusBar

Sets the status bar text of the Atoll application. Type: String
Access: Write

Visible

Returns the application visible state.

Type: Boolean
Access: Read/Write

Visible

Sets the application visible state.

Type: Boolean
Access: Read/Write

Version

Returns the application version.

Type: String
Access: Read

Quit

Quits the application.

LogMessage

Displays a message in the Atoll event observer
window.

CreatePropertyContainer

Returns an empty PropertyContainer object.

IniFileFullPath

Returns the full path to the Atoll initialisation file. Type: String
Access: Read/Write

IniFileFullPath

Sets the full path to the Atoll initialisation file.

Type: String
Access: Read/Write

© 2022 Forsk. All Rights Reserved.

27

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

Name

Description

Attributes

GetOption

Returns an option read from the Atoll initialisation file.

SetOption

Sets an option in the Atoll initialisation file.

Sleep

Suspends the application apartment execution.

SetAddinInfoEx

Reserved for future use.

OLENotRespondingDialog

Enables or disables OLE not responding dialog.

OLEBusyDialog

Enables or disables OLE busy dialog

OLEMessagePendingDelay

Sets the OLE message pending delay.

The Application object fires the following events:
Name

Description

WillQuitApp

Event fired when the user wants to exit an Atoll session.

DocumentOpenComplete

Event fired when a document has been opened.

WillCloseDocument

Event fired when the user wants to close a document.

WillSaveDocument

Event fired when the user wants to save a document.

DocumentSaveComplete

Event fired just after a document has been saved.

DocumentNewComplete

Event fired when a new document has been created.

WillRefreshDocument

Event fired when the user wants to refresh a document from database.

RefreshDocumentComplete

Event fired when a document has been refreshed from database.

WillArchiveDocument

Event fired when the user wants to archive a document to the database.

ArchiveDocumentComplete

Event fired when the document has been archived in database.

WillRun

Event fired when the user wants to start a calculation.

RunComplete

Event fired when the calculation has finished.

LicenceAcquireComplete

This feature enables the user to log Atoll licence token usage from an add-in.

LicenceReleaseComplete

This feature enables the user to log Atoll licence token usage from an add-in.

WillNewDocumentFromDatabase

Fired just before a new document is created from an existing database.

WillUpgradeDocument

Fired when opening a connected document from a previous version of Atoll, just before
upgrading.

DocumentUpgradeComplete

Fired when a connected document from a previous version of Atoll has been upgraded.

3.1 How to Access the Application Object
The application object is the top-level object. Sub-objects are obtained through properties of the application. To get
an application object in VBScript, use one of the following:
Set app = CreateObject("Atoll.Application")
Because Atoll registers itself in the Running Objects Table when an Atoll session is running, you can use:
Set app = GetObject(, "Atoll.Application")

28

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

q

Using GetObject("", "Atoll.Application") (note the difference in the first parameter)
will automatically start a new instance of Atoll if no session is already running and
attach the macro to this new instance.
Each call to GetObject("", "Atoll.Application") will start a new Atoll instance. If this is
not intended, use GetObject(, “Atoll.Application”), which attaches the script to the
first Atoll session started when several sessions are running.

In the context of macros, an instance of the main object Application is automatically added as a global variable of
the macro code. Therefore, it must not call CreateObject or GetObject to get an Application object.
The global variable of type Application object available to macros is named "Atoll".

3.2 Application
Returns the Atoll Application object.
HRESULT get_Application(IApplication **ppVal);
Parameters
[out] ppVal: Address of the IApplication interface pointer used to return the Atoll Application object.

3.3 Parent
Returns the Atoll Application object.
HRESULT get_Parent(IApplication **ppVal);
Parameters
[out] ppVal: Address of the IApplication interface pointer used to return the Atoll Application object.

3.4 Active
Returns whether the Atoll window is active or not.
HRESULT get_Active(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether the Atoll windows application is active or not.
Example
Dim app
Dim act
Set app = CreateObject("Atoll.Application")
act = app.Active
app.Active = True

© 2022 Forsk. All Rights Reserved.

29

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

3.5 Active
Sets the main application window active.
HRESULT put_Active(VARIANT_BOOL aNewVal);
Parameters
[in] aNewVal:
◼

VARIANT_TRUE: Activates the main window application.

Example
See "Active" on page 29.

3.6 Documents
Returns the Documents object.
HRESULT get_Documents(IDocuments **ppDocVal);
Parameters
[out] ppDocVal: Address of the IDocuments interface pointer used to return the Documents object.
Example
Dim app
Dim docs
Set app = CreateObject("Atoll.Application")
Set docs = app.Documents

3.7 Name
Returns the application name. The application name is always "Atoll".
HRESULT get_Name(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the application name.

3.8 FullName
Returns the full path of the executable.
HRESULT get_FullName(BSTR *pVal);

30

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

Parameters
[out] pVal: Address of the BSTR used to return the application full path.
Remarks
The path name returned is the full path, for example, "C:\Program Files\Forsk\Atoll\Atoll.exe".

3.9 Path
Returns the path of the executable.
HRESULT get_Path(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the application path.
Remarks
The path returned is provided as an absolute path, for example, "C:\Program Files\Forsk".

3.10 ActiveDocument
Returns the active document.
HRESULT get_ActiveDocument(IDocument **ppDocVal);
Parameters
[out] ppDocVal: Address of the IDocument interface pointer used to return the Document object.
Example
Dim app
Dim doc
Set app = CreateObject("Atoll.Application")
Set doc = app.ActiveDocument

3.11 WindowStatus
Returns the window status of the Atoll application.
HRESULT get_WindowStatus(enum AtoWindowStatus *pVal);
Parameters
[out] pVal: Address of the AtoWindowStatus enumeration used to return the window status.
Example
Dim app

© 2022 Forsk. All Rights Reserved.

31

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

Dim status
Set app = CreateObject("Atoll.Application")
status = app.WindowStatus
Const atoMinimized = 2
app.WindowStatus = atoMinimized

3.12 WindowStatus
Sets the window status of the Atoll application.
HRESULT put_WindowStatus(enum AtoWindowStatus aNewVal);
Parameters
[in] newVal: The window status.
Example
See "WindowStatus" on page 31.

3.13 StatusBar
Sets the status bar text of the Atoll application.
HRESULT put_StatusBar(const BSTR bstrNewVal);
Parameters
[in] bstrNewVal: The text to display in the status bar.
Example
Dim app
Set app = CreateObject("Atoll.Application")
app.StatusBar = “This is my message”

3.14 Visible
Returns the application visible state.
HRESULT get_Visible(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return the application visible state.
Remarks
When Atoll is not visible, a dialogue that would normally require user input is automatically closed as if the user has
clicked its default button without changing any of the dialogue controls.

32

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

3.15 Visible
Sets the application visible state.
HRESULT put_Visible(VARIANT_BOOL aNewVal);
Parameters
[in] aNewVal:
◼

VARIANT_TRUE: Makes Atoll visible.

◼

VARIANT_FALSE: Hides Atoll.

Remarks
When Atoll is not visible, a dialogue that would normally require user input is automatically closed as if the user has
clicked its default button without changing any of the dialogue controls.

3.16 Version
Returns the application version.
HRESULT get_Version(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the version.
Remarks
The string is formatted like in the Atoll about dialogue, for example, "2.6.1".
Atoll 3.1.0 and above:
The application build number is included in the string, for example, "3.1.0 (Build 3730)"

3.17 Quit
Quits the application.
HRESULT Quit(enum AtoSaveChanges aSaveChanges, enum AtoSaveStatus *pStatus);
Parameters
[in] aSaveChanges:
◼

atoSaveNo: Discards document changes, then closes the application.

◼

atoSaveYes: Saves document changes, then closes the application.

◼

atoSavePrompt: The user is prompted to save document changes, then the application is closed.

[out] pStatus: The AtoSaveStatus enumeration pointer used to return whether changes were successfully saved or
not.
◼

Returns atoSaveCanceled when the user was prompted and has chosen not to save the changes, otherwise
returns atoSaveSucceeded.

© 2022 Forsk. All Rights Reserved.

33

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

Remarks
Once this method has returned the Atoll Application object has been destroyed and invoking any method on it will
result in undefined behaviour.

3.18 LogMessage
Displays a message in the Atoll event observer window.
HRESULT LogMessage(const BSTR bstrMsg, enum AtoLogType aLogtype = atoInfo);
Parameters
[in] bstrMsg: The text to display.
[in] aLogType:
◼

atoInfo: An information message is displayed.

◼

atoError: An error message is displayed.

◼

atoWarning: A warning message is displayed.

3.19 CreatePropertyContainer
Returns an empty PropertyContainer object.
HRESULT CreatePropertyContainer(VARIANT *pProperties)
Parameters
[out] pProperties: Address of the VARIANT used to return the empty PropertyContainer object.
Remarks
The VARIANT returned if of type VT_DISPATCH, and it implements the IPropertyContainer interface. The empty
container returned can be used to hold default parameters specific to an Atoll document command or to hold an
Atoll ChildFolder Object properties.

3.20 IniFileFullPath
Returns the full path to the Atoll Initialisation File.
HRESULT get_IniFileFullPath(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the full path to the Atoll Initialisation File.
Remarks
The Atoll Initialisation File is usually named "Atoll.ini" and it is located in the directory where Atoll was installed.
Please note that for performance reasons, some options read from the Initialisation File by Atoll are cached for
subsequent usage. After the path to the Initialisation File has been changed, and in order for some options to be

34

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

used, it is necessary to quit Atoll and start it again. Therefore, it is recommended to change the full path to the
Initialisation File as soon as the Atoll Application Object has been created.
Please refer to the Atoll Administrator Manual for the list of available options.

3.21 IniFileFullPath
Sets the full path to the Atoll Initialisation File.
HRESULT put_IniFileFullPath(BSTR bstrFile);
Parameters
[in] bstrFile: A BSTR used to specify the full path to the Atoll Initialisation File.
Remarks
The Atoll Initialisation File is usually named "Atoll.ini" and it is located in the directory where Atoll was installed.
Please note that for performance reasons, some options read from the Initialisation File by Atoll are cached for
subsequent usage. After the path to the Initialisation File has been changed, and in order for some options to be
used, it is necessary to quit Atoll and start it again. Therefore, it is recommended to change the full path to the
Initialisation File as soon as the Atoll Application Object has been created.
Please refer to the Atoll Administrator Manual for the list of available options.

3.22 GetOption
Returns an option read from the Atoll Initialisation File.
HRESULT GetOption(BSTR bstrSection, BSTR bstrOption, VARIANT *pVal);
Parameters
[in] bstrSection: A BSTR used to specify the name of an Atoll Initialisation File section.
[in] bstrOption: A BSTR used to specify the name of an Atoll Initialisation File option.
[out] pVal : Address of the VARIANT used to return the option value. The type of the VARIANT returned is VT_NULL
when the option bstrOption is not found under the section bstrSection in the Initialisation File. The type of the
returned VARIANT is VT_I4 when the option bstrOption is an integer, otherwise the type of the VARIANT returned is
VT_BSTR. If bstrOption is left empty, pVal will be used to return the entire section whose name is specified in
bstrSection.
Remarks
Please refer to the Atoll Administrator Manual for the list of available sections and options.

3.23 SetOption
Sets an option in the Atoll Initialisation File.
HRESULT SetOption(BSTR bstrSection, BSTR bstrOption, VARIANT varValue);

© 2022 Forsk. All Rights Reserved.

35

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

Parameters
[in] bstrSection: A BSTR used to specify the name of an Atoll Initialisation File section.
[in] bstrOption: A BSTR used to specify the name of an Atoll Initialisation File option.
[in] varValue: A VARIANT used to specify the option value to write to the Initialisation File.
Remarks
The caller must have write access permission to the Initialisation File.
Please note that for performance reasons, some options read from the Initialisation File by Atoll are cached for
subsequent usage. Therefore, it is recommended to set options as soon as the Atoll Application Object has been
created.
Please refer to the Atoll Administrator Manual for the list of available sections and options.

3.24 Sleep
Suspends the application apartment execution.

HRESULT Sleep(long lMilliseconds);
Parameters
[in] lMilliseconds : A long integer used to specify the time, in milliseconds, to sleep.
Example
’Sleep 5 seconds
Atoll.Sleep 5000
Remarks
Application events can still be processed while the application apartment execution is suspended.
Application Version

≥ 2.8.1

3.25 SetAddinInfoEx
Reserved for future use.
HRESULT SetAddinInfoEx(
LONGLONG hInstance,
LPDISPATCH dispatch,
long idr,
long cookie
);

36

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

Parameters

3.26 OLENotRespondingDialog
Enables or disables OLE not responding dialog.
HRESULT put_OLENotRespondingDialog(VARIANT_BOOL newVal);
Parameters
[in] newVal: A VARIANT_BOOL used to specify whether the OLE not responding dialog is enabled (VARIANT_TRUE),
or disabled (VARIANT_FALSE).

3.27 OLEBusyDialog
Enables or disables OLE busy dialog.
HRESULT put_OLEBusyDialog(VARIANT_BOOL newVal);
Parameters
[in] newVal: A VARIANT_BOOL used to specify whether the OLE busy dialog is enabled (VARIANT_TRUE), or disabled
(VARIANT_FALSE).

3.28 OLEMessagePendingDelay
Sets the OLE message pending delay.
HRESULT put_OLEMessagePendingDelay(LONG newVal);
Parameters
[in] newVal: A LONG integer used to specify the OLE message pending delay.

3.29 GetProperty
Returns an engine object property.
HRESULT GetProperty([in] const BSTR bstrName, [out, retval] VARIANT *pValue);
Parameters
◼

bstrName: A property name.

© 2022 Forsk. All Rights Reserved.

37

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

◼

pValue: Address of the VARIANT used to return the property.

The error E_INVALIDARG is returned when there is no property named bstrName in the engine object.

3.30 SetProperty
Sets an engine object property.
HRESULT SetProperty([in] const BSTR bstrName, [in] const VARIANT varValue);
Parameters
◼

bstrName: A property name.

◼

varValue: The VARIANT used to specify the property value.

The error E_INVALIDARG is returned when there is no property named bstrName in the engine object.

3.31 CreateCoordinateSystem
Returns a CoordinateSystem object corresponding to the defined code.
HRESULT CreateCoordinateSystem([out, retval] IDispCoordSystem**
ppCoordinateSystem);
Parameters
◼

codeLong value representing the code of the system to create. [ppCoordinateSystemAddress of the
INaosCoordinateSystem used to return the CoordinateSystem object.

3.32 MacroFullName
Returns the full path of the current macro.
HRESULT MacroFullName([out, retval] BSTR* pVal);
Parameters
[out] pVal: Address of the BSTR used to return the macro full path.

3.33 Application Events
Events related to the application are fired:

38

◼

Before the application shuts down,

◼

When a document has just been opened,

◼

Before a document is closed,

◼

Before a document is saved,

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

3.33.1

◼

When a document has been saved,

◼

When a new document has just been created,

◼

Before a document is refreshed from database,

◼

When a document has been refreshed from database,

◼

Before a document is archived in database,

◼

When a document has been archived in database,

◼

When a calculation is requested,

◼

After a calculation has completed,

◼

When a licence is acquired,

◼

When a licence is released,

◼

Before a new document is created from an existing database.

WillQuitApp
Event fired when the user wants to exitan Atoll session. It occurs just before all add-ins are disconnected and after
all documents have been closed.
HRESULT WillQuitApp(VARIANT_BOOL* evtStatus);
Parameters
[out] evtStatus: A VARIANT_BOOL pointer used to return whether Atoll is allowed to quit (VARIANT_TRUE) or not
(VARIANT_FALSE).

3.33.2

DocumentOpenComplete
Event fired when a document has been opened.
HRESULT DocumentOpenComplete(IDocument* document);
Parameters
[in] document: The IDocument interface pointer of the document object which has been opened.

3.33.3

WillCloseDocument
Event fired when the user wants to close a document. It occurs just before the document closes, i.e., after all
confirmations requested by Atoll have been answered (stop running tasks, save changes, etc...).
HRESULT WillCloseDocument(IDocument* document, VARIANT_BOOL* evtStatus);
Parameters
[in] document: The IDocument interface pointer of the document object being closed.
[out] evtStatus: A VARIANT_BOOL pointer used to return whether the document is allowed to be closed
(VARIANT_TRUE) or not (VARIANT_FALSE).

© 2022 Forsk. All Rights Reserved.

39

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

3.33.4

WillSaveDocument
Event fired when the user wants to save a document. It occurs just before the document file is saved but after a valid
file name is set.
HRESULT WillSaveDocument(IDocument* document, VARIANT_BOOL* evtStatus);
Parameters
[in] document: The IDocument interface pointer of the document object being saved.
[out] evtStatus: A VARIANT_BOOL pointer used to return when the document is allowed to be saved
(VARIANT_TRUE) or not (VARIANT_FALSE).

3.33.5

DocumentSaveComplete
Event fired just after a document has been saved.
HRESULT DocumentSaveComplete (IDocument* document);
Parameters
[in] document: The IDocument interface pointer of the document which has been successfully saved.

3.33.6

DocumentNewComplete
Event fired when a new document has been created.
HRESULT DocumentNewComplete(IDocument* document);
Parameters
[in] document: The IDocument interface pointer of the document which has been created.

3.33.7

WillRefreshDocument
Event fired when the user wants to refresh a document from database. It occurs just before the connection with the
database is checked.
HRESULT WillRefreshDocument(IDocument* document, VARIANT_BOOL* evtStatus);
Parameters
[in] document: The IDocument interface pointer of the document being refreshed.
[out] evtStatus: A VARIANT_BOOL pointer used to return whether the document is allowed to be refreshed
(VARIANT_TRUE) or not (VARIANT_FALSE).

3.33.8

RefreshDocumentComplete
Event fired when a document has been refreshed from database.
HRESULT RefreshDocumentComplete(IDocument* document);

40

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

Parameters
[in] document: The IDocument interface pointer of the document which has been refreshed.

3.33.9

WillArchiveDocument
Event fired when the user wants to archive a document to the database. It occurs just after the connection with the
database is set up and after Atoll has checked if any changes have to be archived. If nothing requires archiving, this
event is not fired.
HRESULT WillArchiveDocument(IDocument* document, VARIANT_BOOL* evtStatus);
Parameters
[in] document: The IDocument interface pointer of the document being archived.
[out] evtStatus: A VARIANT_BOOL pointer used to return whether the document is allowed to be archived
(VARIANT_TRUE) or not (VARIANT_FALSE).

3.33.10

ArchiveDocumentComplete
Event fired when the document has been archived in database. It occurs just before the connection with the
database is broken.
HRESULT ArchiveDocumentComplete(IDocument* document);
Parameters
[in] document: The IDocument interface pointer of the document which has been archived.

3.33.11

WillRun
Event fired when the user wants to start a calculation. If all is set to VARIANT_TRUE, this event occurs after the user
has confirmed that all previous calculations must be deleted.
HRESULT WillRun(
IDocument* document,
VARIANT_BOOL all,
VARIANT_BOOL* evtStatus
);
Parameters
[in] document: The IDocument interface pointer of the document on which calculation is requested.
[in] all: A VARIANT_BOOL value used to specify whether the user has requested "Calculate All (Ctrl+F7)"
(VARIANT_TRUE) or "Calculate (F7)" (VARIANT_FALSE).
[out] evtStatus: A VARIANT_BOOL pointer used to return whether calculation is allowed to run against the document
(VARIANT_TRUE) or not (VARIANT_FALSE).

© 2022 Forsk. All Rights Reserved.

41

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

3.33.12

RunComplete
Event fired when the calculation has finished. It occurs after all tasks have completed.
HRESULT RunComplete(IDocument* document, VARIANT_BOOL succeeded);
Parameters
[in] document: The IDocument interface pointer of the document.
[in] succeeded: The VARIANT_BOOL used to specify whether calculation has succeeded (VARIANT_TRUE) or not
(VARIANT_FALSE).
Remarks
For documents based on the 3GPP Multi-RAT template, there may be several RunComplete events in response to
one calculation task. For instance, the path loss matrices calculation might result in 3 RunComplete events, one for
LTE, one for UMTS, and one for GSM matrices.

3.33.13

LicenceAcquireComplete
This feature enables the user to log Atoll licence token usage from an add-in. Licence token consumption is
available globally for all Atoll instances running on one licence server using a dedicated application (monitor.exe).
External licence tokens are not tracked by this event. Licence events for the Measurements module (Measures) is
available for auto-connected add-ins only.
Fired when one licence token is acquired.
HRESULT LicenceAcquireComplete(
IDocument *pDocument,
long lModuleID
);
Parameters
[in] pDocument: The IDocument interface pointer of the document that needed one licence token.
[in] lModuleID: The long integer used to specify the ID of the licence token that has just been acquired.
Remarks
lModuleID will be one of these constant values:

42

◼

LICENCE_GSMTDMA

◼

LICENCE_MW

◼

LICENCE_MEASURES

◼

LICENCE_AFP

◼

LICENCE_PACK3G

◼

LICENCE_UMTS

◼

LICENCE_CDMA

◼

LICENCE_TDSCDMA

◼

LICENCE_WIMAX

◼

LICENCE_LTE

◼

LICENCE_Backhaul

◼

LICENCE_NB-IoT

◼

LICENCE_5GNR

◼

LICENCE_LPWA

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

AT350_TAG_E3

◼

For LICENCE_MEASURES token, pDocument will be NULL.

Module identifiers used when licence application events are fired:
const long LICENCE_GSMTDMA = 2;
const long LICENCE_MW = 4;
const long LICENCE_MEASURES = 8;
const long LICENCE_AFP = 16;
const long LICENCE_PACK3G = 32;
const long LICENCE_UMTS = 64;
const long LICENCE_CDMA = 128;
const long LICENCE_TDSCDMA = 256;
const long LICENCE_WIMAX = 512;
const long LICENCE_LTE = 2048;
const long LICENCE_Backhaul = 65537;
const long LICENCE_NB-IoT = 65600;
const long LICENCE_5GNR = 65664;
const long LICENCE_LPWA = 65668;

3.33.14

LicenceReleaseComplete
This feature enables the user to log Atoll licence token usage from an add-in. Licence token consumption is
available globally for all Atoll instances running on one licence server using a dedicated application (monitor.exe).
External licence tokens are not tracked by this event. Licence events for the Measurements (Measures) module will
be available for autoconnected add-ins only.
Fired when one licence token is released.
HRESULT LicenceReleaseComplete(
IDocument *pDocument,
long lModuleID
);
Parameters
[in] pDocument: The IDocument interface pointer of the document that just released the licence token.
[in] lModuleID: The long integer used to specify the ID of the licence token that has just been released.
Remarks
lModuleID will be one of these constant values:
◼

LICENCE_GSMTDMA

◼

LICENCE_MW

◼

LICENCE_PACK3G

◼

LICENCE_UMTS

◼

LICENCE_CDMA

◼

LICENCE_TDSCDMA

◼

LICENCE_WIMAX

◼

LICENCE_LTE

◼

LICENCE_Backhaul

◼

LICENCE_NB-IoT

◼

LICENCE_5GNR

◼

LICENCE_LPWA

© 2022 Forsk. All Rights Reserved.

43

Atoll 3.5.0 Task Automation Guide
Chapter 3: Application Object

3.33.15

WillNewDocumentFromDatabase
≥ 3.2.0
Fired just before a new document is created from an existing database.
HRESULT WillNewDocumentFromDatabase(
BSTR connexion,
BSTR schema,
VARIANT_BOOL *pEvtStatus
);
Parameters
[in] connexion: The database connexion string.
[in] schema: The database schema.
[out] evtStatus: A VARIANT_BOOL pointer used to return whether the creation of the new document from the
database identified by the connexion and schema parameters is allowed (VARIANT_TRUE) or not
(VARIANT_FALSE).

3.33.16

WillUpgradeDocument
≥ 3.4.0
Fired when opening a connected document from a previous version of Atoll, just before upgrading.
HRESULT WillUpgradeDocument(
BSTR connection,
VARIANT_BOOL *pEvtStatus
);
Parameters
[in] connection: The database connection string.
[out, retval] pEvtStatus: A VARIANT_BOOL pointer used to return whether ... (VARIANT_TRUE) or not
(VARIANT_FALSE).

3.33.17

DocumentUpgradeComplete
≥ 3.4.0
Fired when a connected document from a previous version of Atoll has been upgraded.
HRESULT DocumentUpgradeComplete()

44

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 4: Documents Object

AT350_TAG_E3

4 Documents Object
The Documents object is used to create a new document or to iterate through open documents in a session.
The Documents object provides the following properties and methods:
Name
Count

Description

Attributes

Returns the number of currently open documents ina session. Type: Integer
Access: Read

Item

Returns one document currently open in a session.

Type: Documents object
Access: Read

Application

Returns the Atoll application object.

Type: Application object
Access: Read

Parent

Returns the Atoll application object.

Type: Application object
Access: Read

Open

Opens an existing document and adds it to the collection of
open documents.

Add

Creates a new document and adds it to the collection of open
documents.

OpenFromDatabase

Creates a new document from a database and adds it to the collection of open documents.

CloseAll

Closes all open documents.

SaveAll

Saves all open documents.

4.1 How to Access a Documents Object
To access a Documents object:
Dim allDocs
Set allDocs = Atoll.Documents
The "For Each" VBScript statement can be used with the Documents collection object:
Dim allDocs
Dim doc
Set allDocs = Atoll.Documents
For Each doc In allDocs
‘ do some work with doc
‘...
Next

© 2022 Forsk. All Rights Reserved.

45

Atoll 3.5.0 Task Automation Guide
Chapter 4: Documents Object

4.2 Count
Returns the number of currently open documents in an Atoll session.
HRESULT get_Count(LONG *pVal);
Parameters
[out] pVal: A LONG pointer used to return the number of open documents.
Example
Dim nDocs
nDocs = Atoll.Documents.Count

4.3 Item
Returns one document currently open in an Atoll session.
HRESULT get_Item(const VARIANT vIdx, IDocument **ppDoc);
Parameters
[in] vIdx: A VARIANT of type VT_I4 or VT_BSTR identifying the returned document. A variant of type VT_I4 is
interpreted as a zero-based index in the documents collection. A variant of type VT_BSTR is interpreted as the name
of a document.
[out] ppDoc: Address of the IDocument interface pointer used to return the Atoll document object.
Remarks
The name of a document is the document file name, as returned by Name().

4.4 Application
Returns the Atoll application object.
HRESULT get_Application(IApplication **ppVal);
Parameters
[out] ppVal: Address of the IApplication interface pointer used to return the Atoll application object.

4.5 Parent
Returns the Atoll application object.
HRESULT get_Parent(IApplication **ppVal);
Parameters
[out] ppVal: Address of the IApplication interface pointer used to return the Atoll application object.

46

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 4: Documents Object

AT350_TAG_E3

4.6 Open
Opens an existing document and adds it to the collection of open documents.
HRESULT Open(const
**pDoc);

BSTR

bstrPathName,

VARIANT_BOOL

aReadOnly,

IDocument

Parameters
[in] bstrPathName: The absolute path of the document to open.
[in] readOnly: VARIANT_TRUE means the document will be opened in read-only mode. VARIANT_FALSE means the
document will be opened in read-write mode.
[out] pDoc: Address of the IDocument interface pointer used to return the open Document object.
Example
Dim doc
Set doc = app.Documents.Open("C:\Temp\myProject.atl")

4.7 Add
Creates a new document and adds it to the collection of open documents.
HRESULT Add(BSTR templateName, IDocument **pDoc);
Parameters
[in] templateName: The name of an Atoll template.
[out] pDoc: Address of the IDocument interface pointer used to return the new Document object.
Example
Dim doc
Set doc = app.Documents.Add("UMTS")

4.8 OpenFromDatabase
Creates a new document from a database and adds it to the collection of open documents.
HRESULT OpenFromDatabase(VARIANT connection, BSTR schema, IDocument **pDoc);
Parameters
[in] connection: A VARIANT of type VT_BSTR or VT_UNKNOWN. If the variant is of type VT_BSTR, it is interpreted as
the connection string of the database you want to connect to. If the variant if of type VT_UNKNOWN, it is interpreted
as an ADODB connection interface pointer. Please read the Microsoft documentation about ADOX interfaces.
[in] schema: The name of the database schema, in case of databases supporting muti-schema based definition. The
syntax of the schema string is:
Value[;PropertyName = Value]

© 2022 Forsk. All Rights Reserved.

47

Atoll 3.5.0 Task Automation Guide
Chapter 4: Documents Object

Available properties are:
Property Name

Value

Version

Description

Project

string

≥2.6.0

Database schema

Keep Connection

0|1

≥2.6.0

Whether to keep connection with the database or not

Field Groups

group name

≥2.6.0

Comma separated values of field groups

[,group name]
Site Lists

site list[,site list]

≥2.6.0

Comma separated values of site lists

IntraTechnology
Neighbours

0|1

≥2.6.1

Whether to load the table "NEIGHBOURS" or not

InterTechnology
Neighbours

0|1

≥2.6.1

Whether to load the table "NEIGHBOURSEXT" or not

Systems

system,[system]

≥3.1.2

Comma separated values of systems.
When creating a new document from a 3GPP Multi-RAT database, it is used to specify the radio access technologies to load.
Available values for systems are:
GSM
UMTS
LTE
When no property named "Systems" is specified in the schema
string, all radio technologies are loaded.

[out] pDoc: Address of the IDocument interface pointer used to return the new Document object.
Remarks
A dialogue box is displayed to enter the schema properties in these cases:
◼

When schema is NULL, or schema is equal to the string constant "0".

◼

When a project is specified, and when no site lists are specified in the schema parameter.

No dialogue box is displayed when a project is specified, and when the site lists property of the schema parameter
is set to "<ALL>". In this case, all sites are loaded from the database.
Example
Creating a new document from a MS Access database:
Public Sub OpenMSAccessDatabase
conn = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\myproject.mdb"
Atoll.Documents.OpenFromDatabase conn, ""
End Sub
Creating a new document from a database, specifying a site list to load:
Public Sub OpenSiteList
conn = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\myproject.mdb"
Atoll.Documents.OpenFromDatabase conn, "Site Lists=MySiteList"
End Sub
Creating a new document from an Oracle database, with no dialogue box:
Public Sub OpenOracleDatabase
provider = "Provider=OraOLEDB.Oracle.1;"
username = "User ID=MyUserName;"
password = "Password=MyPassword;"
server = "Data Source=MyServer"
project = "Project=MyProject;"
conn = provider & username & password & server
sitelists = ";Site Lists=<ALL>"
schema = project & sitelists
Atoll.Documents.OpenFromDatabase conn, schema
End Sub

48

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 4: Documents Object

AT350_TAG_E3

Creating a new document from a 3GPP Multi-RAT Oracle database, loading LTE and UMTS information only:
Public Sub OpenLTEAndUMTSFromOracleDatabase
provider = "Provider=OraOLEDB.Oracle.1;"
username = "User ID=MyUserName;"
password = "Password=MyPassword;"
server = "Data Source=MyServer"
project = "Project=MyProject;"
conn = provider & username & password & server
sitelists = ";Site Lists=<ALL>"
technologies = ";Systems=LTE,UMTS"
schema = project & sitelists & technologies
Atoll.Documents.OpenFromDatabase conn, schema
End Sub

4.9 CloseAll
Closes all open documents.
HRESULT CloseAll(AtoSaveChanges saveChanges, AtoSaveStatus *status);
Parameters
[in] saveChanges:
◼

atoSaveNo: Discards document changes, then closes all open documents.

◼

atoSaveYes: Saves document changes, then closes all open documents.

◼

atoSavePrompt: The user is prompted to save document changes, then all open documents are closed.

[out] status: The AtoSaveStatus enumeration pointer used to return whether changes were successfully saved or
not.
◼

Returns atoSaveCanceled when the user was prompted and has chosen not to save the changes, otherwise
returns atoSaveSucceeded.

4.10 SaveAll
Saves all open documents.
HRESULT SaveAll();

© 2022 Forsk. All Rights Reserved.

49

Atoll 3.5.0 Task Automation Guide
Chapter 4: Documents Object

50

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

5 Document Object
The Document object provides access to ATL documents and database connections. A document can be managed
(open, save, close, etc.) using its properties and methods. A document is also the main entry to manage all the data
it contains.
The Document object provides the following properties and methods:
Name
Application

Description
Returns the Atoll Application Object.

Attributes
Type: Application object
Access: Read

Parent

Returns the Atoll Documents collection.

Type: Documents object
Access: Read

FullName

Returns the document full path.

Type: String
Access: Read

Name

Returns the document file name without the extension.

Type: String
Access: Read

Path

Returns the document path.

Type: String
Access: Read

ReadOnly

Returns true if the document is read-only, false otherwise.

Type: Boolean
Access: Read

Saved
CoordSystemProjection

Returns false if the document contains unsaved changes, true
otherwise.

Type: Boolean

Returns the projection coordinate system of a document.

Type: CoordSystem object

Access: Read
Access: Read/Write

putref_CoordSystemProjection

Sets the projection coordinate system of a document.

Type: CoordSystem object
Access: Read/Write

CoordSystemDisplay

Returns the display coordinate system of a document.

Type: CoordSystem object
Access: Read/Write

putref_CoordSystemDisplay

Sets the display coordinate system of a document.

Type: CoordSystem object
Access: Read/Write

CoordSystemInternal

Returns the internal coordinate system of a document.

Type: CoordSystem object
Access: Read

TransmissionUnit

Returns the transmission power unit.

Type: Integer
Access: Read/Write

TransmissionUnit

Sets the transmission power unit.

Type: Integer
Access: Read/Write

ReceptionUnit

Returns the signal level reception unit.

Type: Integer
Access: Read/Write

ReceptionUnit

Sets the signal level reception unit.

Type: Integer
Access: Read/Write

DistanceUnit

Returns the display distance unit.

Type: Integer
Access: Read/Write

DistanceUnit

Sets the display distance unit.

Type: Integer
Access: Read/Write

Close

Closes a document.

FilePrint

Sends a document to a printer.

© 2022 Forsk. All Rights Reserved.

51

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

Name

Description

Attributes

Save

Saves a document.

Refresh

Refreshes the document from a database.

Archive

Archives the document in a database.

Run

Starts calculations.

SetConfig

Loads a configuration file.

Import

Loads a file containing geographic data.

GetRecords

Returns a TabularData object for a requested category of
records.

Redraw

Refreshes all items in the document.

CenterMapOn

Centres map on a parameter point.

GetRootFolder

Returns the root ChildFolder object used to enumerate all ChildFolder objects belonging to one tab of the Atoll explorer window.

RunPathloss

Calculates the path loss matrices with no need for any predefined studies.

GetService

Returns a Document Service Object.

ExportConfig

Exports a subset of the current document configuration to a file.

GetCommandDefaults

Returns current default parameters specific to a command.

InvokeCommand

Invokes a command.

RadiatedPowerUnit

Returns the current radiated power unit.

Type: Integer
Access: Read/Write

RadiatedPowerUnit

Sets the current radiated power unit.

Type: Integer
Access: Read/Write

AntennaGainUnit

Returns the current antenna gain unit.

Type: Integer
Access: Read/Write

AntennaGainUnit

Sets the current antenna gain unit.

Type: Integer
Access: Read/Write

HeightOffsetUnit

Returns the current height offset unit.

Type: Integer
Access: Read/Write

HeightOffsetUnit

Sets the current height offset unit.

Type: Integer
Access: Read/Write

DatabaseConnectionString

Returns the database connection string.

Type: String
Access: Read/Write

HasRunningTask

Returns true when there is some calculation in progress.

Type: Boolean
Access: Read

RunEx

Starts calculations.

DatabaseSchemaString

Returns the database schema string.

Type: String
Access: Read/Write

DisplayApplicationDialogues

Returns true when some methods on some Atoll interfaces may Type: Boolean
display some dialogue boxes.
Access: Read/Write

DisplayApplicationDialogues

Returns true when some methods on some Atoll interfaces may Type: Boolean
display some dialogue boxes.
Access: Read/Write

PutDatabaseSchemaString

Sets the database schema string.

Type: String
Access: Read/Write

PutDatabaseConnectionString

Sets the database connection string.

Type: String
Access: Read/Write

ChangeDatabaseConnection

Changes the database connection string.

Type: String
Access: Read/Write

52

TemperatureUnit

Returns the display temperature unit.

TemperatureUnit

Sets the display temperature unit.

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

Name

Description

GetDocumentProperties

Returns the document properties.

SetDocumentProperties

Sets the document properties.

RadioTableNames

Returns the names of Radio TabularData Objects in the document.

LogMessage

Displays a message in the Atoll event viewer window.

GetProperty

Returns a Document object property.

SetProperty

Sets a Document object property.

Attributes

5.1 How to Access a Document Object
To access a document, you can either:
1. Request the active document from the application:
Set myDoc = Atoll.ActiveDocument
2. Or, use the Documents object:
Set myDoc = Atoll.Documents.Open(“C:\temp\myproject.atl”)

5.2 Application
Returns the Atoll Application Object.
HRESULT get_Application(IApplication **ppVal);
Parameters
[out] ppVal: Address of the IApplication interface pointer used to return the Atoll Application Object.

5.3 Parent
Returns the Atoll Documents collection.
HRESULT get_Parent(IDocuments **ppDocVal);
Parameters
[out] ppDocVal: Address of the IDocuments interface pointer used to return the Atoll Documents collection.

© 2022 Forsk. All Rights Reserved.

53

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

5.4 FullName
Returns the document full path.
HRESULT get_FullName(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the document full path.
Remarks
With a new document that has never been saved, or a document opened from a database, an empty string is
returned.

5.5 Name
Returns the document file name without the extension.
HRESULT get_Name(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the document file name without the extension.
Remarks
With a new document that has never been saved, or a document opened from a database, an empty string is
returned.

5.6 Path
Returns the document path.
HRESULT get_Path(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the document path.
Remarks
With a new document that has never been saved, or a document opened from a database, an empty string is
returned.

5.7 ReadOnly
Returns true if the document is read-only, false otherwise.
HRESULT get_readOnly(VARIANT_BOOL *pVal);

54

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

Parameters
[out] pVal: Address of the VARIANT_BOOL used to return the read-only status of the document.

5.8 Saved
Returns false if the document contains unsaved changes, true otherwise.
HRESULT get_Saved(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether the document contains unsaved changes or not.

5.9 CoordSystemProjection
Returns the projection coordinate system of a document.
HRESULT get_CoordSystemProjection(IDispCoordSystem **ppVal);
Parameters
[out] ppVal: Address of the IDispCoordSystem interface pointer used to return the projection coordinate system of
the document.

5.10 putref_CoordSystemProjection
Sets the projection coordinate system of a document.
HRESULT putref_CoordSystemProjection(IDispCoordSystem *pVal);
Parameters
[in] pVal: Address of the IDispCoordSystem interface pointer used to set the projection coordinate system of the
document.

5.11 CoordSystemDisplay
Returns the display coordinate system of a document.
HRESULT get_CoordSystemDisplay(IDispCoordSystem **ppVal);
Parameters
[out] ppVal: Address of the IDispCoordSystem interface pointer used to return the display coordinate system of the
document.

© 2022 Forsk. All Rights Reserved.

55

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

5.12 putref_CoordSystemDisplay
Sets the display coordinate system of a document.
HRESULT putref_CoordSystemDisplay(IDispCoordSystem *pVal);
Parameters
[in] pVal: Address of the IDispCoordSystem interface pointer used to set the display coordinate system of the
document.
Remarks
It is not possible to change the coordinate system of a document directly with the Code property. You must create
a new Atoll.CoordSystem object with a different Code property.

5.13 CoordSystemInternal
Returns the internal coordinate system of a document.
HRESULT get_CoordSystemInternal(IDispCoordSystem **ppVal);
Parameters
[out] ppVal: Address of the IDispCoordSystem interface pointer used to return the internal coordinate system of the
document.
Remarks
When the document is not connected to a database, the internal coordinate system is the same as the display
coordinate system. When the document is connected to a database, the internal coordinate system won’t change
when the display coordinate system is changed. When the document is connected to a database, the internal
coordinate system is the display coordinate system that was in use when the document was archived in the
database for the first time.
The coordinates of sites are defined with the internal coordinate system.

5.14 TransmissionUnit
Returns the transmission power unit.
HRESULT get_TransmissionUnit(enum AtoTransmissionUnit *pVal);
Parameters
[out] pVal: Address of the AtoTransmissionUnit enumeration value used to return the transmission power unit.

5.15 TransmissionUnit
Sets the transmission power unit.
HRESULT put_TransmissionUnit(enum AtoTransmissionUnit aNewVal);

56

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

Parameters
[in] aNewVal: The AtoTransmissionUnit enumeration value used to specify the transmission power unit.

5.16 ReceptionUnit
Returns the signal level reception unit.
HRESULT get_ReceptionUnit(enum AtoReceptionUnit *pVal);
Parameters
[out] pVal: Address of the AtoReceptionUnit enumeration value used to return the signal level reception unit.

5.17 ReceptionUnit
Sets the signal level reception unit.
HRESULT put_ReceptionUnit(enum AtoReceptionUnit aNewVal);
Parameters
[in] aNewVal: The AtoReceptionUnit enumeration value used to specify the signal level reception unit.

5.18 DistanceUnit
Returns the display distance unit.
HRESULT get_DistanceUnit(enum AtoDistanceUnit *pVal);
Parameters
[out] pVal: Address of the AtoDistanceUnit enumeration value used to return the display distance unit.

5.19 DistanceUnit
Sets the display distance unit.
HRESULT put_DistanceUnit(enum AtoDistanceUnit aNewVal);
Parameters
[in] aNewVal: The AtoDistanceUnit enumeration value used to specify the display distance unit.

© 2022 Forsk. All Rights Reserved.

57

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

5.20 Close
Closes a document.
HRESULT Close(enum AtoSaveChanges saveChanges, enum AtoSaveStatus *pStatus);
Parameters
[in] saveChanges: An AtoSaveChanges enumeration value. The values are:
Constant

Value

Description

atoSaveNo

0

Document is closed without being saved.

atoSaveYes

1

Document is saved before being closed.

atoSavePrompt

2

The user is prompted whether the document must be saved before
closed.

[out] pStatus: Address of the AtoSaveStatus enumeration value. Returned values are:
Constant

Value

Description

atoSaveSucceeded

0

Document has been successfully saved.

atoSaveCanceled

1

Changes in the document has been cancelled by the user.

5.21 FilePrint
Sends a document to a printer. The current print settings are used.
HRESULT FilePrint();

5.22 Save
Saves a document.
HRESULT Save(const BSTR pVal);
Parameters
[in] pVal: A BSTR used to specify where the document will be saved. When pVal is an empty string, the document is
saved in place, the action performed is the same as the Atoll "File | Save" menu command. When pVal is the full path
to an ATL file, then the action performed is the same as the Atoll "File | Save as..." menu command. When pVal is
the full path to a Microsoft Access database file or when pVal is an Oracle database connection string, then the
action performed is the same as the Atoll "File | Database | Export..." menu command.

q

58

SQL Server databases are not supported.

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

5.23 Refresh
Refreshes the document from a database. The document must be connected to a database.
HRESULT Refresh(enum AtoRefreshPriority aPriority);
Parameters
[in] aPriority: The AtoRefreshPriority enumeration value used to refresh the document from the database.

5.24 Archive
Archives the document in a database. The document must be connected to a database.
HRESULT Archive(enum AtoArchiveStatus *pStatus);
Parameters
[out] pStatus: Address of the AtoArchiveStatus used to return the result of the operation.
Remarks
Atoll >= 2.7.0:
When the DisplayApplicationDialogue property of the document is set to true, the standard Atoll archive dialogue will
be displayed, otherwise no dialogue is displayed and all changes are archived.

5.25 Run
Starts calculations.
HRESULT Run(VARIANT_BOOL aAll);
Parameters
[in] aAll: The VARIANT_BOOL value used to specify whether all previous results must be deleted before the
calculations starts (VARIANT_TRUE), or if only invalid pathloss matrices must be calculated (VARIANT_FALSE).
Remarks
1) When aAll is set to VARIANT_TRUE, the result is the same as the Atoll "Tools | Force calculation" menu command.
When aAll is set to VARIANT_FALSE, the result is the same as the Atoll "Tools | Calculate" menu command.
2) The method returns immediately and calculations occur in the background.
3) An error is returned when it is called on a Microwave Radio Links Atoll document.
The WillRun application event is thrown by this method.

5.26 SetConfig
Loads a configuration file.
HRESULT SetConfig(const BSTR bstrFileName);

© 2022 Forsk. All Rights Reserved.

59

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

Parameters
[in] bstrFileName: The BSTR used to specify the full path of the configuration file to load.
Remarks
The configuration file is a .CFG file obtained using the Atoll "User Configuration | Export..." menu command. It may
contain geographic configuration and folder configurations. Please see the Atoll Administrator Manual. The
configurations in the document are replaced with the configurations contained in the .CFG file. If you simply want
to add some geographic data to a document, you should rather use the Import method instead.

5.27 Import
Loads a file containing geographic data.
HRESULT Import(const BSTR fileName);
Parameters
[in] fileName: A BSTR used to specify the full path of the file to load.
Remarks
The geographic file can be:
◼

An .CFG file. All data from its geographic section are loaded. Please see the Atoll Administrator Manual.

◼

Any file format supported by Atoll (.BIL, .TIF, etc).

The geographic content of the imported file (.CFG, .GEO, .BIL, .TIF, etc.) is added to the current configuration of the
geographic data in the document. The existing geographic configuration is not removed.
If you want to replace the geographic configuration of a document, you should use the SetConfig function instead.



You must ensure that no inputs are requested from the user when importing the file
(for instance the file type, georeferencement parameters, etc.) when the application
is not visible.

5.28 GetRecords
Returns an Atoll Tabular Data Object for a requested category of records.
HRESULT GetRecords(
const BSTR bstrTableName,
VARIANT_BOOL aAll,
ITabularData *ppRecords
);
Parameters
[in] bstrTableName: A BSTR used to specify the name of the table from which the records are requested.
[in] aAll: A VARIANT_BOOL. When it is set to VARIANT_TRUE, all the records of the table are returned. When it is set
to VARIANT_FALSE and when there is an Atoll document folder associated with bstrTableName, the filter set on the
document folder is used to filter the returned records, including calculated fields. If no associated folder exists, this
parameter is ignored.
[out] ppRecords: Address of the ITabularData interface pointer used to return the Atoll Tabular Data Object.

60

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

Remarks
The list of available table names defined by Atoll can be found in the template (.MDB) file. Please see the
Administrator Manual for the available table names. Some other table names are available:
◼

PREDICTIONS: to get pathloss matrices and signal level matrices.

◼

ZONES: to get either the calculation zone or the focus zone.

Changes introduced in Atoll version 2.7.1 and above
1) Table "REPEATERS_VIEW"
When bstrTableName is equal to “REPEATERS_VIEW”, the TabularData object returned is a join on the
"TRANSMITTERS" and the "REPEATERS" table. The fields returned will be the "TRANSMITTERS" table fields and the
"REPEATERS" table fields, where TRANSMITTERS.TX_ID = REPEATERS.TX_ID. The name of the fields of the
"REPEATERS" table in the "REPEATERS_VIEW" are prefixed with "TX_ID." whereas the names of the fields coming
from the "TRANSMITTERS" table are left unchanged. When aAll is VARIANT_FALSE, then the filter set on the
“Transmitters” folder of the Atoll document is used to filter the “REPEATERS_VIEW” table records, otherwise all
repeaters or remote antennas are returned. A remote antenna is a repeater whith the field “EQUIPMENT_NAME” set
to VT_NULL.
2) Table "REPEATERS"
When bstrTableName is equal to “REPEATERS”, and aAll is VARIANT_FALSE, then the filter set on the “Transmitters”
folder of the Atoll document is used to filter the “REPEATERS” table records, otherwise all repeaters or remote
antennas are returned. A remote antenna is a repeater whith the field “EQUIPMENT_NAME” set to VT_NULL.
Changes introduced in Atoll version 3.1.1 and above
1) Table "MWLinks"
When bstrTableName is equal to “MWLinks”, the TabularData object returned has an additional column named
"_LINK_LENGTH", used to access the length of Microwave links as single precision floating point values.
Example
Dim records
’ Returns the content of the SITES table
Set records = app.ActiveDocument.GetRecords("Sites", True)
’ Returns the content of the Sites folder, taking the folder filter into
account
Set records = app.ActiveDocument.GetRecords("Sites", False)

5.29 Redraw
Refreshes all items in the document.
HRESULT Redraw();
Remarks
It has the same effect as the icon Refresh (F5) in Atoll.

5.30 CenterMapOn
Centres map on a parameter point.
HRESULT CenterMapOn(double* ptx, double* pty);

© 2022 Forsk. All Rights Reserved.

61

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

Parameters
[in] ptx, [in] pty: Pointers to double precision floating point values used to specify the coordinates of the point to
centres the map view on, expressed in meters, using the document projected coordinate system.

5.31 GetRootFolder
Returns the root Atoll Child Folder Object used to enumerate all Child Folder objects belonging to one tab of the Atoll
explorer window.
HRESULT GetRootFolder(enum AtoRootType aType, IChildFolder **ppItem);
Parameters
[in] aType: The AtoRootType enumeration value used to specify the Atoll explorer window tab. There is one root
ChildFolder object for each tab of the Atoll explorer window.
[out] ppItem: Address of the IChildFolder interface pointer used to return the root ChildFolder object.
Example
Dim geo
const atoGeo = 1
’ Returns the root ChildFolder object of the Atoll explorer "Geo" tab
Set geo = app.ActiveDocument.GetRootFolder(atoGeo)

5.32 RunPathloss
Calculates the path loss matrices with no need for any predefined studies.
HRESULT RunPathloss(VARIANT_BOOL allTx, VARIANT_BOOL forced);
Parameters
[in] allTx: When VARIANT_TRUE, the calculation is made for all active transmitters in the table. When
VARIANT_FALSE, only filtered transmitters are calculated.
[in] forced: When VARIANT_TRUE, the calculation is forced even for transmitters having available valid results. When
VARIANT_FALSE, the calculation is made only for transmitters having unavailable or invalid results.
Remarks
1) This method corresponds to the menu commands "Calculations | Calculate Path Loss Matrices" and
"Calculations | Force Path Loss Matrix Calculation" available in the Calculations sub-menu of the Transmitters
folder.
2) The method returns immediately and the calculations occur in the background.
3) An error is returned when it is called on a Microwave Radio Links Atoll document.
How to detect the end of path loss matrices calculation?
To wait for the end of background path loss matrices calculation, please use the HasRunningTask document object
method.

62

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

While background calculations are running, HasRunningTask returns True. As soon as HasRunningTask returns
False, you can assume that background calculations are finished:
'"Wait" Loop
Do While AtollDoc.HasRunningTask
WScript.Sleep 1000
Loop

5.33 GetService
Returns a scriptable Document Service Object.
HRESULT GetService(BSTR bstrName, IDispatch** ppProvider)
Parameters
[in] bstrName: A BSTR used to specify the name of the service.
The available values are:
"SIGNAL" : A Result File Provider object, implementing the IResultFileProvider interface.
On documents based on the GSM GPRS EDGE template:
"AFP" : A GSM Frequency Plan Allocation object, implementing the IAfpLauncher interface.
"AFP_IM" : A GSM Interference Matrices object, implementing the IAfpImLauncher interface.
[out] ppProvider: Address of the IDispatch interface pointer used to return the scriptable Document Service Object.

5.34 ExportConfig
Exports a subset of the current document configuration to a file.
HRESULT ExportConfig(const BSTR bstrContent, const BSTR bstrFile);
Parameters
[in] bstrContent: A BSTR used to specify the configuration subset to export:
◼

"GEO" : The "Geographic Data Set" configuration is exported.

◼

"GEO+ZONES" : The "Geographic Data Set" and "Computation and Focus Zones" configurations are exported.

◼

"FULL" : All available configurations are exported.

Atoll 2.7.1 and above:
bstrContent is parsed according to the format "OPTION[+OPTION]". The set of specified options are exported to
bstrFile. Available options are:
OPTION name

Description

GEO

Geographic Data Set

ZONES

Computation and Focus Zones

STUDIES

Prediction List

© 2022 Forsk. All Rights Reserved.

63

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

Atoll 3.1.0 and above:
OPTION name

Description

FOLDERS

Folder Configuration

MACROS

Macros

AFP

AFP Configuration

ANP

Automatic Neighbour Allocation Parameters

MW

Microwave Link Parameters

PNO

Automatic PN Offset Allocation Parameters

SCP

Automatic Scrambling Code Allocation Parameters

[in] bstrFile: A BSTR used to specify the name of the export file.

5.35 GetCommandDefaults
Returns current default parameters specific to a command.
HRESULT GetCommandDefaults(
const BSTR bstrCommandName,
IPropertyContainer **ppParameters
);
Parameters
[in] bstrCommandName: A BSTR used to specify the command.
[out] ppParameters: Address of the IPropertyContainer interface pointer used to return the defaults parameters for
the bstrCommandName command.

5.36 InvokeCommand
Invokes a command.
HRESULT InvokeCommand(
const BSTR bstrCommandName,
IPropertyContainer *pParameters,
IPropertyContainer **ppResults
);
Parameters
[in] bstrCommandName: A BSTR used to specify the command.
[in] pParameters: The IPropertyContainer interface pointer used to specify the Property Container object holding the
parameters needed to carry out the command.
◼

If set to NULL, default parameters for the command will be used.

ppResults: Results of the command invokation.
◼

64

*ppResults will be set to NULL if the command has no results.

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

5.37 RadiatedPowerUnit
Returns the current radiated power unit.
HRESULT get_RadiatedPowerUnit(enum AtoRadiatedPowerUnit *pVal);
Parameters
[out] pVal: Address of the AtoRadiatedPowerUnit enumeration value used to return the radiated power unit.

5.38 RadiatedPowerUnit
Sets the current radiated power unit.
HRESULT put_RadiatedPowerUnit(enum AtoRadiatedPowerUnit aNewVal);
Parameters
[in] aNewVal: The AtoRadiatedPowerUnit enumeration value used to specify the radiated power unit.

5.39 AntennaGainUnit
Returns the current antenna gain unit.
HRESULT get_AntennaGainUnit(enum AtoAntennaGainUnit *pVal);
Parameters
[out] pVal: Address of the AtoAntennaGainUnit enumeration value used to return the antenna gain unit.

5.40 AntennaGainUnit
Sets the current antenna gain unit.
HRESULT put_AntennaGainUnit(enum AtoAntennaGainUnit aNewVal);
Parameters
[in] aNewVal: The AtoAntennaGainUnit enumeration value used to specify the antenna gain unit.

5.41 HeightOffsetUnit
Returns the current height offset unit.
HRESULT get_HeightOffsetUnit(enum AtoHeightOffsetUnit *pVal);

© 2022 Forsk. All Rights Reserved.

65

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

Parameters
[out] pVal: Address of the AtoHeightOffsetUnit enumeration value used to return the height offset unit.

5.42 HeightOffsetUnit
Sets the current height offset unit.
HRESULT put_HeightOffsetUnit(enum AtoHeightOffsetUnit aNewVal);
Parameters
[in] aNewVal: The AtoHeightOffsetUnit enumeration value used to specify the height offset unit.

5.43 DatabaseConnectionString
Returns the database connection string.
HRESULT get_DatabaseConnectionString(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the database connection string.
Remarks
An error is returned when the document is not connected to a database.

5.44 HasRunningTask
Returns true when there is some calculation in progress.
HRESULT HasRunningTask(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether there is some calculation in progress or not.
Remarks
When some calculation is in progress, it is impossible to start new ones.

5.45 RunEx
Start calculations.
HRESULT RunEx(VARIANT_BOOL aAll, VARIANT_BOOL vbBlocking);

66

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

Parameters
[in] aAll: The VARIANT_BOOL value used to specify whether all previous results must be deleted before the
calculations starts (VARIANT_TRUE), or if only invalid pathloss matrices must be calculated (VARIANT_FALSE).
[in] vBlocking: The VARIANT_BOOL value used to specify whether the calculations will occur in the background
(VARIANT_FALSE), or if the method should wait for the calculations to finish before returning (VARIANT_TRUE).
Remarks
1) When aAll is set to VARIANT_TRUE, the result is the same as the Atoll "Tools | Force calculation" menu command.
When aAll is set to VARIANT_FALSE, the result is the same as the Atoll "Tools | Calculate" menu command.
2) An error is returned when it is called on a Microwave Radio Links Atoll document.
The WillRun application event is thrown by this method.
When vbBlocking is set to VARIANT_TRUE, the RunComplete application event is thrown by this method before it
returns.

5.46 DatabaseSchemaString
Returns the database schema string.
HRESULT get_DatabaseSchemaString(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the database schema string.
Remarks
An error is returned when the document is not connected.
The database schema string is returned using the exact same syntax described for the OpenFromDatabase method.

5.47 DisplayApplicationDialogues
Returns true when some methods on some Atoll interfaces may display some dialogue boxes.
HRESULT get_DisplayApplicationDialogues(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether some dialogue boxe may be displayed upon
invokation of some method on some Atoll interface.
Remarks
Setting the Application Object visibility state to false sets this value to false.

5.48 DisplayApplicationDialogues
Returns true when some methods on some Atoll interfaces may display some dialogue boxes.
HRESULT put_DisplayApplicationDialogues(VARIANT_BOOL aNewVal);

© 2022 Forsk. All Rights Reserved.

67

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

Parameters
[in] aNewVal: The VARIANT_BOOL used to specify whether some dialogue boxe may be displayed upon invokation
of some method on some Atoll interface.
Remarks
Setting the Application Object visibility state to false sets this value to false.

5.49 PutDatabaseSchemaString
Sets the database schema string.
HRESULT PutDatabaseSchemaString(BSTR aVal);
Remarks
This method is not implemented.
Please do not use this method.
Atoll Version
≥ 2.8.1

5.50 PutDatabaseConnectionString
Sets the database connection string.
HRESULT PutDatabaseConnectionString(BSTR aVal);
Parameters
[in] aVal:
The BSTR used to specify the new database connection string.
To disconnect the document from the database, specify a NULL BSTR value or an empty string.
Remarks
An error is returned when the document is not connected to a database.
Depending on the aVal parameter value, the action performed is the same as Database | Connection Properties |
Modify, or Database | Connection Properties | Disconnect.
Atoll Version
≥ 2.8.1

5.51 ChangeDatabaseConnection
Changes the database connection string.
HRESULT ChangeDatabaseConnection(BSTR aCnn, BSTR aReserved);

68

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

Parameters
[in] aCnn:
The BSTR used to specify the new database connection string.
[in] aReserved:
A BSTR reserved for a future usage.
Remarks
Please do not use this method. Use PutDatabaseConnectionString instead.
Atoll Version
≥ 2.8.1

5.52 TemperatureUnit
Returns the display temperature unit.
HRESULT get_TemperatureUnit(enum AtoTemperatureUnit *pVal);
Parameters
[out] pVal: Address of the AtoTemperatureUnit enumeration value used to return the display temperature unit.

5.53 TemperatureUnit
Sets the display temperature unit.
HRESULT put_TemperatureUnit(enum AtoTemperatureUnit aNewVal);
Parameters
[in] aNewVal: The AtoTemperatureUnit enumeration value used to specify the display temperature unit.

5.54 GetDocumentProperties
Returns the document properties.
HRESULT GetDocumentProperties(IPropertyContainer **ppProperties);
Parameters
[out] ppProperties: Address of the IPropertyContainer interface pointer used to return the document properties.
Remarks
Please see the SetDocumentProperties documentation for the list of available document properties.

© 2022 Forsk. All Rights Reserved.

69

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

5.55 SetDocumentProperties
Sets the document properties.
HRESULT SetDocumentProperties(IPropertyContainer *pProperties);
Parameters
[in] pProperties: The IPropertyContainer interface pointer used to specify the document properties.

Remarks
Available document properties are:
Name

Type

PROJECT

String

DATE

String

AUTHOR

String

TITLE

String

COMMENT

String

STATUS

String

LOGO

String

USER_PROPERTY0
USER_PROPERTY1
USER_PROPERTY2
USER_PROPERTY3
USER_PROPERTY4
USER_PROPERTY5
USER_PROPERTY6
USER_PROPERTY7
USER_PROPERTY8
USER_PROPERTY9

70

USER_PROPERTY_NAME0

String

USER_PROPERTY_NAME1

String

USER_PROPERTY_NAME2

String

USER_PROPERTY_NAME3

String

USER_PROPERTY_NAME4

String

USER_PROPERTY_NAME5

String

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

USER_PROPERTY_NAME6

String

USER_PROPERTY_NAME7

String

USER_PROPERTY_NAME8

String

USER_PROPERTY_NAME9

String

5.56 RadioTableNames
Returns the names of Radio TabularData Objects in the document.
HRESULT get_RadioTableNames(VARIANT* pTableNames);
Parameters
[out] pTableNames: Address of the VARIANT used to return the names of radio database tables in the document.
The variant returned is an Array of variants, with variants of type String.

5.57 LogMessage
Displays a message in the Atoll event observer window.
HRESULT LogMessage(const BSTR bstrMsg, enum AtoLogType aLogtype = atoInfo);
Parameters
[in] bstrMsg: The text to display.
[in] aLogType:
◼

atoInfo: An information message is displayed.

◼

atoError: An error message is displayed.

◼

atoWarning: A warning message is displayed.

5.58 GetProperty
Returns a Document object property.
HRESULT GetProperty(const BSTR bstrName, VARIANT *pValue);
Parameters
[in] bstrName: A property name.
[out] pValue: Address of the VARIANT used to return the property.

© 2022 Forsk. All Rights Reserved.

71

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

Remarks
The type of the returned VARIANT can be any of the following:
C++

VBScript

VT_BOOL

Boolean

VT_I4

Integer

VT_R4

Single

VT_R8

Double

VT_UNKNOWN

Object

VT_DISPATCH

Object, TabularData object, ChildFolder object, PropertyContainer
object

VT_BSTR

String

VT_ARRAY | (any of the previous types)

Array, with array items of the previous types

The error E_INVALIDARG is returned when there is no property named bstrName for the Document object.
Some Document object properties are common to all kinds of Document objects. These properties include the
following:
Name
ISMULTIRAT

Description
Returns true if the document is Multi-RAT document.

Attributes
Version ≥: 3.4.0
Type: Boolean
Access: Read

OFDMMULTISYSTEMSUPPORT

Returns true if the document supports multiple OFDM Version ≥: 3.4.0
systems.
Type: Boolean
Access: Read

SUPPORTEDTECHNOS

Returns the list of technologies that were selected
Version ≥: 3.4.0
upon creation of a multi-RAT document.
Type: Array of Strings
For 5G Multi-RAT, if one of the 4G/5G technologies
Access: Read
(LTE, NB-IoT, 5G NR) is selected, then all are returned.

REQUESTEDTECHNOS

Returns the list of requested technologies in the document

Version ≥: 3.4.1
Type: Array of Strings
Access: Read

LICENSEDTECHNOS

Returns the list of licensed technologies in the document

Version ≥: 3.4.1
Type: Array of Strings
Access: Read

ASTER_VERSION

Returns the Aster version and build number. Returns
VT_NULL if Aster is not installed.

Version ≥: 3.4.1
Type: Array of Strings
Access: Read

UNIQUEID

Returns the unique identifier of the document.

Version ≥: 3.4.1
Type: String
Access: Read

5.59 SetProperty
Sets a Document object property.
Parameters
[in] bstrName: A property name.
[out] varValue: The VARIANT used to specify the property value.

72

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

AT350_TAG_E3

Remarks
The error E_INVALIDARG is returned when there is no property named bstrName for the document object.
For the list of Document object properties, refer to the table in "GetProperty" on page 71.

© 2022 Forsk. All Rights Reserved.

73

Atoll 3.5.0 Task Automation Guide
Chapter 5: Document Object

74

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

6 TabularData Object
The TabularData object provides access to Atoll tables whether the document is connected to a database or not. It
also provides access to other tables which are not database tables, such as PREDICTIONS and ZONES, explained
in "Zones and Predictions Tabular Data Objects" on page 91.

q

For each database table, access is provided to differences between the content of
the database when the data table has been refreshed for the last time and the
current table content stored in a document. These are the differences listed in the
Atoll Database Archive dialogue, which can be submitted through an external
process using this interface.
Access is given the original data as retrieved by the latest refresh operation from
the database. Access is not given to the current content of the database. Therefore,
it is not possible to show or solve conflicts between the data in the Atoll document
and the current content of the database.
For a given database table, original data values and row statuses are not stored in
the database. They are stored in the Atoll document.

The TabularData object provides the following properties and methods:
Name
ColumnCount

Description
Returns the number of columns of the TabularData Object.

Attributes
Type: Integer
Access: Read

RowCount

Returns the number of rows of the TabularData Object

Type: Integer
Access: Read

Edit

Puts a row into edition mode.

AddNew

Adds a new empty row to the TabularData Object. The row added
is put into edition mode.

Update

Commits a row changes and puts the row from edition mode to
normal mode.

Delete

Deletes a record.

GetValue

Returns a value of a column for a given row.

SetValue

Sets the value of a column for the row being edited or added.

GetPrimaryKey

Returns the value of the primary key for a given row number.

FindPrimaryKey

Searches the row whose primary key equals the input value and
returns the row number of the row found.

Find

Searches a column for a value.

GetFormattedValue

Returns a column value formatted as a string.

CancelUpdate

Cancels a pending update.

ColumnNumber

Returns a column number.

Type: Integer
Access: Read

CanEdit

Checks if rows can be modified.

Type: Boolean
Access: Read

CanAddNew

Checks if rows can be added.

Type: Boolean
Access: Read

CanFilterSort

Checks if rows can be filtered or sorted.

Type: Boolean
Access: Read

© 2022 Forsk. All Rights Reserved.

75

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

Name
Filter

Description

Attributes

Returns the filter currently set on the table.

Type: String
Access: Read/Write

Filter

Filters the table data according to a filter criteria.

Type: String
Access: Read/Write

Sort

Returns the sort order currently set on the table.

Type: String
Access: Read/Write

Sort

Sorts the table data.

Type: String
Access: Read/Write

GetOriginalValue

Returns an original field value.

RowStatus

Returns a row status.

Type: Integer
Access: Read

Columns

Returns the table column definitions.

SetValues

Updates the table content with the given values.

ITabularData5::get_HasGUIRights

Checks if rows can be added/modified or deleted by checking the Type: Boolean
GUI user rights
Access: Read

6.1 How to Access a TabularData Object
A TabularData object is defined by its structure (number of columns, name of columns) and its content (rows =
records).
Column 0 and row 0 are special:
◼

Row 0 holds the field names, i.e., the table structure description.

◼

Column 0 holds a unique identifier for records, called RECORD_ID. This identifier is not persistent and must
not be used between two sessions of Atoll, neither when refreshing nor when archiving.

Thus, in order to get a tabular data structure, you write:
Dim i
Dim colName
Dim records
Set records = Atoll.ActiveDocument.GetRecords("Transmitters", True)
For i = 0 To records.ColumnCount
colName = records.GetValue(0, i)
Next
The first value (for i = 0) is always "RECORD_ID". The second (for i = 1) is "SITE_NAME" in case of TRANSMITTERS
table, and so on. The last one corresponds to i = ColumnCount.
To read the calculation radii of all the transmitters, you write:
Dim i
Dim radius
Dim records
Set records = Atoll.ActiveDocument.GetRecords("Transmitters", True)
For i = 1 To records.RowCount
radius = records.GetValue(i, “CALC_RADIUS”)
Next
Note that the loop does not start with i = 0 because GetValue would return the string "CALC_RADIUS" and not a
value.

76

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

If we know that column "CALC_RADIUS" is number 11, we could instead write:
radius = records.GetValue(i, 11)
But it is better to let Atoll manage the correspondence by itself.
The table names you can use to request GetRecords in a document are Atoll tables defined in the document
template initially used to create your document, and depend on the type of network.
You can also get some additional tables: Predictions, Zones.
◼

Predictions tabular data gives access to path loss and signal level matrices.

◼

Zones tabular data gives access to calculation and focus zones.

For more information, see "Zones and Predictions Tabular Data Objects" on page 91.

6.2 ColumnCount
Returns the number of columns of the TabularData Object.
HRESULT get_ColumnCount(long *pVal);
Parameters
[out] pVal: Address of the long integer used to return the number of columns.
Remarks
This number does not include the RECORD_ID column. If a table TABLE1 is defined by FIELD1, FIELD2, and FIELD3,
ColumnCount returns 3, even though there are 4 columns : RECORD_ID, FIELD1, FIELD2, and FIELD3.
get_ColumnCount returns the number of columns in the recordset, as opposed to get_Column, which returns the
column definition of the table.

6.3 RowCount
Returns the number of rows of the TabularData Object
HRESULT get_RowCount(long *pVal);
Parameters
[out] pVal: Address of the long integer used to return the number of rows.
Remarks
The first row is row number 0 and it contains the TabularData Object field names. If a table TABLE1 has no record,
0 is returned. The actual contents of the table starts at row number 1. GetValue(0, 1) returns FIELD1, which is the
name of the column number 1 (read in row number 0). GetValue(0, 0) returns RECORD_ID, which is the name of the
column number 0 (read in row number 0). GetValue(1, 1) returns the value for column FIELD1 (number 1) in row
number 1.

© 2022 Forsk. All Rights Reserved.

77

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

6.4 Edit
Puts a row into edition mode.
HRESULT Edit(long iRow);
Parameters
[in] iRow: The long integer used to specify the row number to put into edition mode.
Remarks
Once a row is put into edition mode, it is possible to change the row contents by using SetValue. Update is used to
commit the row changes.

q

Don’t forget to call this method before a call to SetValue and to call Update to
commit the changes in the row.

6.5 AddNew
Adds a new empty row to the TabularData Object. The row added is put into edition mode.
HRESULT AddNew();

q

Don’t forget to call this method before a call to SetValue and to call Update to
actually add the new row.

6.6 Update
Commits a row changes and puts the row from edition mode to normal mode.
HRESULT Update(long *piRow);
Parameters
[out] piRow: The long integer pointer used to return the number of the row that was in edition mode. If the method
Edit started the editing, the same iRow as in Edit is returned. If it was AddNew method, the number is the row number
where the new record has been added.
Remarks
At one point in time, only one record can be put into edition mode. This method must be called once after each Edit
and AddNew. Editing another record without updating the previous one will throw an error. Edit/Update cannot be
mixed up for different records, neither can be AddNew/Update.

78

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

6.7 Delete
Deletes a record.
HRESULT Delete(long iRow);
Parameters
[in] iRow: The long integer used to specify the row number of the record to delete.
Remarks
A valid iRow number is any integer, such that 0 < iRow <= RowCount. Deletion can fail if the record to delete is related
to another one. For instance an antenna from the table "ANTENNAS" cannot be deleted if it is being used by a
transmitter from the table "TRANSMITTERS".
Even if the record deletion doesn’t break integrity relations between tables, deleting a record may involve updating
other tables or records.
For instance, be careful when using this method with the "TRANSMITTERS" table and the "TRXs" table. If you delete
one TRX, you want to edit the "TRANSMITTERS" table in order to update the field "NUM_TRX".

6.8 GetValue
Returns a value of a column for a given row.
HRESULT GetValue(long iRow, const VARIANT iCol, VARIANT *pVal);
Parameters
[in] iRow: The long integer used to specify the row number.
[in] iCol: The VARIANT used to specify a column. When iCol is of type VT_I4, iCol is interpreted as a column number.
When iCol is of type VT_BSTR, iCol is interpreted as a column name.
[out] pVal: Address of the VARIANT used to return the column value.
Remarks
A valid iRow number is any integer, such that 0< iRow<= RowCount. A valid iCol is either an integer such that 0< iCol
<= ColumnCount or a string containing the name of an existing column.
The column names are not case sensitive.
You should never assume that the type of the returned VARIANT is the one you expect. For instance, a VARIANT of
type VT_NULL may be returned when the value of the column is the "Null" value. You should explicitly convert the
returned VARIANT to the type you expect and handle conversion errors.
When using a TabularData Object to access database tables, please refer to the Atoll Administrator Manual for the
available column names, types, units, and to check if the column specification allows for "Null" values. For site
coordinates values, please refer to the Atoll Technical Reference Guide for coordinate systems and units. Site
coordinates are expressed in the internal coordinate system of the Atoll document.
Example
Set sites = app.ActiveDocument.GetRecords(“Sites”)
For i = 1 To sites.ColumnCount
colName = sites.GetValue(0, i)
Next

© 2022 Forsk. All Rights Reserved.

79

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

6.9 SetValue
Sets the value of a column for the row being edited or added.
HRESULT SetValue(const VARIANT iCol, const VARIANT newVal);
Parameters
[in] iCol: The VARIANT used to specify a column.
[in] newVal: The VARIANT used to specify the column value.
Remarks
A valid iCol is either an integer such that 0 < iCol <= ColumnCount or a string containing the name of an existing
column. The column names are not case sensitive.
You must have previously called Edit or AddNew to specify the row to edit before writing the column value.If this
method is used for a large number of records, it is recommended to get the column numbers beforehand and then
to use the SetValue method with this number and not with a VARIANT of type VT_BSTR. This will run faster. To get
the column number, you can search the row number 0 for the field name you want to use.
Example
This example increments all the TXLOSSES of all the transmitters in the active document by 1 dB.
Dim transmitters
Dim doc
Dim i
Dim txLosses
Set doc = app.ActiveDocument
Set transmitters = doc.GetRecords(“Transmitters”)
For i = 1 To transmitters.RowCount
txLosses = transmitters.GetValue(i, “LOSSES”)
transmitters.Edit(i)
transmitters.SetValue(“LOSSES”, txLosses + 1)
transmitters.Update
Next
Instead, we could have used:
For i = 1 To transmitters.RowCount
txLosses = transmitters.GetValue(i, 12)
transmitters.Edit(i)
transmitters.SetValue(12, txLosses + 1)
transmitters.Update
Next

Updating the main contour of the focus zone:
Public Sub WriteZone()
Set doc = ActiveDocument
Set zones = doc.GetRecords("Zones", true)
row = zones.Find(0, "NAME", atoEQ, "FocusZone")
Dim pts(3,1)
pts(0,0) = 555000
pts(0,1) = 2188000

80

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

pts(1,0) = 600000
pts(1,1) = 2188000
pts(2,0) = 600000
pts(2,1) = 2140000
pts(3,0) = 555000
pts(3,1) = 2140000
zones.Edit row
zones.SetValue "POINTS", pts
zones.Update
End Sub

6.10 GetPrimaryKey
Returns the value of the primary key for a given row number.
HRESULT GetPrimaryKey(long iRow, VARIANT* pVal);
Parameters
[in] iRow: The row number.
[out] pVal: Address of the VARIANT used to return the primary key.
Remarks
A valid iRow number is an integer whose value is greater than zero or equal to zero and lower than or equal to the
row count of the TabularData object. Most of TabularData objects have a primary key. If no primary key is defined,
the value of the column RECORD_ID for the row iRow is returned. When the TabularData object primary key is made
of several columns, the type of the variant returned is a one dimension VARIANT array, of type
VT_ARRAY|VT_VARIANT, and VARIANT array values are the values of the columns defining the primary key.
Otherwise, the VARIANT returned is the value of the column used to define the primary key.
When 0 is used for the iRow parameter, the names of the columns defining the primary key are returned. The variant
returned is of type VT_BSTR or VT_ARRAY|VT_VARIANT with variants of type VT_BSTR, whether the primary key is
made of one or several columns, respectively.

6.11 FindPrimaryKey
Searches the row whose primary key equals the input value and returns the row number of the row found. If no row
is found, returns –1.
HRESULT FindPrimaryKey(VARIANT val, long* iRow);
Parameters
[in] val: The VARIANT used to specify the key value to search for.
[out] iRow: Address of the long integer used to return the number of the row whose primary key equals val. If no row
is found, -1 is returned.
Remarks
When the primary key is made of several columns, the input variant must be of type VT_ARRAY|VT_VARIANT.

© 2022 Forsk. All Rights Reserved.

81

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

6.12 Find
Searches a column for a value.
HRESULT Find(
long iRowStart,
const VARIANT iCol,
enum AtoCompareOp op,
const VARIANT value,
long* piRow
);
Parameters
[in] iRowStart: The long integer used to specify the row number from which the value will be searched for.
[in] iCol: The VARIANT used to specify the column number or the column name that will be searched.
[in] op: The atoCompareOp enumeration value used to specify the search criteria (greater than, less than, equal to,
etc).
[in] value: The VARIANT used to specify the value to search.
[out] piRow: The long integer pointer used to return the row number of the first row matching the search criteria. –
1 is returned if no row is found.
Remarks
Patch iRowStart inside a loop in order to scan several rows matching the search criteria.
This method should be used only for a few searches, because on the Atoll side, this method scans the rows one
after the other and can be very time consuming.
If the column is the primary key of the TabularData Object, use FindPrimaryKey instead.
For repetitive search operations, use a collection (map) of all the rows and write your own filter.
Example
In this example, we search for all transmitters whose LOSSES are equal to 2, and replace them with 3.
Dim transmitters
Dim iRow
Const atoEQ = 0
Set transmitters = ActiveDocument.GetRecords(“Transmitters”, False)
iRow = 0
While iRow <> -1
iRow = transmitters.Find(iRow + 1, "LOSSES", atoEQ, 2)
If iRow <> -1 Then
transmitters.Edit(iRow)
transmitters.SetValue("LOSSES", 3)
transmitters.Update
End If
Wend

82

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

6.13 GetFormattedValue
Returns a column value formatted as a string.
HRESULT GetFormattedValue(long iRow, const VARIANT iCol, BSTR *pVal);
Parameters
[in] Row: The row number.
◼

A valid iRow number is an integer whose value is greater than zero or equal to zero, and lower than or equal to
the row count of the TabularData object.

[in] iCol: The VARIANT used to define the column.
◼

When iCol variant type if VT_I4, iCol is interpreted as a column number. A valid column number is an integer
whose value is greater than zero or equal to zero, and lower than or equal to the column count of the
TabularData object.

◼

When iCol variant type if VT_BSTR, iCol is interpreted as a column name. Column names are not case
sensitive.

[out] pVal: Address of a BSTR string used to return the formatted value.
Remarks
When 0 is used for the iRow parameter, the title of the column specified by iCol is returned. The title of a column is
localized and may be shown to a user, as opposed to the column name.

6.14 CancelUpdate
Cancels a pending update. This method may be called after Edit or AddNew to cancel the operation.
HRESULT CancelUpdate();

6.15 ColumnNumber
Returns a column number.
HRESULT get_ColumnNumber(const VARIANT vColName, long *pCol);
Parameters
[in] vColName: The VARIANT used to specify the name of the column.
[ou] pCol: Address of the long integer used to return column number.
Remarks
It is faster to read data from tables using the column number instead of the column name. It also works for linked
fields.
For instance you can write:
Set sites = doc.GetRecords("SITES", False)
colLatitude = sites.ColumnNumber("LATITUDE")
For i = 1 To sites.RowCount
latitude = sites.GetValue i, colLatitude

© 2022 Forsk. All Rights Reserved.

83

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

Next

6.16 CanEdit
Checks if rows can be modified.
HRESULT get_CanEdit(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether rows can be modified or not.
Remarks
If VARIANT_FALSE is returned, then the Edit operation on this table is undefined.

6.17 CanAddNew
Checks if rows can be added.
HRESULT get_CanAddNew(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether rows can be added or not.
Remarks
If VARIANT_FALSE is returned, then the AddNew operation on this table is undefined.

6.18 CanFilterSort
Checks if rows can be filtered or sorted.
HRESULT get_CanFilterSort(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether rows can be filtered or sorted.
Remarks
If VARIANT_FALSE is returned, then the Filter and Sort operations on this table are undefined.

6.19 Filter
Returns the filter currently set on the table.
HRESULT get_Filter(VARIANT *pvCriteria);

84

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

Parameters
[out] : pvCriteria: Address of the VARIANT used to return the filter previously set on the table.
Remarks
Please refer to the AtoRowFilter enumeration definition for the list of constants used to filter only modified, added,
or deleted rows.

6.20 Filter
Filters the table data according to a filter criteria.
HRESULT put_Filter(const VARIANT vCriteria);
Parameters
[in] vCriteria: The VARIANT used to specify the filter criteria. When vCriteria is of type VT_I4, it is interpreted as an
AtoRowFilter enumeration value. When vCriteria is of type VT_BSTR, it is interpreted as a filter string. Filter strings
are what can be seen in the Atoll "Table" tab properties for record folders, when using advanced filtering. Please
refer to the Atoll User Manual for more information about advanced filtering on data.
Remarks
Please refer to the AtoRowFilter enumeration definition for the list of constants used to filter only modified, added,
or deleted rows.
If the table is retrieved using GetRecords with aAll parameter set to False, setting this property is the same as setting
the filter interactively in an Atoll session.
To remove any previous filter, call this method either with atoRowFilterNone value or with an empty string.
When the Atoll document is not connected to a database, atoRowFilterModifiedOrNew and atoRowFilterDeleted are
not available.

6.21 Sort
Returns the sort order currently set on the table.
HRESULT get_Sort(VARIANT *pvCriteria);
Parameters
[in] vCriteria: The VARIANT, of type VT_BSTR, used to specify the sort order. It contains a list of comma separated
database field names. Each field is optionally followed by the DESC keyword to indicate that the sort order
associated with the field is "Descending".
Remarks
If the table is retrieved using GetRecords with aAll parameter set to False, setting this property is the same as setting
the sort order interactively in an Atoll session.
To remove any previous sort order, call this method with an empty string.
Example
Private Sub PrintTransmittersTable(transmRec, infoMsg)
For nRow = 1 To transmRec.RowCount
LogMessage infoMsg & ": " & transmRec.GetValue(nRow, "TX_ID")

© 2022 Forsk. All Rights Reserved.

85

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

Next
End Sub
Sub Main
Set t = ActiveDocument.GetRecords("transmitters", False)
‘ Sort ascending according to the "SITE_NAME" database field
t.Sort = "SITE_NAME"
PrintTransmitterTables t, "Sort = SITE_NAME"
‘ Sort descending according to the "SITE_NAME" database field
t.Sort = "SITE_NAME DESC"
PrintTransmittersTable t, "Sort = SITE_NAME DESC"
End Sub

6.22 Sort
Sorts the table data.
HRESULT put_Sort(const VARIANT vCriteria);
Parameters
[in] vCriteria: The VARIANT, of type VT_BSTR, used to specify the sort order. It contains a list of comma separated
database field names. Each field is optionally followed by the DESC keyword to indicate that the sort order
associated with the field is "Descending".
Remarks
If the table is retrieved using GetRecords with aAll parameter set to False, setting this property is the same as setting
the sort order interactively in an Atoll session.
To remove any previous sort order, call this method with an empty string.
Example
See "Sort" on page 85.

6.23 GetOriginalValue
Returns an original field value.
HRESULT GetOriginalValue(long iRow, const VARIANT iCol, VARIANT *pVal);
Parameters
[in] iRow: The long integer used to specify a row number.
[in] iCol: The VARIANT used to specify a column name or a column number.
[out] pVal: Address of VARIANT used to return the original column value.
Remarks
The original value, as opposed to the current value return by GetValue, is the value retrieved from the database when
the Atoll document has been refreshed for the last time.
If the row is unmodified, the original value is the same as the current value.

86

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

If the row is deleted the current value is the null value and the original value is the value just before the row was
deleted.

6.24 RowStatus
Returns a row status.
HRESULT get_RowStatus(long iRow, enum AtoRowStatus *pVal);
Parameters
[in] iRow: The long integer used to specify a row number.
[out] pVal: Address of the AtoRowStatus enumeration value used to return the row status.
Remarks
When an Atoll document is open from a database, row statuses are set to atoRowStatusUnmodified and original
values are set for all row columns.
When the document is archived or refreshed from the database, row statuses are set to atoRowStatusUnmodified
and all columns original values are set for rows that have been archived or refreshed.
When a new row is created, the row status is set to atoRowStatusNew and the original value for all columns are set
to the null value.
When a row is modified, the row status is set to atoRowStatusModified. If you revert the row changes, the row status
is set to atoRowStatusUnmodified.
When a row is deleted, the row status is set to atoRowStatusDeleted, the row column values are set to the null value,
and the original column values are the column values just before the row was deleted.

6.25 Columns
Returns the table column definitions.
HRESULT get_Columns(ITabularData** ppVal);
Parameters
[out] ppVal:
Address of the ITabularData interface pointer used to return a tabular data object holding the table columns
definition:
Column Name

Type

Description

LEGEND

String

The display name of the column

NAME

String

The database name of the column

TYPE

Integer

The data type of the column. Valid values are:
◼ 0=Text
◼ 1=Short integer
◼ 2=Long integer
◼ 3=Single
◼ 4=Double
◼ 5=True/False
◼ 6=Date/Time
◼ 7=Currency;

© 2022 Forsk. All Rights Reserved.

87

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

SIZE

Integer

The size, in bytes, for a column of TYPE 0 (Text).

DEFAULT

Variant

The default value of the column. The type of the variant depends on the type of the column,
as indicated by TYPE.
May be Null.

FORMATTED_DEFAULT

String

The default value of the column, formatted as a string.

GROUP

String

The name of the database field group the column belongs to.

ISCUSTOMFIELD

Boolean

Whether the column is a user column (True), or not (False).

CHOICELIST_TYPE

Integer

Whether a column of TYPE 0(Text) content values are restricted to the values specified
in CHOICELIST_VALUES.

CHOICELIST_VALUES

String

New-line separated string of valid values for a column of TYPE text.

ISHYPERTEXTFIELD

Boolean

Whether field is a hypertext field (True) or not (False).

ISREADONLYFIELD

Boolean

Whether the field is read-only (True) or not (False).

UNITCATEGORY

Integer

The unit category of the column. Values are:
◼ -1= No category
◼ 0 = Transmission values
◼ 1 = Reception values
◼ 2 = Length values
◼ 3 = Distance values
◼ 4 = Gain values
◼ 5 = Speed values
◼ 6 = Temperature values
◼ 7 = Lineic losses values
◼ 8 = Geometry
◼ 9 = Latitude coordinate
◼ 10= Longitude coordinate

UNITNAME

String

The unit name of the column (which is used by ITabularData: GetValue)

DISPLAYUNITNAME

String

The display unit name of the column (which is used by ITabularData: GetValue)

Remarks
get_Column returns the column definition of the table, as opposed to get_ColumnCount, which returns the number
of columns in the recordset.

6.26 SetValues
Updates the table content with the given values.
HRESULT SetValues(VARIANT values, VARIANT *statuses);
Parameters
[in] values:
A VARIANT used to specify the rows, the columns, and the values to update.
The values VARIANT must be a 2-dimension variant array of type VT_ARRAY|VT_VARIANT.
The first row is used to specify the columns to update.
The last column must be named “TABULARDATA_POSITION”, it is used to specify the row position (integers, VT_I4)
to use in the table operation:
If the row position is a valid row number, such as 1 <= row position <= RowCount, then a table “Edit” operation will
be performed.
If -1 is used to specify the row position, then a table “AddNew” operation will be performed.

88

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

AT350_TAG_E3

The rest of the variant array is used to specify the values to update.
Elements of the values array of type VT_EMPTY are ignored in the update process.
SetValues attempts to update all specified rows and returns an update status for each row in the statuses output
VARIANT.
[out] statuses:
An output VARIANT used to return an update status for each row to update, using a VARIANT of type
VT_ARRAY|VT_VARIANT, a 2-dimension array of variants.
There are 3 columns in the statuses output array(dimension number 2):
"TABULARDATA_POSITION":
For each row, this column is used to return its row number.
"TABULARDATA_ERRORCODE":
For each row, this column is used to return an error code (VT_I4) in case an error has occurred retrieving values for
that row, VT_EMPTY otherwise.
"TABULARDATA_ERRORMESSAGE":
For each row, this column is used to return an error message (VT_BSTR) in case an error has occurred retrieving
values for that row, VT_EMPTY otherwise.
Remarks:
The "TABULARDATA_ERRORCODE" column of the status variant array must be used to check for any errors, for any
row in the returned table.

6.27 ITabularData5::get_HasGUIRights
Checks if rows can be added/modified or deleted by checking the GUI user rights
HRESULT get_HasGUIRights(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return whether rows can be added/modified/deleted or not.

© 2022 Forsk. All Rights Reserved.

89

Atoll 3.5.0 Task Automation Guide
Chapter 6: TabularData Object

90

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 7: Zones and Predictions Tabular Data Objects

AT350_TAG_E3

7 Zones and Predictions Tabular Data Objects
7.1 Zones Tabular Data Object
Column Name
NAME

Type
String

Description
"ComputationZone" if this row is the computation zone.
"FocusZone" if this rowis part of the focus zone.
"FilterZone" if this row is part of the filtering zone.
"PrintZone" if this row is part of the printing zone.
"ExpBitmapZone" if this row is part of the coverage export zone.
Atoll >= 2.8.1
"HotSpotZone" if this row is part of the hot spot zone.

POINTS

Array

An array of points as double values.

CONTOUR_NUM

Integer

The contour index.

POLYGON_NUM

Integer

The polygon index.

POLYGON_NAME

String

Atoll >= 2.8.1
The name of the polygon.
For hot spot zones, it is the name of a specific hot spot zone.
For other zones, it is the name the zone sub-folder, in the explorer window.
This column is read-only.

Atoll Version
◼

≥ 2.8.1Hot spot zones can be accessed. Their content is identified by the "NAME" column ("HotSpotZone"),
then a specific hot spot zone is specified by the "POLYGON_NAME" column, which is used to indicate a
specific hot spot zone in the hot spot zones folder.
However, unlike other zones, hot spot zone access is read-only. It is not possible to edit a hot spot zone, to
delete a hot spot zone, or to create a new hot spot zone.

◼

≥ 3.4.1: Zones can be exported.

Example
Reading the first contour of the focus zone:
Public Sub ReadZone()
Set doc = ActiveDocument
Set zones = doc.GetRecords("Zones", True)
row = zones.Find(1, "NAME", atoEQ, "FocusZone")
pts = zones.GetValue(row, "POINTS")
If (IsArray(pts)) Then
For i = LBound(pts, 1) To UBound(pts, 1)
ptx = pts(i,0)
pty = pts(i,1)
MsgBox "Pts(" + CStr(i) + ") = " + CStr(ptx) + ", " + CStr(pty)
Next
Else
MsgBox "Not an array"

© 2022 Forsk. All Rights Reserved.

91

Atoll 3.5.0 Task Automation Guide
Chapter 7: Zones and Predictions Tabular Data Objects

End If
End Sub

7.2 Predictions Tabular Data Object
The "PREDICTIONS" tabular data object is read-only except for the LOCKED field, which can be used to lock or unlock
path loss matrices of a transmitter.
Atoll Version

≥ 2.8.0
The field PATH_NAME is read-write. Its value can be set to Null , in which case path loss matrices for TX_ID are
deleted.
Column Name

Type

Description

TX_ID

String

Transmitter name.

LOCKED

Boolean

True if the path loss matrices are locked, otherwise False.

VALID

Boolean

True if the main and extended path loss matrices are valid, otherwise False.

INVALID_CAUSE

String

Cause of invalidity, when VALID returns False.
Null value when VALID returns True.

SIZE

Integer

Size of the main matrix plus the size of the extended matrix, in bytes.

PATHNAME

String

Null value when there is no storage for the main matrix.
"(Embedded in document)" if the storage is not external.
Otherwise contains the main path loss matrix file path.

PATHLOSS

Object

The object implements the IGridData interface. This grid data contains the main
path loss matrix data for transmitter TX_ID.
Null value when there is no available result for the main matrix.

SIGNAL

Object

The object implements the IGridData interface. This grid data contains the main
signal level matrix data for transmitter TX_ID.
Null value when there is no available result for the main matrix.

LOWRES_PATHLOSS

Object

The object implements the IGridData interface. This grid data contains the
extended path loss matrix data for transmitter TX_ID.
Null value when there is no available result for the extended matrix.

LOWRES_SIGNAL

Object

The object implements the IGridData interface. This grid data contains the
extended signal level matrix data for transmitter TX_ID.
Null value when there is no available result for the extended matrix.

LOWRES_PATHNAME

String

Atoll version

≥ 2.7.0

Null value when there is no storage for the extended matrix.
"(Embedded in document)" if the storage is not external.
Otherwise contains the extended path loss matrix file path.

Atoll Version

≥ 2.8.1
New columns are available
These values are available even when VALID returns FALSE but they are not up to date when the resolution of path
loss matrices, the calculation area, or the transmitter location has changed.
Column Name
GRID_X

Type
Double

Description
X-coordinate of the top-left corner of the main path loss matrix upper-left pixel.
Null value when there is no available result for the main matrix.

GRID_Y

Double

Y-coordinate of the top-left corner of the main path loss matrix upper-left pixel.
Null value when there is no available result for the main matrix.

92

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 7: Zones and Predictions Tabular Data Objects

AT350_TAG_E3

Column Name
GRID_NX

Type
Integer

Description
Number of columns in the main path loss matrix.
Null value when there is no available result for the main matrix.

GRID_NY

Integer

Number of rows in the main path loss matrix.
Null value when there is no available result for the main matrix.

GRID_RESX

Double

Resolution of the main path loss matrix, in metre.
Null value when there is no available result for the main matrix.

GRID_RESY

Double

Resolution of the main path loss matrix, in metre.
Null value when there is no available result for the main matrix.

LOWRES_GRID_X

Double

X-coordinate of the top-left corner of the extended path loss matrix upper-left
pixel.
Null value when there is no available result for the extended matrix.

LOWRES_GRID_Y

Double

Y-coordinate of the top-left corner of the extended path loss matrix upper-left
pixel.
Null value when there is no available result for the extended matrix.

LOWRES_GRID_NX

Integer

Number of columns in the extended path loss matrix.
Null value when there is no available result for the extended matrix.

LOWRES_GRID_NY

Integer

Number of rows in the extended path loss matrix.
Null value when there is no available result for the extended matrix.

LOWRES_GRID_RESX

Double

Resolution of the extended path loss matrix, in metre.
Null value when there is no available result for the extended matrix.

LOWRES_GRID_RESY

Double

Resolution of the extended path loss matrix, in metre.
Null value when there is no available result for the extended matrix.

Atoll Version

≥ 3.1.0
New columns are available:
Column Name

Type

Description

TX_PATHLOSS

Object

The object implements the IGridData interface.

TX_SIGNAL

Object

The object implements the IGridData interface.

TX_LOWRES_PATHLOSS

Object

The object implements the IGridData interface.

TX_LOWRES_SIGNAL

Object

The object implements the IGridData interface.

TX_PATHLOSS, TX_SIGNAL , TX_LOWRES_PATHLOSS, TX_LOWRES_SIGNAL for the transmitter TX_ID do not take
into account its repeaters or remote antennas.
On the contrary, using PATHLOSS, SIGNAL, LOWRES_PATHLOSS, LOWRES_SIGNAL, contributions from repeaters
or remote antennas are combined into one matrix.
Please use TX_PATHLOSS, TX_SIGNAL , TX_LOWRES_PATHLOSS, TX_LOWRES_SIGNAL columns when you need
to consider transmitter signal or path loss independently from its repeaters or remote antennas.
Atoll Version

≥ 3.2.0
It is now possible to update path loss matrices with external results (.LOS files).
You can edit the PATH_NAME or LOWRES_PATHNAME columns, specifying valid .LOS absolute full path.
In this case, when the row in the predictions table is updated, path loss matrices are updated with the content of
files previously specified.
Please note that fo this to work, you have to georeference your provided .LOS files, with a standard BIL header file
(.hdr). Please note that even if your .LOS files need to be georeferenced just like they were .BIL files, .LOS files are
written bottom-up, not top-down.
Atoll Version

≥ 3.4.1

© 2022 Forsk. All Rights Reserved.

93

Atoll 3.5.0 Task Automation Guide
Chapter 7: Zones and Predictions Tabular Data Objects

The name of the predictions tabular data object depends on whether the document uses a single-RAT or a multiRAT template.
For Single-RAT documents: PREDICTIONS
For Multi-RAT documents that combine at least two radio technologies:
Technology

Predictions table

LTE

LPREDICTIONS

UMTS

UPREDICTIONS

GSM

GPREDICTIONS

5G NR

XGPREDICTIONS

CDMA2000

CPREDICTIONS

TX_PATHLOSS

Object

The object implements the IGridData interface. This grid data contains the main
path loss matrix data for transmitter TX_ID.
Null value when there is no available result for the main matrix.
Values returned do not include contributions from repeaters or remote antennas
of the transmitter TX_ID.

TX_SIGNAL

Object

The object implements the IGridData interface. This grid data contains the main
signal level matrix data for transmitter TX_ID.
Null value when there is no available result for the main matrix.
Values returned do not include contributions from repeaters or remote antennas
of the transmitter TX_ID.

TX_LOWRES_PATHLOSS

Object

The object implements the IGridData interface. This grid data contains the
extended path loss matrix data for transmitter TX_ID.
Null value when there is no available result for the extended matrix.
Values returned do not include contributions from repeaters or remote antennas
of the transmitter TX_ID.

TX_LOWRES_SIGNAL

Object

The object implements the IGridData interface. This grid data contains the
extended signal level matrix data for transmitter TX_ID.
Null value when there is no available result for the extended matrix.
Values returned do not include contributions from repeaters or remote antennas
of the transmitter TX_ID.

94

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 8: CoordSystem Object

AT350_TAG_E3

8 CoordSystem Object
This object contains the entire definition of a coordinate system. Several coordinate systems are used in Atoll
documents; one for display, one for projected geographic files, and one for site coordinates. The last one can be
related to the system used for display.
This object is not defined in Atoll library but in the FSKGISLib library. It can convert points coordinates from one
coordinate system to another.
The CoordSystem object provides the following properties and methods:
Name

Description

Code

Returns the numeric code of the coordinates system or sets the
numeric code of a new coordinate system.

ConvertCoordsTo

Converts the coordinates of a point expressed in the current system to another one.

Datum

Returns or sets the numeric value of the datum.

DatumName

Name of the datum.

Description

Description of the datum.

Ellipsoid

Returns or sets the numeric value of the ellipsoid.

EllipsoidName

Name of the ellipsoid.

Name

Returns or sets the name of the coordinates system.

Pick

Opens the coordinates system dialogue.

ProjMethod

Projection method used for the current coordinates system.

ProjParameter

Reads a parameter of the projection.

SetDatum

Changes the datum of the system.

SetProjection

Sets the projection parameters of the coordinate system.

Unit

Returns or sets the unit of the coordinate system.

Attributes

For details on coordinate systems, see the Technical Reference Guide.

8.1 How to Access a CoordSystem Object
To get the coordinate system used for sites:
Dim doc
Dim coordSys
Set doc = Atoll.ActiveDocument
Set coordSys = doc.CoordSystemInternal

© 2022 Forsk. All Rights Reserved.

95

Atoll 3.5.0 Task Automation Guide
Chapter 8: CoordSystem Object

8.2 Code
Returns the numeric code of the coordinates system or sets the numeric code of a new coordinate system.
HRESULT Code(long *pVal);
HRESULT Code(long val);
Parameters
pVal: Address of the Long read as the code of the system.
val: Long value representing the code of the system to set.

q

Classical system codes have values less than 32767. System codes greater or
equal to 32768 correspond to user defined systems.

Remarks
It is not possible to change the coordinate system of a document directly with the Code property. You must create
a new Atoll.CoordSystem object with a different Code property.

8.3 ConvertCoordsTo
Converts the coordinates of a point expressed in the current system to another one.
HRESULT ConvertCoordsTo(
IDispCoordSystem *targetCS,
VARIANT inPoint,
VARIANT *outPoint
);
Parameters
[in] targetCS: An IDispCoordSystem interface pointer used to specify the coordinate system to which input
coordinates must be converted.
[in] inPoint: A VARIANT used used to specify the coordinates of an input point. The coordinates are expressed in the
current coordinate system. The VARIANT must be a one dimension array of 2 floating point values (VT_ARRAY |
VT_R8). Element at index 0 is used to specify the x coordinate, element at index 1 is used to specify the y coordinate.
[out] outPoint: A pointer to a VARIANT used to return the coordinate of the inPoint input point expressed in the
targetCS coordinate system. The type of the VARIANT returned is VT_ARRAY | VT_R8 : a one dimension array of 2
floating point values. Element at index 0 is used to specify the x coordinate, element at index 1 is used to specify
the y coordinate.
Example
Public Sub ConvertSitesCoordinates
Dim sites
Dim x
Dim y
Dim oFrom
Set oFrom = ActiveDocument.CoordSystemInternal
Dim oTo
Set oTo = ActiveDocument.CoordSystemDisplay
Dim coords
Set sites = ActiveDocument.GetRecords("Sites", True)

96

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 8: CoordSystem Object

AT350_TAG_E3

Dim i
For i = 1 To sites.RowCount
x = sites.GetValue(i, "LONGITUDE")
y = sites.GetValue(i, "LATITUDE")
coords = oFrom.ConvertCoordsTo(oTo, Array(x, y))
LogMessage sites.GetValue(i,"NAME")&":"&CStr(coords(0))&";"&CStr(coords(1))
Next
End Sub

8.4 Datum
Returns or sets the numeric value of the datum.
HRESULT Datum(long *pVal);
HRESULT Datum(long val);
Parameters
pVal: Address read as the datum code of the system.
val: Value to be set as the datum code of the system.

8.5 DatumName
Name of the datum.
HRESULT DatumName(BSTR *pVal);
Parameters
pVAl: Pointer to the datum name.

8.6 Description
Description of the datum.
HRESULT Description(BSTR *pVal);
Parameters
pVal: Pointer to datum description.

© 2022 Forsk. All Rights Reserved.

97

Atoll 3.5.0 Task Automation Guide
Chapter 8: CoordSystem Object

8.7 Ellipsoid
Returns or sets the numeric value of the ellipsoid.
HRESULT Ellipsoid(long* pVal);
HRESULT Ellipsoid(long Val);
Parameters
pVal: Address read as the ellipsoid code of the system.
val: Value to be set as the ellipsoid code of the system.

8.8 EllipsoidName
Name of the ellipsoid.
HRESULT EllipsoidName(BSTR* pVal);
Parameters
pVal: Pointer to the name of the ellipsoid.

8.9 Name
Returns or sets the name of the coordinates system.
HRESULT Name(BSTR *pVal);
HRESULT Name(BSTR pVal);
Parameters
pVal: Address read as the name of the coordinates system.
val: Value to be set as the name of the coordinates system.

8.10 Pick
Opens the coordinates system dialogue.
HRESULT Pick(OLE_HANDLE parentWindow, WORD types, VARIANT_BOOL *ret);
Parameters
parentWindow: OLE_HANDLE of the parent window for which the dialogue is required to be opened.
types: Bitset of CoordSysType (see CoordSysTypes) corresponding to the types of systems the dialogue must filter
before opening.
ret: Pointer to a VARIANT_BOOL, set to VARIANT_TRUE if the user quits the dialogue with OK, otherwise
VARIANT_FALSE.

98

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 8: CoordSystem Object

AT350_TAG_E3

CoordSysTypes
enum CoordSysType
{ fgUndefinedCoordSys = 1,
fgGeographic2D

= 2,

fgProjected2D

= 4

} CoordSysType;

8.11 ProjMethod
Projection method used for the current coordinates system.
HRESULT ProjMethod(ProjectionMethod *pVal);
Parameters
pVal: Pointer to the read ProjectionMethod.

8.12 ProjParameter
Reads a parameter of the projection.
HRESULT ProjParameter(ProjParameterIndices index, double *pVal);
Parameters
index: Index of the parameter to read.
pVal: Address of the double containing the value of the parameter.
Remarks
Keep in mind that the real valid range of index parameters depends on the projection method.

8.13 SetDatum
Changes the datum of the system.
HRESULT SetDatum(long ellipsoidCode, VARIANT params);
Parameters
ellipsoidCode: Numeric code of the ellipsoid of the new datum.
params: Parameters of the projection provided as an array of variants.

© 2022 Forsk. All Rights Reserved.

99

Atoll 3.5.0 Task Automation Guide
Chapter 8: CoordSystem Object

8.14 SetProjection
Sets the projection parameters of the coordinate system.
HRESULT SetProjection(ProjectionMethod method, VARIANT projectionParameters);
Parameters
[in] method: The ProjectionMethod enumeration value used to change the projection method of the coordinate
system.
[in] projectionParameters: A SAFEARRAY of VARIANTs of type VT_R8 used to specify the projection parameters of
the coordinate system. The projection parameters must match with the method parameter. Each parameter is
identified by its index in the array, starting from 0. Array indexes are the same as ProjParameterIndices enumeration
values. Projection parameters values are the the same as values returned by the ProjParameter property.

8.15 Unit
Returns or sets the unit of the coordinate system.
HRESULT Unit(GeographicUnit *pVal);
HRESULT Unit(GeographicUnit newVal);
Parameters
pVAl: Address of the current geographic unit of the system.
newVal: New value for the geographic unit.

100

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

9 ChildFolder Object
A ChildFolder object represents an item in the application explorer window. It can be a collection of sub-items.
The ChildFolder object provides the following properties and methods:
Name
Application

Description

Attributes

Returns the Application object.

Type: Application object
Access: Read

Parent

Returns the parent ChildFolder object.

Type: ChildFolder object
Access: Read

Name

Returns the ChildFolder object display name.

Type: String
Access: Read/Write

Name

Sets the ChildFolder object display name.

Type: String
Access: Read/Write

Count

Returns the number of children of the ChildFolder object.

Type: Integer
Access: Read

Item

Returns one of the children of the ChildFolder object.

Type: ChildFolder children
collection
Access: Read

_NewEnum

Returns an object used to enumerate the children of the ChildFolder object.

Visible

Returns the visibility state of the ChildFolder object.

Type: Boolean
Access: Read/Write

Visible

Sets the visibility state of the ChildFolder object.

Type: Boolean
Access: Read/Write

Selected

Returns the selected state of the ChildFolder object.

Type: Boolean
Access: Read/Write

Selected

Sets the selected state of the ChildFolder object.

Type: Boolean
Access: Read/Write

Export

Exports a ChildFolder object to a file, in a given format.

CentreOnMap

Centres the application map window around the ChildFolder
object.

Redraw

Redraws the ChildFolder object.

AddChild

Adds a new child to the current ChildFolder object.

Remove

Removes the ChildFolder object from its parent ChildFolder
object.

position

Returns the ChildFolder object position relative to its parent
ChildFolder object.

Type: Integer
Access: Read/Write

position

Sets the ChildFolder object position relative to its parent Child- Type: Integer
Folder object.
Access: Read/Write

Object

Access to some specific features on the ChildFolder object.

dispatch

Access to some specific features on the ChildFolder object.

ObjectKind

Returns a type identifier of the ChildFolder object.

Type: String
Access: Read

GetProperty

Returns a ChildFolder object property.

SetProperty

Sets a ChildFolder object property.

© 2022 Forsk. All Rights Reserved.

101

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

Name

Description

GetPropertiesInfo

Returns names and types for all properties available on the
ChildFolder object.

PropertyIsPropertyContainer

Returns true when a ChildFolder object property is a PropertyContainer object.

PropertyIsTabularData

Returns true when a ChildFolder object property a TabularData
object.

LoadProperties

Sets properties from a property container to the ChildFolder
object.

SaveProperties

Saves all the ChildFolder object properties to another property
container.

RemoveItem

Removes one of the children of the ChildFolder object.

SetCustomIcon

Sets the path of an icon to use for a custom child folder.

Attributes

9.1 How to Access a ChildFolder Object
A ChildFolder is first obtained through a root entry point from the document and is related to a tab of the Atoll
Explorer window.
Most ChildFolder objects may have children, can be selected, set visible, and renamed. Only coverage predictions
may be exported.
Dim folder
Dim item
Dim doc
Dim dataRoot
Const atoData = 0
Set doc = Atoll.ActiveDocument
Set dataRoot = doc.GetRootFolder(atoData)
For Each folder in dataRoot
‘ do some work with this folder, for instance:
For Each item in folder
‘ do some work with this item
Next
Next

9.2 Application
Returns the Atoll Application object.
HRESULT get_Application(IApplication **ppVal);
Parameters
[out] ppVal: Address of the IApplication interface pointer used to return the Atoll Application object.

102

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

9.3 Parent
Returns the parent Atoll ChildFolder object.
HRESULT get_Parent(VARIANT *pVal);
Parameters
[out] pVal: Address of the VARIANT used to return the parent ChildFolder object. The type of the returned VARIANT
is VT_DISPATCH. When the ChildFolder object is a root ChildFolder object, the IDispatch interface pointer of the Atoll
Document is returned, otherwise the IDispatch interface pointer of the parent ChildFolder object is returned.

9.4 Name
Returns the ChildFolder object display name.
HRESULT get_Name(BSTR *pVal);
Parameters
[out] pVal: Address of the BSTR used to return the display name.
Example
Renaming the "Transmitters" folder.
Dim folder
Dim dataTab
Dim folderName
Const atoData = 0
Set dataTab = ActiveDocument.GetRootFolder(atoData)
For Each folder In dataTab
folderName = folder.Name
If folderName = “Transmitters” Then
folder.Name = “TransmittersTest”
End if
Next

9.5 Name
Sets the ChildFolder object display name.
HRESULT put_Name(const BSTR aNewVal);
Parameters
[in] aNewVal: The BSTR used to specify the display name.
Example
See "Name" on page 103.

© 2022 Forsk. All Rights Reserved.

103

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

9.6 Count
Returns the number of children of the ChildFolder object.
HRESULT get_Count(long *pVal);
Parameters
[out] pVal: Address of the long integer used to return the number of children.

9.7 Item
Returns one of the children of the ChildFolder object.
HRESULT get_Item(const VARIANT iIdx, IChildFolder **pVal);
Parameter
[in] iIdx: A VARIANT of type VT_I4 or VT_BSTR identifying the returned ChildFolder object. If the type of the variant
is VT_I4, it is interpreted as a zero-based index in the list of children. If the type of the variant is VT_BSTR, it is first
interpreted as the display name of the child to search for, and if the display name is not found, it is then interpreted
as a ChildFolder object kind, as returned by ObjectKind.
[out] pVal: Address of the IChildFolder interface pointer used to return a ChildFolder object.

9.8 _NewEnum
Returns an object used to enumerate the children of the ChildFolder object.
HRESULT get__NewEnum(LPUNKNOWN *ppUnk);
Parameters
[out] ppUnk: Address of the IUnknown interface pointer used to return the enumerator object. The IEnumVARIANT
interface is implemented by the enumerator object.
Example
Const atoModule = 2
Set modules = app.ActiveDocument.GetRootFolder(atoModule)
For Each module In modules
‘ do something with module
Next

9.9 Visible
Returns the visibility state of the ChildFolder object.
HRESULT get_Visible(VARIANT_BOOL *pVal);

104

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

Parameters
[out] pVal: Address of the VARIANT_BOOL used to return the visibility state.
The visibility state values are:
VARIANT_TRUE : the ChildFolder object may be displayed on Atoll Map View windows.
VARIANT_FALSE : the ChildFolder object won’t be displayed on Atoll Map View windows.
Remarks
The visibility state only makes sense for ChildFolder objects that may appear on Atoll Map View windows. Visible
and Visible calls are ignored for objects that do not support it. No error is returned.
Example
dataFolder.Item("Predictions").Visible = True

9.10 Visible
Sets the visibility state of the ChildFolder object.
HRESULT put_Visible(VARIANT_BOOL aNewVal);
Parameters
[in] aNewVal: The VARIANT_BOOL used to specify the visibility state.
The visibility state values are:
VARIANT_TRUE : the ChildFolder object may be displayed on Atoll Map View windows.
VARIANT_FALSE : the ChildFolder object won’t be displayed on Atoll Map View windows.
Remarks
The visibility state only makes sense for ChildFolder objects that may appear on Atoll Map View windows. Visible
and Visible calls are ignored for objects that don’t support it. No error is returned.
Example
dataFolder.Item("Predictions").Visible = True

9.11 Selected
Returns the selected state of the ChildFolder object.
HRESULT get_Selected(VARIANT_BOOL *pVal);
Parameters
[out] pVal: Address of the VARIANT_BOOL used to return the selected state of the ChildFolder object.
Remarks
Selected and Selected calls are ignored for objects that don’t support it. No error is returned.
Example
Public Sub SelectTx
Set doc = ActiveDocument

© 2022 Forsk. All Rights Reserved.

105

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

Const atoData = 0
Set dataFolder = doc.GetRootFolder(atoData)
’ Select the "Site0_0" transmitter
For Each folder In dataFolder
If folder.Name = "Transmitters" Then
folder.Item("Site0_0").Selected = True
End If
Next
End Sub

9.12 Selected
Sets the selected state of the ChildFolder object.
HRESULT put_Selected(VARIANT_BOOL aNewVal);
Parameters
[in] newVal: The VARIANT_BOOL used to specify the selected state.
Remarks
Selected and Selected calls are ignored for objects that don’t support it. No error is returned.
Example
See "Selected" on page 105.

9.13 Export
Exports a ChildFolder object to a file, in a given format. This method can only be used for studies and zones.
HRESULT Export(
const BSTR bstrFileName,
IDispCoordSystem* proj,
const BSTR bstrFormat
);
Parameters
[in] bstrFileName: A string containing an absolute file path.
[in] proj: An IDispCoordSystem interface pointer used to define the coordinate system for the export.
[in] bstrFormat: A string used to define the format of the file specified by bstrFileName.
The syntax for the bstrFormat parameter is:
PropertyName=Value;[PropertyName=Value;]format
Available values for format for studies and zones are:

106

◼

SHP

◼

AGD

◼

MIF

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

◼

TAB

Available values for format for studies are:
◼

BMP

◼

TIF

◼

BIL

◼

TXT

◼

ARCVIEWGRIDASCII

◼

PNG

◼

JPEG

◼

VMAPPER (for Vertical Mapper GRC or GRD file formats)

◼

RASTERTXT

Please read the application documentation to learn more about these file formats.
The data exported is the geographic coverage prediction of a study when using SHP, AGD, MIF, TAB, BMP,
ARCVIEWGRIDASCII, PNG, JP2, or TIF formats. However, if you specify TXT format, this method will export the study
report in tabulated ASCII text format. This prediction study report is the same as the one available by right-clicking
the study in the application and selecting Generate Report.
Available properties are:
Property Name
Resolution

Value
integer

Description
This is the export resolution, expressed in meter.

Version
≥ 2.8.1

If not specified, the resolution used to perform the export is the
study resolution.
It is only relevant when the export format is a vector format, as
opposed to a raster format.
AreaType

0|1|2

Used to specify the zone to export. Available values are:

≥ 2.8.1

◼ 0: The Entire Covered Area
◼ 1: The Computation Zone
◼ 2: The Geographic Export Zone

If not specified, the entire covered area is considered to perform
the export.
It is only relevant for raster formats, as opposed to vector formats.
FilteringPercentage

integer, between 0 This is the filtering percentage value.
≥ 3.3.1
and 100
It is only relevant when the export format is a vector format, as
opposed to a raster format.

SmoothingPercentage

integer, between 0 This is the smoothing percentage value.
≥ 3.3.1
and 100
It is only relevant when the export format is a vector format, as
opposed to a raster format.

SmoothingMaximumNumberOfPoints

integer

This is the maximum number of points for exported vector
≥ 3.3.1
geometries. This option is mutually exclusive with the smoothing percentage option.
It is only relevant when the export format is a vector format, as
opposed to a raster format.

DataType

integer, 0 or 1

◼ 0: coverage thresholds are exported, this is the defaut set- ≥ 3.3.1

ting if not specified.
◼ 1: numerical coverage results are exported.

This option is only relevant when BIL or GRD formats are specified.
OneLinePerServer

integer

◼ 0: Results are published on multiple lines.

≥ 3.4.1

◼ !=0: Results are exported with one line per server.

Only available for RASTERTXT export format
Precision

integer

Specifies the number of decimals for precision.

≥ 3.4.1

Only available for RASTERTXT export format
Separator

string

◼ "space": Text results are separated by a space character.

≥ 3.4.1

◼ "tab": Text results are separated by a tab character.

Only available for RASTERTXT export format

© 2022 Forsk. All Rights Reserved.

107

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

Return value
S_OK: Export has completed successfully.
S_FALSE: Export couldn’t be performed because of one of the following reasons:
◼

The folder specified in bstrFileName does not exist.

◼

The study visibility check box is cleared.

◼

The study has no coverage.

When S_FALSE is returned, no output file is created.
Example
Const SID_PREDICTIONS = "{DA676EF0-E300-4AFF-BBFA-EC55D3798E4F}"
Public Sub ExportStudy
Dim oStudy
Dim oCS
Set oCS = ActiveDocument.CoordSystemDisplay
For Each oStudy In ActiveDocument.GetRootFolder(0).Item(SID_PREDICTIONS)
oStudy.Export "c:\export.asc", oCS, "ARCVIEWGRIDASCII"
oStudy.Export "c:\export.txt", oCS, "TXT"
oStudy.Export "c:\export.bmp", oCS, "BMP"
Next
End Sub

9.14 CentreOnMap
Centres the Atoll Map View window around the ChildFolder object.
HRESULT CentreOnMap();
Remarks
CentreOnMap only makes sense for ChildFolder objects that may appear on Atoll Map View windows. CentreOnMap
calls will be ignored for objects that don’t support it. No error will be returned.

9.15 Redraw
Redraws the ChildFolder object.
HRESULT Redraw();
Remarks
Redraw only makes sense for ChildFolder objects that may appear on Atoll Map View windows. Redraw calls will be
ignored for objects that don’t support it. No error will be returned.

108

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

9.16 AddChild
Adds a new child to the current Atoll child folder object.
HRESULT AddChild(const VARIANT spec, long position, IChildFolder2** pVal)
Parameters
[in] spec: VARIANT used to define the child item to add.
[in] position: The position used to define where to add the new child.
[out] pVal: Address of a IChildFolder2 interface pointer used to return the new Atoll child folder object just added.
Remark
The type of the child added depends on the type of the spec input parameter.
When spec if of type VT_UNKNOWN or VT_DISPATCH, and when it is an Atoll ChildFolder object, spec is interpreted
as a source ChildFolder object. AddChild will add a link to the source ChildFolder object. The source Atoll
ChildFolder cannot be a link itself. Links can only be created at the root level of the Atoll Explorer geo or data tabs.
Links always are created at position 0. The source ChildFolder object and the current ChildFolder object must belong
to different Atoll documents.
When spec if of type VT_UNKNOWN or VT_DISPATCH, and when it is an Atoll PropertyContainer object, then a new
ChildFolder is added with the content of the Atoll PropertyContainer object. The properties needed to actually be
able to add a new ChildFolder object depend on the current ChildFolder object type, as returned by ObjectKind.

9.17 Remove
Removes the ChildFolder object from its parent ChildFolder object.
HRESULT Remove();
Remarks
A ChildFolder object cannot be used anymore after it is removed. ChildFolder objects may be removed by Atoll, for
instance when F5 is used interactively to refresh the screen.
Once this method has returned the ChildFolder object has been destroyed and invoking any method on it will result
in undefined behaviour.
Atoll version >= 2.8.2:
This method is deprecated. Please use RemoveItem instead.

9.18 position
Returns the ChildFolder object position relative to its parent ChildFolder object.
HRESULT get_position(long *pPos);
Parameters
[out] pPos: Address of the long integer used to return the ChildFolder object position. ChildFolder objects are
ordered from position 0 (top) to to Count() - 1 (bottom).

© 2022 Forsk. All Rights Reserved.

109

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

9.19 position
Sets the ChildFolder object position relative to its parent ChildFolder object.
HRESULT put_position(long lPos);
Parameters
[in] lPos: A long integer used to specify the ChildFolder object position.
◼

If lPos ≤ 0, the ChildFolder object is moved to the top.

◼

If lPos ≥ Count() - 1, the ChildFolder object is moved to the bottom.

9.20 Object
Access to some specific features on the ChildFolder object.
HRESULT get_Object(IUnknown **ppObject);
Parameters
[out] ppObject: Address of the IUnknown interface pointer used to access some specific features.
Remarks
Due to the nature of the interface returned, Object cannot be used by macros and scripts. Macros or scripts must
use dispatch instead.

9.21 dispatch
Access to some specific features on the ChildFolder object.
HRESULT get_dispatch(IDispatch **ppDispatch);
Parameter
[out] ppDispatch: Address of the IDispatch interface pointer used to access some specific features.

9.22 ObjectKind
Returns a type identifier of the ChildFolder object.
HRESULT get_ObjectKind(BSTR *pRetVal);
Parameters
[out] pRetVal: Address of the BSTR used to return the type identifier.

110

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

Remarks
To be able to identify the ChildFolder object type, and therefore to safely access specific features of the ChildFolder
object, here is the list of the available type identifiers:

Version

SID

String Value

Specific Features

≥ 2.4.0

SID_CLUTTER

{7CB51DE8-A961-11D2-8688-0060086457D1}

Tabular data clutter properties.

≥ 2.4.0

SID_SIMULATIONS

{CDDF1E1D-1963-4D80-A057-D23A19570984}

Simulations folder.

≥ 2.4.0

SID_SIMULATIONSGROUP

{AF5E2B98-1D54-48FA-89C5-8BFA2936ABF2}

"Groups of simulations" folder.

≥ 2.4.0

SID_SIMULATION

{095C5D90-96F1-4BA8-85BB-B2F990AC2DD9}

"Simulation" items.

≥ 2.5.1

SID_SITES

{90443F68-5B3B-4AFD-B7BB-B057095EBAAD}

Sites folder.

≥ 2.5.1

SID_ANTENNAS

{5FBEB2AE-3BBB-4FBA-94D8-5D8EA5A32069}

Antennas folder.

≥ 2.5.1

SID_TRANSMITTERS

{F7E891E8-F7F5-4870-BF63-AF559AD50FD3}

Transmitters folder, in a singleRAT document.

≥ 2.5.1

SID_PREDICTIONS

{DA676EF0-E300-4AFF-BBFA-EC55D3798E4F}

Predictions folder.

≥ 2.5.1

SID_UMTS_PARAMETERS

{D4F57EE3-7785-4348-9BA6-28998AA6BD80}

UMTS Parameters folder.

≥ 2.5.1

SID_CW_MEASUREMENTS

{41413C4A-C9DE-43DD-A917-612A0AF198FC}

CW Measurements folder.

≥ 2.5.1

SID_MEASURE_TX

{2C102EE5-BFF4-4A5A-8130-02BD0E2F70D7}

CW Measurements transmitter.

≥ 2.5.1

SID_MEASURE_ITEM

{36858A48-7A85-482E-9DA0-B9E935ADE84C}

CW Measurements.

≥ 2.5.1

SID_TESTMOBILEDATA

{21C11380-D8CF-4902-B622-763522AD9FC4}

Drive Test Data folder.

≥ 2.5.1

SID_NUM_MEASURE_ITEM

{916801F9-0539-448C-8C0C-491FAC6399ED}

Drive Test Data items.

≥ 2.5.1

SID_PARAMETERS_FOLDER

{43B8845-5226-454F-908F-59A500DB4FD1}

Parameters folder.

≥ 2.5.1

SID_HEXAGON_SCHEMA

{B167D45E-A0BC-4DC6-B9D7-6F7B131CADF1}

Hexagonal Design folder.

≥ 2.6.0

SID_TRAFFICFOLDER

{B3B25A07-A994-4e8d-BBD1-51556D6C4245}

Traffic folder.

≥ 2.7.0

SID_PROPAGATIONMODELS

{4A2D160B-7D11-4D07-92DF-A3CF6B68D402}

Propagation models folder.

≥ 2.8.2

{16A53FB3-A961-4EEA-8C30-2387DBF1CC24}

Master link ChildFolder object.

≥ 2.8.2

{232BDB73-A68F-41A6-A954-75112D907BBF}

Link ChildFolder object.

≥ 3.1.0

{CC637062-7AFF-4516-BEFB-BCC954E905B1}

GSM Transmitters folder, in a
multi-RAT document.

≥ 3.1.0

{FD147AA0-B9A2-47AC-8CD5-51C77A708AF8}

LTE Transmitters folder, in a
multi-RAT document.

≥ 3.1.0

{090A23A1-EE08-420D-9739-651D1045EF16}

UMTS Transmitters folder, in a
multi-RAT document.

≥ 3.2.0

{65FF5F7D-DBF0-4B52-ABB8-66F3414FD4C3}

CDMA2000 Transmitters
folder, in a multi-RAT document.

© 2022 Forsk. All Rights Reserved.

111

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

≥ 3.2.1

StudyFolder

A sub-folder of the predictions
folder.

≥ 3.4.1

{A61EA433-019A-4BD0-8000-66884460B890}

4G/5G Transmitters folder, in a
5G multi-RAT document

≥ 3.4.1

{80B0D7F4-6661-45BB-B0FB-53F51AF5AD2B}

Links folder

≥ 3.4.1

{153AA7F2-253B-489C-9623-C77ADB900153}

Analysis of Microwave LinksFolder

≥ 3.4.1

{953EAC1B-9DFB-46AF-9AD6-4DFC394A6F3F}

Microwave Links

≥ 3.4.1

{7BBD7B12-F29D-43E8-AB45-29A50D0C2E7D}

Microwave repeaters

≥ 3.4.1

{E9E0FF8B-2C50-4FAE-BB17-E74A5DC3E8EB}

Other Transmission Links

≥ 3.4.1

{703E0EB1-33FA-4EEF-98C1-3A5286DA8373}

Multi-Hops

≥ 3.4.1

{33CD74BE-302A-4523-9BA3-493C15FC9697}

Point to MultiPoint

≥ 3.4.1

{1D0F4D63-6277-470C-9F60-E958F52C2DE9}

Buildings Layouts Folder

9.23 GetProperty
Returns a ChildFolder object property.
HRESULT GetProperty(const BSTR bstrName, VARIANT *pValue);
Parameters
[in] bstrName: A property name.
[out] pValue: Address of the VARIANT used to return the property.
Remarks
The type of the returned VARIANT can be any of the following:
C++

VBScript

VT_BOOL

Boolean

VT_I4

Integer

VT_R4

Single

VT_R8

Double

VT_UNKNOWN

Object

VT_DISPATCH

Object, TabularData object, ChildFolder object, PropertyContainer
object

VT_BSTR

String

VT_ARRAY | (any of the previous types)

Array, with array items of the previous types

The error E_INVALIDARG is returned when there is no property named bstrName for the ChildFolder object. The
properties available for the ChildFolder object depend on the type of the ChildFolder object, as returned by
ObjectKind.

112

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

9.24 SetProperty
Sets a ChildFolder object property.
HRESULT SetProperty(const BSTR bstrName, const VARIANT varValue);
Parameters
[in] bstrName: A property name.
[in] varValue: The VARIANT used to specify the property value.
Remarks
The error E_INVALIDARG is returned when there is no property named bstrName for the ChildFolder object. The
properties available for the ChildFolder object depend on the type of the ChildFolder object, as returned by
ObjectKind.

9.25 GetPropertiesInfo
Returns names and types for all properties available on the ChildFolder object.
HRESULT GetPropertiesInfo(VARIANT *pValue);
Parameters
[out] pValue : Address of the VARIANT used to return the names and types for all properties in the property
container.

9.26 PropertyIsPropertyContainer
Returns true when a ChildFolder object property is a PropertyContainer object.
HRESULT
PropertyIsPropertyContainer(const BSTR bstrName, VARIANT_BOOL *pValue);
Parameters
[in] bstrName : The property name.
[out] pValue: Address of the VARIANT_BOOL used to return whether the property is a PropertyContainer object or
not.

9.27 PropertyIsTabularData
Returns true when a ChildFolder object property is a TabularData object.
HRESULT PropertyIsTabularData(const BSTR bstrName, VARIANT_BOOL *pValue);
Parameters
[in] bstrName : The property name.

© 2022 Forsk. All Rights Reserved.

113

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

[out] pValue: Address of the VARIANT_BOOL used to return whether the ChildFolder property type is TabularData
object.

9.28 LoadProperties
Sets properties from a property container to the ChildFolder object.
HRESULT LoadProperties(const VARIANT varSource);
Parameters
[in] varSource : VARIANT of type VT_DISPATCH, used to specify a property container for the properties to set.

9.29 SaveProperties
Saves all the ChildFolder object properties to another property container.
HRESULT SaveProperties( const VARIANT varDestination) ;
Parameters
[in] varDestination : VARIANT of type VT_DISPATCH, used to specify a property container where all properties will
be set.

9.30 RemoveItem
Removes one of the children of the ChildFolder object.
HRESULT RemoveItem( const VARIANT idx) ;
Parameters
[in] idx : A VARIANT of type VT_I4 or VT_BSTR used to specify one of the children to remove.
If the type of the variant is VT_I4, it is interpreted as a zero-based index in the list of children.
If the type of the variant is VT_BSTR, it is first interpreted as the display name of the child to remove, and if the
display name is not found, it is then interpreted as a ChildFolder object kind, as returned by ObjectKind.
Remarks
A ChildFolder object cannot be used anymore after it is removed. ChildFolder objects may be removed by the
application, for instance when F5 is used interactively to refresh the screen.
This method fails for ChildFolder objects that cannot be removed interactively, and an error is returned in that case.

114

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

AT350_TAG_E3

9.31 SetCustomIcon
Sets the path of an icon to use for a custom child folder.
HRESULT SetCustomIcon(const BSTR bstrPath);
Parameters
[in] bstrPath : The full path to the icon file (*.ico) to load.

9.32 OpenPropertySheet
Displays the child folder property sheet dialogue.
HRESULT OpenPropertySheet();

9.33 IChildFolder9::get_UniqueID
Returns a unique identifier for the ChildFolder item.
HRESULT UniqueID ([out, retval] BSTR *pVal)
Parameters
pVal: Address of the BSTR used to return the identifier

© 2022 Forsk. All Rights Reserved.

115

Atoll 3.5.0 Task Automation Guide
Chapter 9: ChildFolder Object

116

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 10: PropertyContainer Object

AT350_TAG_E3

10 PropertyContainer Object
The PropertyContainer object is a generic container containing a set of named properties of arbitrary types.
The PropertyContainer object provides the following properties and methods:
Name

Description

Attributes

Get

Returns a named property.

Set

Sets a named property.

GetInfo

Returns names and types for all properties set to the property container.

IsPropertyContainer

Returns true when a named property is of a PropertyContainer
object.

IsTabularData

Type: Boolean
Access: Read

Returns true when a named property is of a TabularData object. Type: Boolean
Access: Read

Load

Adds properties from another property container to the property
container.

Save

Saves all the properties to another property container.

RemoveAll

Removes all properties from the property container.

Remove

Removes a named property from the property container.

10.1 Get
Returns a named property.
HRESULT Get(const BSTR bstrName, VARIANT *pValue);
Parameters
[in] bstrName: A property name.
[out] pValue: Address of the VARIANT used to return the property.
Remarks
The type of the returned VARIANT can be any of the following:
C++

VBScript

VT_BOOL

Boolean

VT_I4

Integer

VT_R4

Single

VT_R8

Double

VT_UNKNOWN

Object

VT_DISPATCH

Object, TabularData Object, ChildFolder Object, PropertyContainer
Object

VT_BSTR

String

VT_ARRAY | (any of the previous types)

Array, with array items of the previous types

© 2022 Forsk. All Rights Reserved.

117

Atoll 3.5.0 Task Automation Guide
Chapter 10: PropertyContainer Object

The error E_INVALIDARG is returned when the property named bstrName has not been previously set to the property
container.

10.2 Set
Sets a named property.
HRESULT Set(const BSTR bstrName, const VARIANT varValue);
Parameters
[in] bstrName: A property name.
[in] varValue: The VARIANT used to specify the property value.
Remarks
If the property named bstrName has been previously set, its content is replaced by varValue, otherwise a new
property named bstrName is added to the property container.

10.3 GetInfo
Returns names and types for all properties set to the property container.
HRESULT GetInfo(VARIANT *pValue);
Parameters
[out] pValue : Address of the VARIANT used to return the names and types for all properties in the property
container.

10.4 IsPropertyContainer
Returns true when a named property is a PropertyContainer object.
HRESULT IsPropertyContainer(const BSTR bstrName, VARIANT_BOOL *pValue);
Parameters
[in] bstrName : The property name.
[out] pValue: Address of the VARIANT_BOOL used to return whether the property is a PropertyContainer Object.

10.5 IsTabularData
Returns true when a named property is a TabularData object.
HRESULT IsTabularData(const BSTR bstrName, VARIANT_BOOL *pValue);

118

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 10: PropertyContainer Object

AT350_TAG_E3

Parameters
[in] bstrName : The property name.
[out] pValue: Address of the VARIANT_BOOL used to return whether the property is a Tabular Data Object.

10.6 Load
Adds properties from another property container to the property container.
HRESULT Load(const VARIANT varSource);
Parameters
[in] varSource : VARIANT of type VT_DISPATCH, used to specify a property container for the properties to add.

10.7 Save
Saves all the properties to another property container.
HRESULT Save(const VARIANT varDestination);
Parameters
[in] varDestination : VARIANT of type VT_DISPATCH, used to specify a property container where all properties will
be set.

10.8 RemoveAll
Removes all properties from the property container.
HRESULT RemoveAll();

10.9 Remove
Removes a named property from the property container.
HRESULT Remove(const BSTR bstrName, VARIANT *pValue);
Parameters
[in] bstrName : The property name.
[out] pValue: Address of the VARIANT used to return the original property value, before it is removed.

© 2022 Forsk. All Rights Reserved.

119

Atoll 3.5.0 Task Automation Guide
Chapter 10: PropertyContainer Object

120

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

11 ChildFolder Object Properties
ChildFolder object properties are named properties. The set of available properties for a given ChildFolder object
depends on the ChildFolder object type, returned by ObjectKind.
ChildFolder object property names usually resemble their GUI representations in the properties dialogues inside
Atoll.
ChildFolder object properties are divided into the following groups according to their use and application in Atoll:
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼
◼

"How to Access ChildFolder Object Properties" on page 121
"Common ChildFolder Object Properties" on page 122
"Predictions Folder Properties" on page 123
"Coverage Prediction Properties" on page 123
"GSM Simulation Group Properties" on page 135
"UMTS Simulation Group Properties" on page 136
"WiMAX and LTE Simulation Group Properties" on page 137
"Multi-RAT Simulation Group Properties" on page 138
"Standard Propagation Model Properties" on page 139
"CW Measurement Properties" on page 141
"Drive Test Data Properties" on page 142
"Custom ChildFolder Object Properties" on page 142
"Master Link Properties" on page 143
"Link Properties" on page 143
"Vector Layer Properties" on page 143
"Online Map Properties" on page 145
"Multi-point Analysis Properties" on page 146

11.1 How to Access ChildFolder Object Properties
The following sample codes show how to read and write ChildFolder Object properties.
Reading a ChildFolder Object Property
item: A ChildFolder object.
propertyname: The property name.
propertyvalue: The property value.
On Error Resume Next
’ If the property type is an Object (Atoll Tabular Data Object, Atoll Property
’ Container Object, ...), then replace the next line with
’ "Set propertyvalue = item.GetProperty(propertyname)"
propertyvalue = item.GetProperty(propertyname)
If Err Then
MsgBox item.Name & "." & propertyname & "does not exist."
Else
MsgBox item.Name & "." & propertyname & " = " & CStr(propertyvalue)

© 2022 Forsk. All Rights Reserved.

121

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

End If
Writing a ChildFolder Object Property
item: A ChildFolder object.
propertyname: The property name.
propertyvalue: The property value.
On Error Resume Next
item.SetProperty propertyname, propertyvalue
If Err Then
MsgBox Err.Description
End If

11.2 Common ChildFolder Object Properties
Some ChildFolder object properties are common to all kinds of ChildFolder objects. These properties include the
following.
Name
NAME

Description
ChildFolder object name as it appears in the Explorer window.

Attributes
Version ≥ 2.6.1
Type: String
Access: Read/Write

VISIBLE

ChildFolder visibility state. This property is only relevant for geographic ChildFolder objects.

Version ≥ 2.6.1
Type: Boolean
Access: Read/Write

SELECTED

ChildFolder selected state, either selected or not selected.

Version ≥ 2.6.1
Type: Boolean
Access: Read/Write

POSITION

ChildFolder position, relative to the parent ChildFolder object.

Version ≥ 2.6.1
Type: Integer
Access: Read/Write

OBJECTKIND

ChildFolder type identifier. This is the same as the value returned by Version ≥ 2.7.0
ObjectKind.
Type: String
Access: Read

ISGEOGRAPHIC

Returns true if the ChildFolder object can be visible in the Map window, Version ≥ 2.7.0
false otherwise.
Type: Boolean
When this property is false, the properties and methods specific to the Access: Read
Map view are neither relevant nor applicable.

VISIBILITYSCALEMIN

ChildFolder minimum visibility scale display property. This property Version ≥ 2.7.0
is only relevant for geographic ChildFolder objects.
Type: Integer
Access: Read/Write

VISIBILITYSCALEMAX

ChildFolder maximum visibility scale display property. This property Version ≥ 2.7.0
is only relevant for geographic ChildFolder objects.
Type: Integer
Access: Read/Write

ADDTOLEGEND

ChildFolder add to legend display property. This property is only rel- Version ≥ 2.7.0
evant for geographic ChildFolder objects.
Type: Boolean
Access: Read/Write

DOCUMENT

A Document object.

Version ≥ 2.8.2

The ChildFolder object is part of the Document object.

Type: Object
Access: Read

122

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Name

Description

LEGEND

Attributes

ChildFolder object name as it appears in the Legend window. This
property is only relevant for geographic ChildFolder objects.

Version ≥ 3.2.0
Type: String
Access: Read/Write

UNIQUEID

Returns the unique identifier of the Document object.

Version ≥ 3.4.1
Type: String
Access: Read

11.2.1

Group, Filter, and Sort Properties
These properties are called RECORDSETCONDITIONS, which are available for all kinds of coverage predictions.
Name
RECORDSETCONDITIONS

Attributes
Version ≥ 2.7.0
PropertyContainer object

The following RECORDSETCONDITIONS are available:
Name
GROUPBY

Description

Attributes

"Group By" part of the recordset conditions, applied to the Trans- Version ≥ 2.7.0
mitters table.
Type: String
Access: Read/Write

FILTER

"Filter" part of the recordset conditions, applied to the Transmit- Version ≥ 2.7.0
ters table.
Type: String
Filter strings are what can be seen in the Atoll "Table" tab prop- Access: Read/Write
erties for record folders, when using advanced filtering.

SORT

"Sort" part of the recordset conditions, applied to the Transmit- Version ≥ 2.7.0
ters table.
Type: String
Access: Read/Write

11.3 Predictions Folder Properties
Type returned by get_ObjectKind: {DA676EF0-E300-4AFF-BBFA-EC55D3798E4F}
The following properties are accessible through the Predictions folder.
Name
PRIVATESTORAGE

Description

Attributes

Path to the path loss matrices private storage folder, as it appears in Version ≥ 2.6.1
the Predictions folder properties.
Type: String
Access: Read/Write

STOREPREDICTIONNUMERICALRESULTES

Defines whether prediction numerical results are stored locally.

Version ≥ 3.4.0
Type: Boolean
Access: Read/Write

11.4 Coverage Prediction Properties
The coverage prediction types returned by get_ObjectKind for the various coverage predictions are listed below:

© 2022 Forsk. All Rights Reserved.

123

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

◼

"GSM GPRS EDGE Coverage Predictions" on page 124,

◼

"UMTS HSPA Coverage Predictions" on page 124,

◼

"WiMAX Coverage Predictions" on page 125,

◼

"LTE Coverage Predictions" on page 125.

Coverage prediction properties are of the following types:
◼

"General Properties" on page 128,

◼

"Group, Filter, and Sort Properties" on page 123,

◼

"Non-Simulation-based Coverage Conditions" on page 128: Coverage conditions for predictions that cannot
be based on simulations,

◼

"Simulation-based Coverage Conditions" on page 130: Coverage conditions for predictions that can be based
on simulations,

◼

"Shadowing and Indoor Coverage Conditions" on page 132,

◼

"KPI Properties" on page 133

◼

"Display Properties" on page 133.

GSM GPRS EDGE Coverage Predictions
Name

Type

Attributes

Coverage by Transmitter (DL)

{9E42C87F-56D0-43CA-A313-78A7CA9A811B}

Coverage by Signal Level (DL)

{1FF20277-9A4C-486A-B0A4-90E7E8EC72E4}

Overlapping Zones (DL)

{1F0C294B-11A0-45C9-9B32-640FED79BCA6}

Coverage by C/I Level (DL)

{8A94CAE7-B4FF-4DC6-854A-BC90FE8F0073}

Interfered Zones (DL)

{EB45E33D-FB33-44F1-A63B-B4661ACE78B2}

Coverage by GPRS/EDGE Coding
Scheme (DL)

{6B062215-EEC1-40E9-9A02-F909AFF6B5DB}

Coverage by Signal Level (UL)

{CB8A7A12-089B-4681-956A-17119E17F02C}

Service Area Analysis (DL)

{28149E1A-72E0-4C4A-8E6D-69A7A96C7257}

Service Area Analysis (UL)

{C71C77D1-0FA5-4FE4-9D96-E567620373DC}

Effective Service Area Analysis
(DL+UL)

{D57D42F7-3939-422A-8600-39BF8BBB4D1D}

Packet Quality and Throughput Analysis (DL)

{02BE397A-1F4B-423E-AEC4-B8138974ADD8}

Coverage by C/I Level (UL)

{549A79FF-D191-4486-B6D8-A1544633BC26}

Coverage by Aerial (DL)

{A06B88E7-AF24-4CA8-9258-9E65292E8FCF}

Circuit Quality Indicator Analysis (DL)

{67EC97E9-9F06-4B0F-90C0-E42A67FE560C}

Exposure Analysis (DL)

{DBF70F5B-BFFE-4061-A276-2B76FE0FCE86}

Version ≥ 3.4.0

KPI Quality Zones

{29EFAABC-A58A-4365-ABD9-00D9FA4CDEB5}

Version ≥ 3.4.1

UMTS HSPA Coverage Predictions
Name

Type

Coverage by Transmitter (DL)

{A6FB7132-FB5E-42CC-A1C1-0BEA4AF09921}

Coverage by Signal Level (DL)

{E82C3B13-240E-4DD3-A553-583ADDF57713}

Overlapping Zones (DL)

{53B30925-B781-499D-90E4-3F9B8570871B}

Coverage by Total Noise Level (DL)

{1C9384EB-57CA-433F-BDB3-07E1BE317890}

Pilot Quality Analysis (Ec/Io)

{66287FC5-81FA-40B6-84E3-2C2C4E13D121}

Service Area Analysis (Eb/Nt) (DL)

{5C6427F7-D63A-4046-B8BD-1A5E9D165890}

Service Area Analysis (Eb/Nt) (UL)

{D75ADE37-FB8A-4693-A788-47109A913C29}

Attributes

Effective Service Area Analysis (Eb/Nt) {5F74AEFA-2958-42CC-8244-C12DC19B26C3}
(DL+UL)

124

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Name

Type

Handoff Zones

{39A63BBA-02EC-43E7-8523-07E29B519181}

Pilot Pollution Analysis

{2199E577-F3F5-4FFD-BCAB-0D748CA7CCD3}

Attributes

HSDPA Quality and Throughput Analy- {BFDDFC83-D8EE-4225-840F-EF842DE19B74}
sis
HSUPA Quality and Throughput Analy- {E9ED15F1-EC14-4451-ADFA-1953A6FB2526}
sis
Scrambling Code Collision Zones

{AC612067-A173-439E-BF7A-76B17933A30E}

Coverage by Aerial (DL)

{B550F943-733A-4ECB-9E8A-EABB79FE5CD2}

Total Noise Level Analysis (DL)

{1C9384EB-57CA-433F-BDB3-07E1BE317890}

Inter-technology Interference Level
Analysis (DL)

{CE1C2AE8-0F0A-4E54-A69E-F4569A73A1DF}

Exposure Analysis (DL)

{65FB0E62-D54F-41C1-960F-E850A14403AC}

Version ≥ 3.4.0

KPI Quality Zones

{183F44EA-D30D-45C7-ABF4-31660F6BAEDD}

Version ≥ 3.4.1

WiMAX Coverage Predictions
Name

Type

Attributes

Coverage by Transmitter (DL)

{BE607087-CB08-453C-B2A0-B356CD38C3F5}

Version ≥ 2.7.1

Coverage by Signal Level (DL)

{9C602E1C-E5E7-44CA-8E5B-878D74D07885}

Version ≥ 2.7.1

Overlapping Zones (DL)

{86560A81-DE60-41CC-9B9E-83BF33CEF491}

Version ≥ 2.7.1

Effective Signal Analysis (DL)

{6A657977-CF0E-415C-8486-C41664F7035E}

Version ≥ 2.7.1

Effective Signal Analysis (UL)

{3F803866-1041-4267-8D28-FCA43445A642}

Version ≥ 2.7.1

Coverage by C/(I+N) Level (DL)

{DCB4B756-4D02-42DB-B838-14A62F603922}

Version ≥ 2.7.1

Coverage by C/(I+N) Level (UL)

{4163305D-E203-4A78-99F6-E59EA537AB7E}

Version ≥ 2.7.1

Coverage by Throughput (DL)

{645C7166-CE00-4EFB-B9AF-A7F25A3BBBA6}

Version ≥ 2.7.1

Coverage by Throughput (UL)

{1A8B4ACB-8D51-49AA-AA67-3ADAB48F09B6}

Version ≥ 2.7.1

Coverage by Aerial (DL)

{4A9ED8C5-F2DE-432B-8507-C65A3DFE47E3}

Version ≥ 3.2.0

Service Area Analysis (DL)

{C5A270AA-15A1-443D-BBCB-77B1B99D447F}

Service Area Analysis (UL)

{A07FB550-64C7-4D2A-B634-79FC6A981828}

Effective Service Area Analysis
(DL+UL)

{9C91F601-0B1D-4F60-A983-160A93349377}

Coverage by Quality Indicator (DL)

{B682A005-CCC2-4C7C-A9FA-D2FEBA633E15}

Coverage by Quality Indicator (UL)

{E648833C-48E1-49C0-A56F-6B94DBA9C358}

Cell Identifier Collision Zones (DL)

{408A1234-37D0-42A7-8CF1-6E3E5239D6AC}

Exposure Analysis (DL)

{AA1E6C81-E8D8-4BD1-93A2-2E01E2E7B7CD}

Version ≥ 3.4.0

LTE Coverage Predictions
Name

Type

Attributes

Coverage by (N)RSRP Level (DL)

{9F1B8CCC-4D09-4E9D-857F-986D439108B2}

Version ≥ 3.4.0

Coverage by Transmitter (DL)

{BE607087-CB08-453C-B2A0-B356CD38C3F5}

Version ≥ 2.8.0

Coverage by Signal Level (DL)

{9C602E1C-E5E7-44CA-8E5B-878D74D07885}

Version ≥ 2.8.0

Overlapping Zones (DL)

{86560A81-DE60-41CC-9B9E-83BF33CEF491}

Version ≥ 2.8.0

Effective Signal Analysis (DL)

{6A657977-CF0E-415C-8486-C41664F7035E}

Version ≥ 2.8.0

Effective Signal Analysis (UL)

{3F803866-1041-4267-8D28-FCA43445A642}

Version ≥ 2.8.0

Coverage by C/(I+N) Level (DL)

{DCB4B756-4D02-42DB-B838-14A62F603922}

Version ≥ 2.8.0

Coverage by C/(I+N) Level (UL)

{4163305D-E203-4A78-99F6-E59EA537AB7E}

Version ≥ 2.8.0

Coverage by Throughput (DL)

{645C7166-CE00-4EFB-B9AF-A7F25A3BBBA6}

Version ≥ 2.8.0

© 2022 Forsk. All Rights Reserved.

125

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name

Type

Attributes

Coverage by Throughput (UL)

{1A8B4ACB-8D51-49AA-AA67-3ADAB48F09B6}

Version ≥ 2.8.0

Coverage by Quality Indicator (DL)

{B682A005-CCC2-4C7C-A9FA-D2FEBA633E15}

Version ≥ 2.8.0

Coverage by Quality Indicator (UL)

{E648833C-48E1-49C0-A56F-6B94DBA9C358}

Version ≥ 2.8.0

Cell Identifier Collision Zones (DL)

{408A1234-37D0-42A7-8CF1-6E3E5239D6AC}

Effective Service Area Analysis
(DL+UL)

{9C91F601-0B1D-4F60-A983-160A93349377}

Service Area Analysis (UL)

{A07FB550-64C7-4D2A-B634-79FC6A981828}

Service Area Analysis (DL)

{C5A270AA-15A1-443D-BBCB-77B1B99D447F}

Coverage by Aerial (DL)

{4A9ED8C5-F2DE-432B-8507-C65A3DFE47E3}

Exposure Analysis (DL)

{AA1E6C81-E8D8-4BD1-93A2-2E01E2E7B7CD}

Version ≥ 3.4.0

KPI Quality Zones

{211F2341-8490-4A35-A97C-11ED03DC8BA6}

Version ≥ 3.4.1

Multi-RAT (3GPP, 3GPP2, and 5G Multi-RAT) Predictions
Name

Type

Coverage by Throughput (DL)

{1263E484-49FF-46AB-BEEF-A3D38381C1CF}

Effective Service Area Analysis
(DL+UL)

{7BF0DC41-ADE4-4ECC-9176-D4FBFB24BABD}

Exposure Analysis (DL)

{08E64977-FCAE-457A-87F5-0B829F3C5EF2}

Attributes

Version ≥ 3.4.0

CDMA Predictions
Name

Type

Coverage by Transmitter (DL)

{A6FB7132-FB5E-42CC-A1C1-0BEA4AF09921}

Coverage by Aerial (DL)

{B550F943-733A-4ECB-9E8A-EABB79FE5CD2}

Coverage by Signal Level (DL)

{A6FB7132-FB5E-42CC-A1C1-0BEA4AF09921}

Overlapping Zones (DL)

{A6FB7132-FB5E-42CC-A1C1-0BEA4AF09921}

Total Noise Level Analysis (DL)

{1C9384EB-57CA-433f-BDB3-07E1BE317890}

Inter-technology Interference Level
Analysis (DL)

{CE1C2AE8-0F0A-4e54-A69E-F4569A73A1DF}

Pilot Quality Analysis (DL)

{66287FC5-81FA-40B6-84E3-2C2C4E13D121}

Service Area Analysis (Eb/Nt) (DL)

{5C6427F7-D63A-4046-B8BD-1A5E9D165890}

Service Area Analysis (Eb/Nt) (UL)

{D75ADE37-FB8A-4693-A788-47109A913C29}

Effective Service Area Analysis

{5F74AEFA-2958-42CC-8244-C12DC19B26C3}

Attributes

(Eb/Nt) (DL+UL)
Handoff Zones (DL)

{39A63BBA-02EC-43E7-8523-07E29B519181}

Pilot Pollution Analysis (DL)

{2199E577-F3F5-4FFD-BCAB-0D748CA7CCD3}

PN Offset Collision Zones (DL)

{AC612067-A173-439e-BF7A-76B17933A30E}

Exposure Analysis (DL)

{65FB0E62-D54F-41C1-960F-E850A14403AC}

Version ≥ 3.4.0

Wi-Fi Predictions
Name

126

Type

Coverage by Transmitter (DL)

{BE607087-CB08-453C-B2A0-B356CD38C3F5}

Coverage by Signal Level (DL)

{9C602E1C-E5E7-44CA-8E5B-878D74D07885}

Overlapping Zones (DL)

{86560A81-DE60-41CC-9B9E-83BF33CEF491}

Effective Signal Analysis (DL)

{6A657977-CF0E-415C-8486-C41664F7035E}

Effective Signal Analysis (UL)

{3F803866-1041-4267-8D28-FCA43445A642}

Coverage by C/(I+N) Level (DL)

{DCB4B756-4D02-42DB-B838-14A62F603922}

Attributes

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Name

Type

Coverage by C/(I+N) Level (UL)

{4163305D-E203-4A78-99F6-E59EA537AB7E}

Service Area Analysis (DL)

{C5A270AA-15A1-443D-BBCB-77B1B99D447F}

Service Area Analysis (UL)

{A07FB550-64C7-4D2A-B634-79FC6A981828}

Effective Service Area Analysis
(DL+UL)

{9C91F601-0B1D-4F60-A983-160A93349377}

Coverage by Throughput (DL)

{645C7166-CE00-4EFB-B9AF-A7F25A3BBBA6}

Coverage by Throughput (UL)

{1A8B4ACB-8D51-49AA-AA67-3ADAB48F09B6}

Coverage by Quality Indicator (DL)

{B682A005-CCC2-4C7C-A9FA-D2FEBA633E15}

Coverage by Quality Indicator (UL)

{E648833C-48E1-49C0-A56F-6B94DBA9C358}

Attributes

5G NR Network Standard Single-RAT Predictions
Each prediction has the same ObjectKind value regardless of the technology they are based on. The following
additional parameters are required for 5G NR Network Standard Single-RAT Predictions:
◼

◼

◼

StudyRat (short integer):
◼

0: LTE

◼

1: NBIoT

◼

2: 5G NR

InterferenceFromRATs (short integer):
◼

1: LTE

◼

2: NB-IoT

◼

4: 5G NR

5GMode (short integer):
◼

0: Standalone mode

◼

1: Non-standalone mode
Name

Type

Attributes

Downlink Coverage

{81B0F9DB-298A-402C-B64A-407D5F4BF056}

Version ≥ 3.4.0

Downlink Quality

{852CA433-6CA0-4785-ABA1-CC5919F5904C}

Version ≥ 3.4.0

Downlink Service Areas

{93A02DA4-9BC6-4D94-92B6-A2F4A53618BA}

Version ≥ 3.4.0

Downlink Capacity

{F032C0ED-F6D0-4350-A3E7-C7BDCD304DAF}

Version ≥ 3.4.0

Uplink Coverage

{62FFBF1E-CE6A-4287-8059-921160CC7C08}

Version ≥ 3.4.0

Uplink Quality

{FA59D0B7-8536-49F3-A272-4D28E9601206}

Version ≥ 3.4.0

Uplink Service Areas

{C3C57201-9AFC-4F40-A992-AB9E0D880E26}

Version ≥ 3.4.0

Uplink Capacity

{3330E2A5-3827-4731-8420-5E1BBE5EC640}

Version ≥ 3.4.0

Effective Service Areas

{B6B5FD56-A7FC-4094-A02F-DC5956880D09}

Version ≥ 3.4.0

4G/5G Network Generic Predictions
Name

Type

Attributes

Downlink Capacity

{613AF5E9-31BA-462C-BFA0-2F38D429D4E1}

Version ≥ 3.4.0

Uplink Capacity

{09D0FE3A-F257-4A3D-BB83-5A92013AE332}

Version ≥ 3.4.0

Coverage by Transmitter (DL)

{BE607087-CB08-453C-B2A0-B356CD38C3F5}

Version ≥ 3.4.0

Coverage by Signal Level (DL)

{9C602E1C-E5E7-44CA-8E5B-878D74D07885}

Version ≥ 3.4.0

Coverage by Aerial

{4A9ED8C5-F2DE-432B-8507-C65A3DFE47E3}

Version ≥ 3.4.0

Overlapping Zones (DL)

{86560A81-DE60-41CC-9B9E-83BF33CEF491}

Version ≥ 3.4.0

Cell Identifier Collision Zones (DL)

{408A1234-37D0-42A7-8CF1-6E3E5239D6AC}

Version ≥ 3.4.0

Exposure Analysis (DL)

{6271DA3E-A9FB-4880-B940-D4C4D2D3BF51}

Version ≥ 3.4.0

© 2022 Forsk. All Rights Reserved.

127

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name

11.4.1

Type

Attributes

Downlink Coverage

{E6CDC133-3998-4E84-B31F-88551B826890}

Version ≥ 3.4.0

KPI Quality Zones

{211F2341-8490-4A35-A97C-11ED03DC8BA6}

Version ≥ 3.4.1

Downlink Quality

{1DD629E8-5102-4807-A10A-28C3F89913D3}

Version ≥ 3.4.1

General Properties
The following properties are available for 4G/5G Predictions:
◼

◼

StudyRat (short integer):
◼

0: LTE

◼

1: NBIoT

◼

2: 5G NR

InterferenceFromRATs (short integer):
◼

1: LTE

◼

2: NB-IoT

◼

4: 5G NR

These properties are available for all kinds of coverage predictions.
Name
DESCRIPTION

Description

Attributes

Comments

Version ≥ 2.7.0
Type: String
Access: Read/Write

RESOLUTION

Resolution of the prediction, in meters.

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

LOCKED

Returns true when the prediction is locked for calculations, false Version ≥ 2.7.0
otherwise.
Type: Boolean
Access: Read/Write

ISEMPTY

Returns true when the prediction coverage is empty, false oth- Version ≥ 2.7.0
erwise.
Type: Boolean
Access: Read

11.4.2

ISPERTRANSMITTER

Returns true when the prediction is per transmitter, false other- Version ≥ 2.7.0
wise. The return value depends on the display field of the pre- Type: Boolean
diction.
Access: Read

URL

An empty string when the coverage prediction does not have
external numerical results, otherwise the absolute path to the
disk folder containing numerical results.

Version ≥ 3.2.1
Type: String
Access: Read

Non-Simulation-based Coverage Conditions
These properties are called COVERAGECONDITIONS.
Name
COVERAGECONDITIONS

Attributes
Version ≥ 2.7.0
PropertyContainer object

These properties are available for the following coverage predictions:

128

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Radio Technology
GSM GPRS EDGE

Non-simulation-based Predictions
◼ Coverage by Transmitter (DL)
◼ Coverage by Signal Level (DL and UL)
◼ Overlapping Zones (DL)
◼ Coverage by C/I Level (DL and UL)
◼ Interfered Zones (DL)
◼ Coverage by GPRS/EDGE Coding Scheme (DL)
◼ Packet Quality and Throughput Analysis (DL)
◼ Circuit Quality Indicator Analysis (DL)
◼ Exposure Analysis (DL)
◼ KPI Quality Zones (DL)

UMTS HSPA and CDMA2000

◼ Coverage by Transmitter (DL)
◼ Coverage by Signal Level (DL)
◼ Overlapping Zones (DL)
◼ Exposure Analysis (DL)
◼ KPI Quality Zones (DL)

LTE NB-IoT

◼ Coverage by Transmitter (DL)
◼ Coverage by Signal Level (DL)
◼ Overlapping Zones (DL)
◼ Cell Identifier Collision Zones (DL)
◼ Exposure Analysis (DL)
◼ KPI Quality Zones (DL)

5G MultiRAT
(4G 5G)

◼ Coverage by Transmitter (DL)
◼ Coverage by Signal Level (DL)
◼ Overlapping Zones (DL)
◼ Cell Identifier Collision Zones (DL)
◼ Exposure Analysis (DL)
◼ KPI Quality Zones (DL)

WiMAX, WiFi and LPWA

◼ Coverage by Transmitter
◼ Coverage by Signal Level
◼ Overlapping Zones
◼ Cell Identifier Collision Zones (DL) (WiMAX only)

The following COVERAGECONDITIONS are available:
Name
FIELDTYPE

Description
The field type to base the prediction on. The values are:

Attributes
Version ≥ 2.7.0

◼ 1=Path Loss (dB)

Type: Integer

◼ 2=Total Losses (dB)

Access: Read/Write

◼ 3=Signal Level (dBm)
◼ 4=Signal Level (dBµV)
◼ 5=Signal Level (dBµV/m)

SERVERTYPE

The way to choose transmitters among available (active, not fil- Version ≥ 2.7.0
tered) ones for the current coverage prediction:
Type: Integer
◼ 0=All
Access: Read/Write
◼ 1=Best Signal Level
◼ 2=Second Best Signal Level

For GSM GPRS EDGE documents, the following values are also
available:
◼ 3=Best Signal Level per HCS Layer
◼ 4=Second Best Signal per HCS Layer
◼ 5=Best Signal Level of the Highest Priority HCS Layer
◼ 6=Best Idle Mode Reselection Criterion (C2)

SERVERMARGIN

The margin (in dB) from the best server signal level and signal Version ≥ 2.7.0
level from other servers taking part into the current coverage Type: Single
(available only if the best signal level or highest priority option
Access: Read/Write
is selected)
e.g.: If the two best server signal levels are within the margin,
these are both considered in the coverage area.

© 2022 Forsk. All Rights Reserved.

129

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name
TRXTYPE

Description

Attributes

GSM GPRS EDGE: The TRX type to take into account for the cur- Version ≥ 2.7.0
rent coverage prediction (BCCH, TCH, TCH_EGPRS, TCH_INType: PropertyConNER).
tainer object
UMTS HSPA: The carrier number to take into account for the cur- Access: Read/Write
rent coverage prediction:
◼ ALL=Best
◼ 0=Carrier number 0
◼ 1=Carrier number 1
◼ 2=Carrier number 2

USESUBCELLRECEPTIONTHRESHOLD Whether to use the lower reception threshold defined for the
Version ≥ 2.7.0
transmitter subcell or not. When set to True, the FIELDMINIMUM Type: Boolean
property is ignored.
Access: Read/Write
FIELDMINIMUM

The coverage prediction lower threshold associated with the Version ≥ 2.7.0
FIELDTYPE property. When set to -32768, no minimum value will Type: Single
be considered.
Access: Read/Write

FIELDMAXIMUM

The coverage prediction upper threshold associated with the Version ≥ 2.7.0
FIELDTYPE property. When set to 32767, no maximum value is Type: Single
considered.
Access: Read/Write

RADIOACCESSTECHNOLOGY

The radio technology used by the current coverage prediction: Version ≥ 3.4.1
◼ 1=LTE

Type: Single

◼ 2=NB-IoT

Access: Read/Write

◼ 4=5G NR
◼ 7=All

11.4.3

Simulation-based Coverage Conditions
These properties are called SIMULATIONCONDITIONS.
Name
SIMULATIONCONDITIONS

Attributes
Version ≥ 2.7.0
Type: PropertyContainer object

These properties are available for the following coverage predictions:
Radio Technology
GSM GPRS EDGE

Simulation-based Predictions
◼ Service Area Analysis (DL and UL)
◼ Effective Service Area Analysis (DL+UL)

UMTS HSPA and CDMA2000

◼ Total Noise Analysis (DL)
◼ Inter-technology Interference Analysis (DL)
◼ Pilot Quality Analysis (DL)
◼ Service Area Analysis (Eb/Nt) (DL)
◼ Service Area Analysis (Eb/Nt) (UL)
◼ Effective Service Area Analysis (Eb/Nt) (DL+UL)
◼ Handoff Zones (DL)
◼ Pilot Pollution Analysis
◼ HSDPA Quality and Throughput Analysis (DL) (UMTS HSPA only)
◼ HSUPA Quality and Throughput Analysis (UL) (UMTS HSPA only)
◼ Scrambling Code Collision Zones

130

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Radio Technology
LTE

Simulation-based Predictions
◼ Coverage by (N)RSRP Level (DL)
◼ Effective Signal Analysis (DL and UL)
◼ Coverage by C/(I+N) Level (DL and UL)
◼ Service Area Analysis (DL and UL)
◼ Effective Service Area Analysis (DL+UL)
◼ Coverage by Throughput (DL and UL)
◼ Coverage by Quality Indicator (DL and UL)

5G MultiRAT
(5G NR, LTE, and NB-IoT)

◼ Downlink Coverage
◼ Downlink Quality
◼ Downlink Service Areas
◼ Downlink Capacity
◼ Uplink Coverage
◼ Uplink Quality
◼ Uplink Service Areas
◼ Uplink Capacity

5G MultiRAT
(4G/5G)

◼ Downlink Coverage
◼ Downlink Capacity
◼ Uplink Capacity

WiMAX and WiFi:

◼ Effective Signal Analysis (UL and DL)
◼ Coverage by C/(I+N) Level (DL and UL)
◼ Service Area Analysis (DL and UL)
◼ Effective Service Area Analysis (DL+UL)
◼ Coverage by Throughput (DL and UL)
◼ Coverage by Quality Indicator (DL and UL)

The following SIMULATIONCONDITIONS are available:
Name
TERMINAL

Description
The name of the terminal type used for the prediction.

Attributes
Version ≥ 2.7.0
Type: String
Access: Read/Write

MOBILITY

The name of the mobility type used for the prediction.

Version ≥ 2.7.0
Type: String
Access: Read/Write

SERVICE

The name of the service used for the prediction.

Version ≥ 2.7.0
Type: String
Access: Read/Write

SIMULATION

The name of the simulation used for the prediction. When set to Version ≥ 2.7.0
an empty string, no simulation will be used to perform the pre- Type: String
diction.
Access: Read/Write

AVERAGESIMULATION

Whether the average simulation will be used to perform the pre- Version ≥ 2.7.0
diction. This property is not relevant when the SIMULATION
Type: Boolean
property is empty. This property is not available for WiMAX, LTE Access: Read/Write
and 5G predictions.

MINIMUMPROBABILITY

The minimum probability used to perform the prediction. This Version ≥ 2.7.0
property is only relevant when the SIMULATION property is not Type: Single
empty and when the AVERAGESIMULATION property is set to
Access: Read/Write
False. This property is not available for WiMAX, LTE and 5G predictions.

CARRIER

The carrier number used to perform the prediction. This property Version ≥ 2.7.0
is not available for WiMAX, LTE and 5G predictions.
Type: Integer
Access: Read/Write

DOWNGRADINGALLOWED

© 2022 Forsk. All Rights Reserved.

Whether downgrading will be considered to perform the predic- Version ≥ 2.7.0
tion, or not. This property is not available for WiMAX, LTE and 5G Type: Boolean
predictions.
Access: Read/Write

131

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name

Description

Attributes

BEARER

The bearer used to perform the prediction. This property is only Version ≥ 2.7.0
relevant for a HSDPA Prediction. This property is not available Type: Integer
for WiMAX, LTE and 5G predictions.
Access: Read/Write

CHANNELS

The network Channels that you want the calculations to take into Version ≥ 3.4.0
account "Channel1;Channel2". Leave empty if you want to cal- Type: String
culate for all channels. This property is only available for
Access: Read/Write
WiMAX/LTE/5G NR predictions.

LAYERS

The layers used to perform the prediction. This property is for
LTE, WiMAX and 4G/5G predictions.

Version ≥ 3.4.0
Type: String
Access: Read/Write

CELLTYPE

The cell type used to perform the prediction. This property is for Version ≥ 3.4.0
LTE and 4G/5G predictions.
Type: Integer
The Cell type for which you want to calculate the coverage pre- Access: Read/Write
diction. Possibles Values are:
◼ 0x1 for the primary cell
◼ 0x2 for the primary and the first secondary best server cell
◼ 0x4 for the primary and first and second secondary best

server cells
◼ And so on until the 15th

This property is only available for WiMAX and LTE predictions.
WITHOVERLAPPINGMARGIN

To calculate the coverage prediction for the best server and all Version ≥ 3.4.1
potential servers within a positive overlap margin with respect Type: Boolean
to the best server. Depends on the value of BESTSERVERAccess: Read/Write
CALCTYPE. This property is only available for WiMAX/LTE/5G
NR predictions.

OVERLAPPINGMARGIN

Margin value in dB to calculate the coverage prediction for the Version ≥ 3.4.1
best server and all potential servers within a positive overlap
Type: Single
margin with respect to the best server. Depends on the value of Access: Read/Write
BESTSERVERCALCTYPE. This property is only available for
WiMAX/LTE/5G NR predictions.

BESTSERVERCALCTYPE

This property is only available for WiMAX/LTE/5G NR predictions. Possible values are:
◼ 0 : All. To calculate the coverage prediction for all potential

servers. Each pixel of the coverage prediction will show calculation results corresponding to all the servers that cover it.

Version ≥ 3.4.1
Type: Integer
Access: Read/Write

◼ 1 : Best. To calculate the coverage prediction for only the

best server. Each pixel of the coverage prediction will show
calculation results corresponding to only the best server.
◼ 2 : Best per layer. To calculate the coverage prediction for

one best server per layer. Each pixel of the coverage prediction will show calculation results corresponding to one best
server per layer.
The parameter WITHOVERLAPPINGMARGIN is only taken into
account if BESTSERVERCALCTYPE is set to Best or Best per
layer.

11.4.4

Shadowing and Indoor Coverage Conditions
These properties are called CLUTTERCONDITIONS.
Name
CLUTTERCONDITIONS

Attributes
Version ≥ 2.7.0
Type: PropertyContainer object

These properties are available for all kinds of coverage predictions:

132

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Name

Description

Attributes

SHADOWING

Whether to calculate shadowing margins related to the defined Version ≥ 2.7.0
cell edge coverage probability and the standard deviation(s) per Type: Boolean
clutter class or not. When set to False, no shadowing effect is
Access: Read/Write
considered.

INDOORCOVERAGE

Whether to decrease the received signal level at the receiver of Version ≥ 2.7.0
the indoor loss defined for the corresponding clutter class (clut- Type: Boolean
ter class properties)
Access: Read/Write

EDGECOVERAGEPROBABILITY

A value between 0 and 100, expressing in percentage value the Version ≥ 2.7.0
required coverage probability at the cell edge.
Type: Single
Access: Read/Write

11.4.5

KPI Properties
These properties are available for "KPI Quality Zones (DL)" and "Coverage by Transmitter (DL)" predictions:
Name

Description

Attributes

KPI

Applies a filter to KPI indicators that are present in the document Version ≥ 3.4.1
for "KPI Quality Zones (DL)" predictions.
PropertyContainer
object

KPIFILTER

Applies a filter to KPI indicators that are present in the document Version ≥ 3.4.1
for "Coverage by Transmitter (DL)" predictions.
PropertyContainer
object

The conditions for implementing filters are the same as the RECORDSETCONDITIONS. For more information, see
"Group, Filter, and Sort Properties" on page 123.

11.4.6

Display Properties
Display properties for coverage predictions are accessed through a property named "DISPLAYPROPERTIES." The
"DISPLAYPROPERTIES" property is a container object used to contain individual display properties.
Name
DISPLAYPROPERTIES

Attributes
Version ≥ 2.7.0
Type: PropertyContainer object

The properties available in the "DISPLAYPROPERTIES" property container are, for all kinds of coverage predictions:
REPRESENTATION tabular data object
The "REPRESENTATION" tabular data object contains attributes of intervals or values used to display the prediction
on the map. This tabular data object can be edited to change, remove, or add display intervals or display values.
The "REPRESENTATION" tabular data object is available as a "DISPLAYPROPERTIES" property named
"REPRESENTATION"

Name
REPRESENTATION

Attributes
Version ≥ 2.7.0
Type: TabularData object

The schema of the "REPRESENTATION" tabular data object is:

© 2022 Forsk. All Rights Reserved.

133

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Tabular Data Column Name

Description

Attributes

LINESTYLE

The style of the line used to display the interval or the value. The Version ≥ 2.7.0
values are: 5=None; 0=Solid; 128=Solid Double Line; 1=Dash;
Type: Integer
2=Dash Dot; 4=Dash Dot Dot;
Access: Read/Write

LINEWIDTH

The width of the line used to display the interval or the value, Version ≥ 2.7.0
expressed in tenth of a point. For instance, to have a line width Type: Integer
of 0,5 pt, the LINEWIDTH property value must be set to 5.
Access: Read/Write

FILLSTYLE

The graphical style used to fill the interior of the surface defined Version ≥ 2.7.0
by the display interval or the display value. The values are:
Type: Integer
0=None; 1=Full; 2=Horizontal; 3=Vertical; 4=Down Diagonal;
Access: Read/Write
5=Up Diagonal; 6=Grid; 7=Treillis;

MAINCOLOR

The main color assigned to the display interval or the display
value. The color format is RGB.

Version ≥ 2.7.0

Type: Integer
See "Converting Integers to RGB and Vice-versa" on page 134. Access: Read/Write
SECONDARYCOLOR

The secondary color assigned to the display interval or the dis- Version ≥ 2.7.0
play value. The color format is RGB.
Type: Integer
See "Converting Integers to RGB and Vice-versa" on page 134. Access: Read/Write

SYMBOL

This property is not used to display a prediction interval or a pre- Version ≥ 2.7.0
diction value.
Type: Integer
Access: Read/Write

SYMBOLSIZE

This property is not used to display a prediction interval or a pre- Version ≥ 2.7.0
diction value.
Type: Integer
Access: Read/Write

VALUE

The text assigned to the display value. When the display type of Version ≥ 2.7.0
the prediction is set to intervals, a Null value is returned.
Type: String or Null
Access: Read/Write

MINVALUE

The minimum value of the display interval. When the display type Version ≥ 2.7.0
of the prediction is set to display unique or discrete values, a Null Type: Double or Null
value is returned.
Access: Read/Write

MAXVALUE

The maximum value of the display interval. When the display Version ≥ 2.7.0
type of the prediction is set to display unique or discrete values, Type: Double or Null
a Null value is returned.
Access: Read/Write

Converting Integers to RGB and Vice-versa
To convert Integer to RGB color components:
Dim Red
Dim Green
Dim Blue
Let Red = (color And &HFF)
Let Green = ((color \ 256) And &HFF)
Let Blue = ((color \ 65536) And &HFF)
To convert RGB colour components to Integer:
Dim color
Let color = (Red + Green * 256 + Blue * 65536)

134

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Other DISPLAYPROPERTIES properties
DISPLAYPROPERTIES
Property Name

Description

Attributes

TYPE

A value between 0 and 2 used to choose which value classes to Version ≥ 2.7.0
display on the map for the current prediction: 0=Unique; 1=Dis- Type: Integer
crete Values; 2=Value Intervals;
Access: Read/Write

FIELD

The field title used to choose which coverage to display on the Version ≥ 2.7.0
map. The field title must be compatible with the display type
Type: String
property.
Access: Read/Write

TRANSPARENCY

A value between 0 and 100 used to adjust the level of transpar- Version ≥ 2.7.0
ency of the display interval or the display value.
Type: Integer
Access: Read/Write

11.5 GSM Simulation Group Properties
The following properties are accessible for a GSM Monte Carlo simulation group.
Name
TRAFFICMAPS

Description
The names of the traffic maps used by a simulation group.

Attributes
Version≥3.2.1
Type: Array of Strings
Access: Read/Write

NUMBEROFSIMULATIONS

The number of simulations in a simulation group.

Version≥3.2.1
Type: Integer
Access: Read/Write

EXECUTELATER

When set to true, the group of simulations will be run as part Version≥3.2.1
of the predictions calculation.
Type: Boolean
Access: Read

GLOBALSCALINGFACTOR

Global traffic densities weighting.

Version≥3.2.1
Type: Single
Access: Read/Write

GENERATORINITIALISATION

The seed of the pseudo random number generator, used to Version≥3.2.1
obtain two identical user distributions.
Type: Integer
Access: Read/Write

MAXNUMBEROFITERATIONS

The maximum number of iterations if the convergence crite- Version≥3.2.1
ria cannot be reached.
Type: Integer
Access: Read/Write

ULCONVERGENCETHRESHOLD
(for Single-RATdocuments)

The UL relative interference difference to reach between two Version≥3.2.1
iterative steps.
Type: Single
Access: Read/Write

GSMULCONVERGENCETHRESHO
LD
(for 3GPP Multi-RAT documents)
DLCONVERGENCETHRESHOLD
(for Single-RAT documents)

The DL relative interference difference to reach between two Version ≥3.2.1
iterative steps.
Type: Single
Access: Read/Write

GSMDLCONVERGENCETHRESHO
LD
(for 3GPP Multi-RAT documents)

© 2022 Forsk. All Rights Reserved.

135

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name
ULCONVERGENCEINTERFERENCES

Description

Attributes

The UL noise rise relative interference to reach between two Version ≥3.2.1
iterative steps.
Type: Single
Access: Read/Write

DLCONVERGENCEPWRCTRLGAIN

The power control gain difference to reach DL between two Version ≥3.2.1
iterative steps.
Type: Single
Access: Read/Write

11.6 UMTS Simulation Group Properties
Type returned by get_ObjectKind: {AF5E2B98-1D54-48FA-89C5-8BFA2936ABF2}
The following properties are accessible for a UMTS Monte Carlo simulation group.
Name
TRAFFICMAPS

Description

Attributes

The names of the traffic maps used by a simulation group.

Type: Array of Strings
Access: Read/Write

NUMBEROFSIMULATIONS

The number of simulations in a simulation group.

Version ≥ 2.7.1
Type: Integer
Access: Read/Write

EXECUTELATER

When set to true, the group of simulations will be run as part of Version ≥ 2.7.1
the predictions calculation.
Type: Boolean
Access: Read

INFORMATIONABOUTMOBILES

The type of outputs needed in the "Mobiles" tab of each simu- Version ≥ 2.7.1
lation in the simulations group. Available values are: 0=Only the Type: Integer
Average Simulation And Statistics; 1=No Information About
Access: Read/Write
Mobiles; 2=Standard Information About Mobiles; 3=Detailed
Information About Mobiles;

BEARERRATEDOWNGRADING

When set to true, R99 bearer downgrading is allowed.

Version ≥ 2.7.1
Type: Boolean
Access: Read/Write

GLOBALSCALINGFACTOR

Global traffic densities weighting.

Version ≥ 2.7.1
Type: Single
Access: Read/Write

GENERATORINITIALISATION

The seed of the pseudo random number generator, used to
obtain two identical user distributions.

Version ≥ 2.7.1
Type: Integer
Access: Read/Write

MAXNUMBEROFITERATIONS

The maximum number of iterations if the convergence criteria Version ≥ 2.7.1
cannot be reached.
Type: Integer
Access: Read/Write

ULCONVERGENCETHRESHOLD

The UL relative interference difference to reach between two
iterative steps.

Version ≥ 2.7.1
Type: Single
Access: Read/Write

DLCONVERGENCETHRESHOLD

The DL relative interference difference to reach between two
iterative steps.

Version ≥ 2.7.1
Type: Single
Access: Read/Write

CONSTRAINTNUMBEROFCES

When set to true, the maximum number of channel elements
defined per site is respected.

Version ≥ 2.7.1
Type: Boolean
Access: Read/Write

CONSTRAINTNUMBEROFCODES

When set to true, OVSF codes availibility is checked.

Version ≥ 2.7.1
Type: Boolean
Access: Read/Write

136

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Name
CONSTRAINTULLOADFACTOR

Description
When set to true, the maximum UL load factor is respected.

Attributes
Version ≥ 2.7.1
Type: Boolean
Access: Read/Write

CONSTRAINTDLLOAD

When set to true, the maximum DL load is respected.

Version ≥ 2.7.1
Type: Boolean
Access: Read/Write

CONSTRAINTUSECELLMAXULLOADFACTOR

When set to true, the maximum UL load factor is defined per cell. Version ≥ 2.7.1
Type: Boolean
Access: Read/Write

CONSTRAINTUSECELLMAXDLLOAD

When set to true, the maximum DL load is defined per cell.

Version ≥ 2.7.1
Type: Boolean
Access: Read/Write

MAXULLOADFACTOR

Global UL load factor to impose to cells.

Version ≥ 2.7.1

Valid values are comprised between 0 (0%) and 1(100%).

Type: Single
Access: Read/Write

MAXDLLOAD

Global DL load to impose to cells.

Version ≥ 2.7.1

Valid values are comprised between 0 (0%) and 1(100%).

Type: Single
Access: Read/Write

IUBTHROUGHPUTS

Iub throughputs.

Version ≥ 3.1.1
Type: Boolean
Access: Read/Write

11.7 WiMAX and LTE Simulation Group Properties
Type returned by get_ObjectKind: {AF5E2B98-1D54-48FA-89C5-8BFA2936ABF2}
The following properties are accessible for a WiMAX or LTE Monte Carlo simulation group.
Name
TRAFFICMAPS

Description
The names of the traffic maps used by a simulation group.

Attributes
Version ≥ 2.8.1
Type: Array of Strings
Access: Read/Write

SUBSCRIBERLISTS

The names of the subscriber lists used by a simulations group. Version ≥ 2.8.1
Type: Array of Strings
Access: Read/Write

NUMBEROFSIMULATIONS

The number of simulations in a simulation group.

Version ≥ 2.8.1
Type: Integer
Access: Read/Write

EXECUTELATER

When set to true, the group of simulations will be run as part of Version ≥ 2.8.1
the predictions calculation.
Type: Boolean
Access: Read

GLOBALSCALINGFACTOR

Global traffic densities weighting.

Version ≥ 2.8.1
Type: Single
Access: Read/Write

GENERATORINITIALISATION

The seed of the pseudo random number generator, used to
obtain two identical user distributions.

Version ≥ 2.8.1
Type: Integer
Access: Read/Write

MAXNUMBEROFITERATIONS

The maximum number of iterations if the convergence criteria Version ≥ 2.8.1
cannot be reached.
Type: Integer
Access: Read/Write

© 2022 Forsk. All Rights Reserved.

137

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name
ULCONVERGENCETHRESHOLD

Description

Attributes

The UL relative traffic load difference to reach between two iter- Version ≥ 2.8.1
ative steps.
Type: Single
Access: Read/Write

DLCONVERGENCETHRESHOLD

The DL relative traffic load difference to reach between two iter- Version ≥ 2.8.1
ative steps.
Type: Single
Access: Read/Write

ULNOISERISECONVERGENCETHRESHOLD

The UL noise rise relative interference to reach between two iter- Version ≥ 2.8.1
ative steps.
Type: Single
Access: Read/Write

CONSTRAINTUSECELLMAXULTRAFFICLOAD

When set to true, the maximum UL traffic load is defined per cell. Version ≥ 2.8.1
Type: Boolean
Access: Read/Write

CONSTRAINTUSECELLMAXDLTRAFFICLOAD

When set to true, the maximum DL traffic load is defined per cell. Version ≥ 2.8.1
Type: Boolean
Access: Read/Write

MAXULTRAFFICLOAD

Global UL traffic load to impose to cells.

Version ≥ 2.8.1
Type: Single
Access: Read/Write

MAXDLTRAFFICLOAD

Global DL traffic load to impose to cells.

Version ≥ 2.8.1
Type: Single
Access: Read/Write

BACKHAULCAPACITY

Backhaul Capacity

Version ≥ 3.2.1
Type: Boolean
Access: Read/Write

NOISERISECONTROL

Noise Rise Control

Version ≥ 3.2.1
Type: Boolean
Access: Read/Write

11.8 Multi-RAT Simulation Group Properties
The following properties are accessible for a Multi-RAT simulation group.
In a Multi-RAT document, you can access all the properties we have for all the technologies available in your
document, except ULCONVERGENCETHRESHOLD and DLCONVERGENCETHRESHOLD which are prefixed with the
technology name.
GSM
Name
GSMULCONVERGENCETHRESHOLD

Description
For GSM technology:

Attributes
Version ≥3.2.1

The UL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write
GSMDLCONVERGENCETHRESHOLD

For GSM technology:

Version ≥3.2.1

The DL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write

138

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

UMTS
Name
UMTSULCONVERGENCETHRESHOLD

Description

Attributes

For UMTS technology:

Version ≥3.2.1

The UL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write
UMTSDLCONVERGENCETHRESHOLD

For UMTS technology:

Version ≥3.2.1

The DL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write

LTE
Name
LTEULCONVERGENCETHRESHOLD

Description

Attributes

For LTE technology:

Version ≥3.2.1

The UL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write
LTEDLCONVERGENCETHRESHOLD

For LTE technology:

Version ≥3.2.1

The DL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write

4G/5G
Name
4G5GULCONVERGENCETHRESHOLD

Description

Attributes

For 4G/5G technology:

Version ≥3.4.1

The UL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write
4G5GDLCONVERGENCETHRESHOLD

For 4G/5G technology:

Version ≥3.2.1

The DL relative interference difference to reach between two Type: Single
iterative steps.
Access: Read/Write

11.9 Standard Propagation Model Properties
The Type returned by get_ObjectKind for the Propagation Models folder: {4A2D160B-7D11-4D07-92DFA3CF6B68D402}
get_ObjectKind is available for the Propagation Models folder for version ≥ 2.7.0.
The Type returned by get_ObjectKind for the Standard Propagation Model: Atoll.StdPropagModel.1
get_ObjectKind is available for the Standard Propagation Model for version ≥ 2.7.0.
The Standard Propagation Model properties are called MODELPROPERTIES.
Name
MODELPROPERTIES

Attributes
The property container holding the propagation model parameters
Version ≥ 2.7.0
Type: PropertyContainer object

The following MODELPROPERTIES are available for the Standard Propagation Model:

© 2022 Forsk. All Rights Reserved.

139

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name
EFFECTIVEANTENNAHEIGHTMETHOD

Description

Attributes
Version ≥ 2.7.0
Type: Integer
Access: Read/Write

EFFECTIVEANTENNAHEIGHTDISTANCEMIN

Version ≥ 2.7.0
Type: Double
Access: Read/Write

EFFECTIVEANTENNAHEIGHTDISTANCEMAX

Version ≥ 2.7.0
Type: Single
Access: Read/Write

DIFFRACTIONMETHOD

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

CLUTTERLOSSES

Loss for each clutter class defined in the Atoll document. Version ≥ 2.7.0
When there are no clutter classes, the Null value is returned, Type: Array of Single
otherwise the size of the returned array is the number of clutAccess: Read/Write
ter classes defined in the Atoll document.

CLUTTERCLEARANCES

Clearance for each clutter class defined in the Atoll docu- Version ≥ 2.7.0
ment. When there are no clutter classes, the Null value is Type: Array of Single
returned, otherwise the size of the returned array is the num- Access: Read/Write
ber of clutter classes defined in the Atoll document.

CLUTTERWEIGHTINGFUNCTION

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

CLUTTERMAXIMUMDISTANCE

Version ≥ 2.7.0
Type: Double
Access: Read/Write

K1

Version ≥ 2.7.0
Type: Array of Single
Access: Read/Write

K2

Version ≥ 2.7.0
Type: Array of Single
Access: Read/Write

K3

Version ≥ 2.7.0
Type: Double
Access: Read/Write

K4

Version ≥ 2.7.0
Type: Double
Access: Read/Write

K5

Version ≥ 2.7.0
Type: Double
Access: Read/Write

K6

Version ≥ 2.7.0
Type: Double
Access: Read/Write

KCLUTTER

Version ≥ 2.7.0
Type: Double
Access: Read/Write

NEARTRANSMITTERMAXIMUMDISTANCE

Version ≥ 2.7.0
Type: Double
Access: Read/Write

PROFILES

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

140

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Name

Description

GRIDCALCULATION

Attributes
Version ≥ 2.7.0
Type: Integer
Access: Read/Write

CONSIDERCLUTTERHEIGHTSINDIFFRACTION

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

HILLYTERRAINCORRECTION

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

CLUTTERRECEIVERHEIGHTS

Height of the receiver for each clutter class defined in the Version ≥ 2.7.0
Atoll document. When there are no clutter classes, the Null Type: Array of Single
value is returned, otherwise the size of the returned array is Access: Read/Write
the number of clutter classes defined in the Atoll document.

LIMITATIONTOFREESPACELOSS

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

RECEIVERONTOPOFCLUTTER

Version ≥ 2.7.0
Type: Integer
Access: Read/Write

11.10 CW Measurement Properties
The Type returned by get_ObjectKind for the CW Measurements folder: SID_CW_MEASUREMENTS
The following properties are accessible for the CW Measurements folder:
Name
VECTORDATAFILTER

Description

Attributes

Advanced vector table filter, as it appears in CW Measurements Type: String
folders properties.
Access: Read/Write

The Type returned by get_ObjectKind for a CW Measurements subfolder: MeasureTx
The following properties are accessible for a CW Measurements subfolder:
Name
VECTORDATAFILTER

Description

Attributes

Advanced vector table filter, as it appears in CW Measurements Type: String
subfolder properties.
Access: Read/Write

The Type returned by get_ObjectKind for a CW Measurements item: MeasureItem
The following properties are accessible for a CW Measurements item:
Name

Description

Attributes

VECTORDATAFILTER

Advanced vector table filter, as it appears in CW Meas- Type: String
urements item properties.
Access: Read/Write

PREDICTIONMODEL

Name of a propagation model.

Type: String
Access: Read/Write

HEADER

Type: String
Access: Read/Write

TRANSMITTERNAME

Name of a transmitter.

Type: String
Access: Read/Write

TRANSMITTERFREQUENCY

Type: Single
Access: Read/Write

© 2022 Forsk. All Rights Reserved.

141

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name

Description

RECEIVERHEIGHT

Attributes
Type: Single
Access: Read/Write

RECEIVERGAIN

Type: Single
Access: Read/Write

RECEIVERLOSSES

Type: Single
Access: Read/Write

VECTORDATA

Table content of the measurement path.

Type: TabularData object

TECHNOLOGYNAME

Technology name : "UMTS", "LTE", or "GSM"

Version ≥ 3.1.1
Type: String
Access: Read/Write

11.11 Drive Test Data Properties
The Type returned by get_ObjectKind for a Drive Test Data item: NumMeasureItem
The following properties are accessible for a Drive Test Data item:
Name

Description

HEADER

Attributes
Type: String
Access: Read/Write

RECEIVERHEIGHT

Type: Single
Access: Read/Write

RECEIVERGAIN

Type: Single
Access: Read/Write

RECEIVERLOSSES

Type: Single
Access: Read/Write

VECTORDATA

Table content of the measurement path.

Type: TabularData object

11.12 Custom ChildFolder Object Properties
The Type returned by get_ObjectKind for a custom ChildFolder object is the version dependent PROGID of the
custom ChildFolder object.
get_ObjectKind is accessible for the custom ChildFolder objects for version ≥ 2.7.0.
The following properties are accessible for a custom ChildFolder object.
Name
MODELPROPERTIES

Description
The property container holding the custom ChildFolder object
properties.
The MODELPROPERTIES PropertyContainer object will contain
properties exposed by the custom ChildFolder object .

CANRENAME

Attributes
Version ≥ 2.7.0
Type: PropertyContainer
object
Access: Read/Write

Returns true when the custom ChildFolder object can be renamed. Version ≥ 2.7.0
When false is returned, the "Rename" context menu option for the Type: Boolean
ChildFolder object is unavailable.
Access: Read/Write

CANDELETE

Returns true when the custom ChildFolder object can be deleted. Version ≥ 2.7.0
When false is returned, the "Delete" context menu option for the Type: Boolean
ChildFolder object is unavailable.
Access: Read/Write

142

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Name
TRANSPARENCY

Description

Attributes

The global transparency between 0 and 100 associated with the Version ≥ 2.7.0
custom ChildFolder object.
Type: Integer
Access: Read/Write

COMMENT

The comment string associated with the custom ChildFolder
object.

Version ≥ 3.2.1
Type: String
Access: Read/Write

11.13 Master Link Properties
Master Link ChildFolder objects are located as top level items in either the Data tab or the Geo tab of the document
explorer window. They are used to specify links from one ChildFolder object to another ChildFolder object (the target
ChildFolder object), located in another Document object (the target Document object).
The Type returned by get_ObjectKind for Master Link ChildFolder objects is :
{16A53FB3-A961-4EEA-8C30-2387DBF1CC24}
The following properties are accessible for Master Link ChildFolder objects.
Name
TARGET

Description
The target ChildFolder object.

Attributes
Type: Object, or Null value.

The Null value is returned when the target Document object is not Access: Read
opened in the current session.
TARGETDOCUMENTFULLNAME

The full path to the target document .ATL file.

Type: String

An error is returned when the target file cannot be located.

Access: Read

11.14 Link Properties
Link ChildFolder objects are children of Master Link ChildFolder objects.
The Type returned by get_ObjectKind for Link ChildFolder objects is :
{232BDB73-A68F-41A6-A954-75112D907BBF}
The following properties are accessible for Link ChildFolder objects.
Name
TARGET

Description

Attributes

The target ChildFolder object.

Type: Object, or Null
The Null value is returned when the target Document object is value.
not opened in the current session.
Access: Read

11.15 Vector Layer Properties
The following properties are accessible for Vector Layer ChildFolder objects.

© 2022 Forsk. All Rights Reserved.

143

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name
VECTORDATA

Description

Attributes

The vector table of the vector layer.

Version ≥ 3.2.1
Type: TabularData
object

DISPLAYPROPERTIES

The vector layer display properties.

Version ≥ 2.7.0
Type: PropertyContainer object

FILEPATH

Returns the full file path to the geo data file if the file is linked or Version ≥ 3.4.1
an empty string if the file is embedded in the document.
Type: String
Access: Read only

11.15.1

Display Properties
Display properties for vector layers are accessed through a property named "DISPLAYPROPERTIES." The
"DISPLAYPROPERTIES "property is a container object used to contain individual display properties.
The properties available in the "DISPLAYPROPERTIES" property container are, for all kinds of vector layers:
REPRESENTATION tabular data object
The "REPRESENTATION" tabular data object contains attributes of intervals or values used to display the vector
layer on the map. This tabular data object can be edited to change, remove, or add display intervals or display values.
The "REPRESENTATION" tabular data object is available as a "DISPLAYPROPERTIES" property named
"REPRESENTATION"
DISPLAYPROPERTIES

Attributes

Property Name
REPRESENTATION

Version ≥ 3.2.1
Type: TabularData object

The schema of the "REPRESENTATION" tabular data object is:
Tabular Data Column Name

Description

Attributes

LINESTYLE

The style of the line used to display the interval or the value. The Version ≥ 3.2.1
values are: 5=None; 0=Solid; 128=Solid Double Line; 1=Dash;
Type: Integer
2=Dash Dot; 4=Dash Dot Dot;
Access: Read/Write

LINEWIDTH

The width of the line used to display the interval or the value, Version ≥ 3.2.1
expressed in tenth of a point. For instance, to have a line width Type: Integer
of 0,5 pt, the LINEWIDTH property value must be set to 5.
Access: Read/Write

FILLSTYLE

The graphical style used to fill the interior of the surface defined Version ≥ 3.2.1
by the display interval or the display value. The values are:
Type: Integer
0=None; 1=Full; 2=Horizontal; 3=Vertical; 4=Down Diagonal;
Access: Read/Write
5=Up Diagonal; 6=Grid; 7=Treillis;

MAINCOLOR

The main color assigned to the display interval or the display
value. The color format is RGB.

Version ≥ 3.2.1

Type: Integer
See "Converting Integers to RGB and Vice-versa" on page 134. Access: Read/Write
SECONDARYCOLOR

The secondary color assigned to the display interval or the dis- Version ≥ 3.2.1
play value. The color format is RGB.
Type: Integer
See "Converting Integers to RGB and Vice-versa" on page 134. Access: Read/Write

SYMBOL

This property is not used to display a vector layer interval or a
vector layer value.

Version ≥ 3.2.1
Type: Integer
Access: Read/Write

144

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

AT350_TAG_E3

Tabular Data Column Name
SYMBOLSIZE

Description
This property is not used to display a vector layer interval or a
vector layer value.

Attributes
Version ≥ 3.2.1
Type: Integer
Access: Read/Write

VALUE

The text assigned to the display value. When the display type of Version ≥ 3.2.1
the vector layer is set to intervals, a Null value is returned.
Type: String or Null
Access: Read/Write

MINVALUE

The minimum value of the display interval. When the display type Version ≥ 3.2.1
of the vector layer is set to display unique or discrete values, a Type: Double or Null
Null value is returned.
Access: Read/Write

MAXVALUE

The maximum value of the display interval. When the display Version ≥ 3.2.1
type of the vector layer is set to display unique or discrete values, Type: Double or Null
a Null value is returned.
Access: Read/Write

Converting Integers to RGB and Vice-versa
To convert Integer to RGB color components:
Dim Red
Dim Green
Dim Blue
Let Red = (color And &HFF)
Let Green = ((color \ 256) And &HFF)
Let Blue = ((color \ 65536) And &HFF)
To convert RGB colour components to Integer:
Dim color
Let color = (Red + Green * 256 + Blue * 65536)
Other DISPLAYPROPERTIES properties
DISPLAYPROPERTIES

Description

Property Name

Attributes

TYPE

A value between 0 and 2 used to choose which value classes to Version ≥ 3.2.1
display on the map for the current vector layer: 0=Unique; 1=Dis- Type: Integer
crete Values; 2=Value Intervals;
Access: Read/Write

FIELD

The field title used to choose which coverage to display on the Version ≥ 3.2.1
map. The field title must be compatible with the display type
Type: String
property.
Access: Read/Write

TRANSPARENCY

A value between 0 and 100 used to adjust the level of transpar- Version ≥ 3.2.1
ency of the display interval or the display value.
Type: Integer
Access: Read/Write

11.16 Online Map Properties
Type returned by get_ObjectKind: {23441E2C-4CE7-4750-A00E-7476B9C039F1}
The following properties are accessible for Online Map ChildFolder objects.

© 2022 Forsk. All Rights Reserved.

145

Atoll 3.5.0 Task Automation Guide
Chapter 11: ChildFolder Object Properties

Name
PROVIDER

Description

Attributes

Returns the name of the online maps provider: "Bing" or "Other" Version ≥ 3.4.1
Type: String
Access: Read only

TYPE

Returns the type of online map.

Version ≥ 3.4.1

Can be empty if not supported.

Type: String
Access: Read only

LANGUAGE

Returns the language as "en-en", "fr-fr", "ja-jp".

Version ≥ 3.4.1

Can be empty if not supported.

Type: String
Access: Read only

SERVERURL

Returns the URL of the online map server.

Version ≥ 3.4.1

Can be empty if not supported.

Type: String
Access: Read only

11.17 Multi-point Analysis Properties
Type returned by get_ObjectKind for the Multi-point analysis folder: {04D695A3-D107-4896-8BAA-44A82BA7E51D}
The point analysis types returned by get_ObjectKind for the different technologies are listed below:
Name

Type

Attributes

5G NR

{32A18204-28DD-49AD-B9A4-A742FD08A46F}

Version ≥ 3.4.1

LTE

{2A01A1B4-5AE9-4A5F-9D7C-06035383950C}

Version ≥ 3.4.1

NB-IoT

{263276ED-E7D3-4B84-AB83-EE349B719D35}

Version ≥ 3.4.1

UMTS

{FDB3B227-4EF8-4733-A524-0998425AD85F}

Version ≥ 3.4.1

GSM

{A6D90FED-6249-482E-8648-294FD332E4B1}

Version ≥ 3.4.1

WiMax

{0190FE32-1CC5-4E3D-8A43-78EA1707ACFD}

Version ≥ 3.4.1

CDMA

{188969FA-36E7-4CE8-AAE7-DAEC0F4777D3}

Version ≥ 3.4.1

LPWA

{EAF2B5E0-C91E-4FC9-B0D9-E51AE7316AA8}

Version ≥ 3.4.1

1xRTT

{53EEF403-C522-40EC-95CF-933114D3BB36}

Version ≥ 3.4.1

The subscribers analysis types returned by get_ObjectKind for the different technologies are listed below:
Name

Type

Attributes

5G NR

{31C20599-13BF-4C1E-9976-CE016222D59D}

Version ≥ 3.4.1

LTE

{F1A3FA7F-35E4-4CFF-941A-1628E01D5BCC}

Version ≥ 3.4.1

NB-IoT

{228A4120-7388-4166-80D7-3D174A08CA39}

Version ≥ 3.4.1

WiMax

{99122166-DE30-45C7-8703-0163861B0D6E}

Version ≥ 3.4.1

LPWA

{FD001056-3665-4F9D-8CEB-1F5B19660219}

Version ≥ 3.4.1

The following properties are accessible for a point analysis:
Name
POINTS

Description
Table content of the points coordinates.

Attributes
Version ≥ 3.4.1
TabularData object

RESULTS

146

Table content of the computation results.

TabularData object

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

12 ChildFolder Feature Objects
Feature objects offer features closely tied to some Atoll document folders. The following ChildFolder Feature
objects are available through the Dispatch property of ChildFolder objects of Atoll document folders:
◼

"Clutter Feature Object" on page 147,

◼

"Traffic Feature Object" on page 150,

◼

"UMTS Traffic Scenario Provider Object" on page 153,

◼

"Environment Based Traffic Map Feature Object" on page 154,

◼

"Simulation Feature Object" on page 157,

◼

"Simulation Group Feature Object" on page 160.

◼

"Multi-RAT Simulation Group Feature Object" on page 166

◼

"GSM Interference Matrix Feature Object" on page 168

12.1 Clutter Feature Object
The Clutter Feature object gives access to clutter classes properties. It is available for all Atoll documents. It is
associated with the Clutter Classes folder of an Atoll document.
The Clutter Feature object provides the following properties and methods:
Name

12.1.1

Description

Source

Returns the Clutter Classes ChildFolder object.

ClassAttributes

Returns a TabularData object holding the clutter class attributes.

DefaultAttributes

Returns a TabularData object holding the clutter class default values.

Attributes

How to Access the Clutter Feature Object
The ObjectKind property for the Clutter Classes folder is:
{7CB51DE8-A961-11D2-8688-0060086457D1}
Sample code to access the Clutter Feature object:
’ Returns the clutter feature object of the ’doc’ Atoll document object
Public Function ClutterFeatureObject(doc)
Const OBJECTKIND_CLUTTER = "{7CB51DE8-A961-11D2-8688-0060086457d1}"
Const atoGeo = 1
Dim oClutterClasses
Set oClutterClasses = doc.GetRootFolder(atoGeo).Item(OBJECTKIND_CLUTTER)
Set ClutterFeatureObject = oClutterClasses.Dispatch
End Function

© 2022 Forsk. All Rights Reserved.

147

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

12.1.2

Source
Returns the Clutter Classes ChildFolder object.
HRESULT get_Source(IDispatch **ppSource);
Parameters
[out] ppSource: Address of the IDispatch interface pointer used to return the Clutter Classes ChildFolder object.

12.1.3

ClassAttributes
Returns a TabularData object holding the clutter class attributes.
HRESULT get_ClassAttributes(ITabularData **ppTable);
Parameters
[out] ppTable: Address of the ITabularData interface pointer used to return the clutter class attributes. The content
of the TabularData object returned is the same as the content of the "Description" property page for the Clutter
Classes folder of an Atoll document, it is dependent on the type of the project template used by the Atoll document.
Remarks
The number of rows in the tabular data object returned depends on the state of the "Use only default values"
checkbox.
When the "Use only default values" checkbox is checked, the number of rows returned is always 1, the tabular data
object returned is the same as the one returned by DefaultAttributes.
Version: ≥ 3.1.0
The schema of the tabular data object returned by ClassAttributes does not depend on the state of the "Use only
default value" checkbox. Whether the project is configured to use only default clutter class values or not,
ClassAttributes returns values used in calculations, in a consistent manner:
◼

The number of rows or columns are the same in both cases.

◼

Columns data types are the same in both cases.

To determine whether the "Use only default values" checkbox is checked or not, one can test the value returned by
CanEdit on the tabular data object returned by get _ClassAttributes. When using only default values, the tabular data
object returned is read-only, and CanEdit output value is VARIANT_FALSE.

12.1.4

DefaultAttributes
Returns a TabularData object holding the clutter class default values.
HRESULT get_DefaultAttributes(ITabularData **ppTable);
Parameters
[out] ppTable: Address of the ITabularData interface pointer used to return the clutter class default values. The
content of the TabularData object returned is the same as the content of the "Default Values" property page for the
Clutter Classes folder of an Atoll document, it is dependent on the type of the project template used by the Atoll
document.

148

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

12.1.5

Accessing Clutter Class Attributes
Sample macro to output the various clutter class attributes to the Atoll event viewer:
Private Function ClutterFeatureObject(doc)
Const OBJECTKIND_CLUTTER = "{7CB51DE8-A961-11D2-8688-0060086457d1}"
Const atoGeo = 1
Dim oClutterClasses
Set oClutterClasses = doc.GetRootFolder(atoGeo).Item(OBJECTKIND_CLUTTER)
Set ClutterFeatureObject = oClutterClasses.Dispatch
End Function
Private Sub DumpTable(t)
Dim c
Dim r
Dim values()
For r = 0 To t.RowCount
Redim values(t.ColumnCount)
For c = 0 To t.ColumnCount
values(c) = t.GetValue(r, c)
If IsNull(values(c)) Then
values(c) = "(Null)"
End If
If IsEmpty(values(c)) Then
values(c) = "(Empty)"
End If
If IsArray(values(c)) Then
values(c) = "(Array)"
End If
Next
LogMessage Join(values, ";")
Next
End Sub
Public Sub DumpClutterAttributes
Dim f
Set f = ClutterFeatureObject(ActiveDocument)
Dim classattrs
Dim defaultattrs
Set classattrs = f.ClassAttributes
LogMessage "Clutter Class Attributes..."
DumpTable(classattrs)
LogMessage "End Class Attributes."
Set defaultattrs = f.DefaultAttributes
LogMessage "Clutter Class Default Attributes..."
DumpTable(defaultattrs)
LogMessage "End Clutter Class Default Attributes."
End Sub

© 2022 Forsk. All Rights Reserved.

149

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

12.2 Traffic Feature Object
The Traffic Feature object gives access to features associated with the traffic folder, such as the export of the
cumulated traffic. It is available for all Atoll documents except Microwave Links documents. It is associated with
the Traffic folder of an Atoll document.
The Traffic Feature object provides the following properties and methods:
Name

12.2.1

Description

Attributes

Source

Returns the Traffic ChildFolder object.

ScenarioProvider

Creates a new Traffic Scenario Provider object instance.

ExportCumulatedTraffic

Exports the cumulated traffic.

HasTrafficForService

Determines if a traffic map contains traffic information for a given service.

How to Access the Traffic Feature Object
The ObjectKind property for the Traffic folder is:
{B3B25A07-A994-4E8D-BBD1-51556D6C4245}
Sample code to access the Traffic Feature Object:
' Returns the traffic feature object of the ’doc’ Atoll document object
Public Function TrafficFeatureObject(doc)
Const OBJECTKIND_TRAFFIC = "{B3B25A07-A994-4E8D-BBD1-51556D6C4245}"
Const atoGeo = 1
Dim oTraffic
Set oTraffic = doc.GetRootFolder(atoGeo).Item(OBJECTKIND_TRAFFIC)
Set TrafficFeatureObject = oTraffic.Dispatch
End Function

12.2.2

Source
Returns the Traffic ChildFolder object.
HRESULT get_Source(IDispatch **ppSource);
Parameters
[out] ppSource: Address of the IDispatch interface pointer used to return the Traffic ChildFolder object.

12.2.3

ScenarioProvider
Creates a new Traffic Scenario Provider object instance. See "UMTS Traffic Scenario Provider Object" on page 153
for more information on the UMTS Traffic Scenario Provider object.
HRESULT get_ScenarioProvider(ITrafficScenarioProvider **ppProvider);

150

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

Parameters
[out] ppProvider: Address of the ITrafficScenarioProvider interface pointer used to return a new Traffic Scenario
Provider object instance.
Remarks
An error is returned when this method is called for an Atoll document not based on the UMTS HSPA template.

12.2.4

ExportCumulatedTraffic
Exports the cumulated traffic.
typedef enum _AtoRegion
{
atoEntireProjectArea = 0,
atoComputationZone = 1
} _AtoRegion;
typedef _AtoRegion AtoRegion;
typedef enum _AtoDirection
{
atoUplinkDownlink = 0,
atoUplink = 1,
atoDownlink = 2,
} _AtoDirection;
typedef _AtoDirection AtoDirection;
HRESULT ExportCumulatedTraffic(
BSTR bstrFileName,
enum _AtoRegion atoRegion,
BSTR bstrTerminal,
BSTR bstrMobility,
BSTR bstrService,
VARIANT vTrafficMaps,
long lResolution,
enum _AtoDirection atoDirection
);
Parameters
[in] bstrFileName:
A BSTR used to specify the absolute file path used to export the cumulated traffic. The BIL file format is used to
export the cumulated traffic.
[in] atoRegion:
An AtoRegion enumeration value used to specify the area used to export the cumulated traffic:
atoEntireProjectArea : The entire project area
atoComputationZone : The computation zone
[in] bstrTerminal:
A BSTR used to specify the terminal name used to export the cumulated traffic.
If "(ALL)" is specified, then all terminals are used to export the cumulated traffic.
[in] bstrMobility:
A BSTR used to specify the mobility name used to export the cumulated traffic.

© 2022 Forsk. All Rights Reserved.

151

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

If "(ALL)" is specified, then all mobilitiesare used to export the cumulated traffic.
[in] bstrService:
A BSTR used to specify the service name used to export the cumulated traffic.
If "(ALLCS)" is specified, then all circuit services are used to export the cumulated traffic.
If "(ALLPS)" is specified, then all packet services are used to export the cumulated traffic.
[in] vTrafficMaps:
A VARIANT used to specify the traffic maps used to export the cumulated traffic. The type of the VARIANT must be
VT_ARRAY | VT_VARIANT with VARIANTs of type VT_BSTR. The VARIANT array contains the names of the traffic
maps.
[in] lResolution:
A long used to specify the resolution in meter used to export the cumulated traffic.
[in] atoDirection:
An AtoDirection enumeration value used to specify the kind of traffic used to export the cumulated traffic.

12.2.5

HasTrafficForService
Determines if a traffic map contains traffic information for a given service.
HRESULT HasTrafficForService(
BSTR bstrServiceName,
enum _AtoDirection atoDirection,
IChildFolder* pTrafficMap,
VARIANT_BOOL* pHasTraffic
);
Parameters
[in] bstrServiceName:
A BSTR used to specify the a service name.
[in] atoDirection:
An AtoDirection enumeration value used to specify the kind of traffic to look for:
atoUplinkDownlink (= 0) : Uplink and downlink traffic
atoUplink (= 1) : Uplink traffic
atoDownlink(=2) : Downlink traffic
[in] pTrafficMap:
A IChildFolder interface pointer used to specify the traffic map ChildFolder object. The traffic map is searched for
traffic information related to the bstrServiceName service.
This parameter may be NULL. In this case, all traffic maps in the traffic map folder are searched.
[out] pHasTraffic:
A pointer to a VARIANT_BOOL value used to return whether the traffic map specified by pTrafficMap has some
traffic information for the service specified by bstrServiceName.

Remark
When HasTrafficForService returns VARIANT_FALSE, the traffic map is guaranteed not to contain traffic
information for the

152

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

When HasTrafficForService returns VARIANT_TRUE, the traffic map still may not contain traffic information for the
given service.

12.3 UMTS Traffic Scenario Provider Object
The traffic scenario provider allows developing external UMTS simulation modules. Raw mobile data is generated
by Atoll and provided to the external UMTS simulator through this object.
The Traffic Scenario Provider object provides the following properties and methods:
Name

12.3.1

Description

GetMeanSize

Returns the average count of mobiles.

Create

Creates raw mobile data.

Attributes

GetMeanSize
Returns the average count of mobiles.
HRESULT GetMeanSize(
const VARIANT aSelectedMapsNames,
double dScale,
const VARIANT aReserved,
ULONG *pMobilesCount
);
Parameters
[in] aSelectedMapsNames:
A VARIANT value used to specify the names of the traffic environment maps. The type of the VARIANT must be
VT_ARRAY | VT_UI1, it contains the names of the traffic environment maps, separated by the ASCII character code 0.
[in] dScale:
A double value used to specify the scaling factor used in the determination of the mobiles count.
[in] aReserved:
A VARIANT value reserved for future use. The VARIANT type must be VT_EMPTY.
[out] pMobilesCount:
Address of the ULONG integer used to return the average count of mobiles.

12.3.2

Create
Creates raw mobile data. The mobiles data is returned as a TabularData object containing the position of the
mobiles and other information related to the state of mobiles.
HRESULT Create(
const VARIANT aSelectedMapsNames,
double dScale,
enum AtoTrafficScenarioLaw aLaw,
const VARIANT aRreserved,

© 2022 Forsk. All Rights Reserved.

153

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

ITabularData **ppMobiles
);
Parameters
[in] aSelectedMapsNames:
A VARIANT value used to specify the names of the traffic maps. The type of the VARIANT must be VT_ARRAY |
VT_UI1, it contains the names of the traffic maps, separated by the ASCII character code 0.
[in] dScale:
A double value used to specify the scaling factor used in the determination of the mobiles count.
The scaling factor is relative to the average size of mobiles, as returned by GetMeanSize.
[in] aLaw: The AtoTrafficScenarioLaw enumeration value used to specify the law of probability used to get a random
count of mobiles.
[in] aReserved: A VARIANT value used to specify additional parameters.
Atoll version < 2.7.0:
The VARIANT type must be VT_EMPTY.
Atoll version >= 2.7.0:
When the VARIANT type is VT_DISPATCH, it is interpreted as a PropertyContainer object, implementing the
IPropertyContainer2 interface.
The property container object may contain the properties:
◼

Name: RANDOMSEED

◼

Type: VT_I4

◼

Description: An integer value used to specify the random seed of the pseudorandom number generator used
to determine the average count of mobiles, and the mobiles positions.

[out] ppMobiles:
Address of the ITabularData interface pointer used to return the position of the mobiles and other information
related to the state of mobiles. The tabular data schema is:
Column Name

Value

Type

Description

X

X coordinate

Long

Expressed in the document projection coordinate system

Y

Y coordinate

Long

Expressed in the document projection coordinate system

SERVICE

Service name

String

From the UMTSServices table

TERMINAL

Terminal name

String

From the UMTSTerminals table

MOBILITY

Mobility type

String

From the UMTSMobility table

CLUTTER

Clutter code

Short

From the IClutter interface

ACTIVITY

Mobile activity

String

"Active DL", "UL", "UL+DL"

12.4 Environment Based Traffic Map Feature Object
User profile environment based traffic map feature objects give access to user profile environment based traffic
maps attributes. They are available for all Atoll documents except Microwave Links documents. They are
associated with user profile environment base traffic maps contained in the Traffic folder of an Atoll document.
The User Profile Environment Based Traffic Map Feature object provides the following properties and methods:
Name
Source

154

Description
Return the Traffic Map ChildFolder object associated with the Traffic
Map per Environment Feature object.

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

Name

12.4.1

Description

ClassAttributes

Returns a TabularData object holding the traffic map environment
attributes.

DefaultAttributes

Not implemented

How to Access Environment Based Traffic Map Feature Objects
The ObjectKind property for User Profile Environment Based Traffic Maps is:
{E8784A75-AE03-4F4F-B923-6E8BF20725C5}
The User Profile Environment Based Traffic Map Feature object for a user profile environment based traffic map is
returned by the Dispatch property of the user profile environment based traffic map ChildFolder object.

12.4.2

Source
Return the User Profile Environment Base Traffic Map ChildFolder object associated with the User Profile
Environment Based Traffic Map Feature Object.
HRESULT get_Source(IDispatch **ppSource);
Parameters
[out] ppSource: Address of the IDispatch interface pointer used to return the User Profile Environment Based Traffic
Map ChildFolder Object.

12.4.3

ClassAttributes
Returns a TabularData object holding the user profile environment based traffic map attributes.
HRESULT get_ClassAttributes(ITabularData **ppTable);
Parameters
[out] ppTable: Address of the ITabularData interface pointer used to return the user profile environment based traffic
map attributes. The content of the TabularData object is the same as the one shown on the "Description" property
page of user profile environment based traffic maps property sheet.

12.4.4

DefaultAttributes
HRESULT get_DefaultAttributes(ITabularData **ppTable);
Remarks
This method is not implemented. Please don’t use this method.

© 2022 Forsk. All Rights Reserved.

155

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

12.4.5

Accessing Environment Based Traffic Maps Attributes
Private Function TrafficMapPerEnvironmentFeatureObjects(doc)
Const SID_TRAFFICFOLDER = "{B3B25A07-A994-4E8D-BBD1-51556D6C4245}"
Const OKIND_MAP_PER_ENVIRONMENT = "{E8784A75-AE03-4F4F-B923-6E8BF20725C5}"
Const atoGeo = 1
Dim maps()
Dim oTrafficFolder
On Error Resume Next
Set oTrafficFolder = doc.GetRootFolder(atoGeo).Item(SID_TRAFFICFOLDER)
If Err Then
On Error Goto 0
Else
On Error Goto 0
Dim i
Dim n
n = 0
For i = 0 To oTrafficFolder.Count - 1
Dim map
Set map = oTrafficFolder.Item(i)
If map.ObjectKind = OKIND_MAP_PER_ENVIRONMENT Then
Redim Preserve maps(n)
Set maps(n) = map.Dispatch
n = n + 1
End If
Next
End If
TrafficMapPerEnvironmentFeatureObjects = maps
End Function
Private Sub DumpTable(t)
Dim c
Dim r
Dim values()
For r = 0 To t.RowCount
Redim values(t.ColumnCount)
For c = 0 To t.ColumnCount
values(c) = t.GetValue(r, c)
If IsNull(values(c)) Then
values(c) = "(Null)"
End If
If IsEmpty(values(c)) Then
values(c) = "(Empty)"
End If
If IsArray(values(c)) Then
values(c) = "(Array)"
End If
Next
LogMessage Join(values, ";")

156

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

Next
End Sub
Public Sub DumpTrafficMapPerEnvironmentAttributes
Dim maps
maps = TrafficMapPerEnvironmentFeatureObjects(ActiveDocument)
Dim oFeature
For Each oFeature In maps
LogMessage "Traffic Map Per Environment [" & oFeature.Source.Name &
"]..."
Dim attrs
Set attrs = oFeature.ClassAttributes
DumpTable(attrs)
LogMessage "End Traffic Map Per Environment."
Next
End Sub

12.5 Simulation Feature Object
Simulation Feature objects give access to simulation results. They are associated with Simulation ChildFolder
objects.
Simulation Feature objects are available in Atoll documents based on the templates:
◼

UMTS HSPA

◼

LTE

◼

CDMA 2000 1xRTT 1xEV-DO

◼

WiMAX 802.16e

◼

TD-SCDMA

◼
◼

The Simulation Feature object provides the following properties and methods:
Name

12.5.1

Description

Source

Returns the associated Simulation ChildFolder object.

Statistics

Returns a TabularData object holding the results as presented in the
"Statistics" property page of the simulation property sheet.

Cells

Returns a TabularData object holding the results as presented in the
"Cells" property page of the simulation property sheet.

Sites

Returns a TabularData object holding the results as presented in the
"Sites" property page of the simulation property sheet.

Mobiles

Returns a TabularData object holding the results as presented in the
"Mobiles" property page of the simulation property sheet.

Results

Returns a TabularData object holding the required results, depending
on the parameter passed to this method.

Attributes

How to Access Simulation Feature Objects
The ObjectKind property for the Simulation ChildFolder objects is:

© 2022 Forsk. All Rights Reserved.

157

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

{095C5D90-96F1-4BA8-85BB-B2F990AC2DD9}
Simulation ChildFolder objects are child of Simulation Groups ChildFolder objects.
Simulation Feature objects are available through the Dispatch property of Simulation ChildFolder objects:
Dim oSimulation
Dim oSimulationChildFolder
Set oSimulation = oSimulationChildFolder.Dispatch

12.5.2

Source
Returns the associated Simulation ChildFolder object.
HRESULT get_Source(IDispatch **ppSource);
Parameters
[out] ppSource: Address of the IDispatch interface pointer used to return the associated Simulation ChildFolder
object.
Remarks
For a Simulation Feature object returned by a Simulation Group Feature object method, there is no associated
ChildFolder object, and the behaviour of this method is undefined.

12.5.3

Statistics
Returns a TabularData object holding the results as presented in the "Statistics" property page of the simulation
property sheet.
HRESULT get_Statistics(ITabularData **ppTable);
Remarks
This method is not implemented, except for UMTS simulations. Please don’t use this method unless you’re working
with a UMTS simulation.

12.5.4

Cells
Returns a TabularData object holding the results as presented in the "Cells" property page of the simulation property
sheet.
HRESULT get_Cells(ITabularData **ppResults);
Parameters
[out] ppResults: Address of the ITabularData interface pointer used to return the "Cells" simulation results.

158

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

12.5.5

Sites
Returns a TabularData object holding the results as presented in the "Sites" property page of the simulation property
sheet.
HRESULT get_Sites(ITabularData **ppResults);
Parameters
[out] ppResults: Address of the ITabularData interface pointer used to return the "Sites" simulation results.

12.5.6

Mobiles
Returns a TabularData object holding the results as presented in the "Mobiles" property page of the simulation
property sheet.
HRESULT get_Mobiles(ITabularData **ppResults);
Parameters
[out] ppResults: Address of the ITabularData interface pointer used to return the "Mobiles" simulation results.
Remarks
The content of the TabularData object returned depends on the "Information to retain" setting of the simulation. In
particular, when the information to retain is "No Information About Mobiles", the number of mobiles returned in the
TabularData object is 0.
All mobiles are returned, the focus zone is not taken into account.

12.5.7

Results
Returns a TabularData object holding the required results.
HRESULT get_Results(enum AtoSimulationResultsType aType, ITabularData **ppResults);
Parameters
[in] aType : An AtoSimulationResultsType enumeration value, used to specify the simulation results to return.
Enumeration values are:

atoSimulationResultsStatistics

0

Returns a TabularData object holding the results as presented
in the "Statistics" property page of the simulation property
sheet.

atoSimulationResultsCells

1

Returns a TabularData object holding the results as presented
in the "Cells" property page of the simulation property sheet.

atoSimulationResultsSites

2

Returns a TabularData object holding the results as presented
in the "Sites" property page of the simulation property sheet.

© 2022 Forsk. All Rights Reserved.

159

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

atoSimulationResultsMobiles

3

Returns a TabularData object holding the results as presented
in the "Mobiles" property page of the simulation property
sheet.

atoSimulationResultsMobilesOnFocusZ
one

4

Returns a TabularData object holding the results as presented
in the "Mobiles" property page of the simulation property sheet
and filtered on the focus zone.

atoSimulationResultsGsmSubCells

10
0

Returns a TabularData object holding the results as presented
in the "SubCells" property page of the simulation property
sheet.

atoSimulationResultsGsmTRXs

10
1

Returns a TabularData object holding the results as presented
in the "TRXs" property page of the GSM simulation property
sheet.

[out] ppResults: Address of the ITabularData interface pointer used to return the simulation results.

12.6 Simulation Group Feature Object
Simulation Group Feature objects give access to group of simulations properties. ATL documents can contain zero,
one, or more group of simulations. In turn, simulation groups can contain zero or more simulations. They are located
in the "Simulations" folder of the ATL document. Simulation Group Feature objects are associated with group of
simulations ChildFolder objects of an ATL document.
Simulation Group Feature objects are available in ATL documents based on the templates:
◼

UMTS HSPA

◼

LTE

◼

CDMA 2000 1xRTT 1xEV-DO

◼

WiMAX 802.16e

◼

TD-SCDMA

The Simulation Group Feature object provides the following properties and methods:
Name

12.6.1

Description

Attributes

Source

Returns the associated Simulation Group ChildFolder object.

Statistics

Returns a TabularData object holding the statistics of the simulation group.

MeanSimulation

Returns a Simulation Feature object giving access to the average simulation properties.

StdDevSimulation

Returns a Simulation Feature object used to access the standard deviation simulation properties.

How to Access Simulation Group Feature Objects
The ObjectKind property for Group of Simulations folder is:
{AF5E2B98-1D54-48FA-89C5-8BFA2936ABF2}
Sample code to access Simulation Group Feature objects:
’ Returns ’True’ if there is at least one group of simulations in ’doc’,
’ ’False’ otherwise
’ Params:
’

160

[in] doc : Atoll document object

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

’

[out] array: Array of simulation group feature objects

Private Function SimulationGroupFeatureObjects(doc, ByRef array)
Const OBJECTKIND_SIMULATIONS = "{CDDF1E1D-1963-4D80-A057-D23A19570984}"
Const
OBJECTKIND_SIMULATIONGROUP
8BFA2936ABF2}"

=

"{AF5E2B98-1D54-48FA-89C5-

Const atoData = 0
Dim oSimulations
’ oSimulations is the "Simulations" ChildFolder object
On Error Resume Next
Set oSimulations = doc.GetRootFolder(atoData).Item(OBJECTKIND_SIMULATIONS)
If Err Then
’ There is no "Simulations" folder
On Error Goto 0
SimulationGroupFeatureObjects = False
Exit Function
End If
On Error Goto 0
If oSimulations.Count = 0 Then
SimulationGroupFeatureObjects = False
Exit Function
End If
Redim array(oSimulations.Count - 1)
Dim oSimulationGroup
Dim n
n = 0
’ "Simulation Group" ChildFolder objects are located
’ in the "Simulations" folder
For Each oSimulationGroup In oSimulations
If oSimulationGroup.ObjectKind = OBJECTKIND_SIMULATIONGROUP Then
Set array(n) = oSimulationGroup.Dispatch
n = n + 1
End If
Next
SimulationGroupFeatureObjects = True
End Function

12.6.2

Source
Returns the associated Simulation Group ChildFolder object.
HRESULT get_Source(IDispatch **ppSource);
Parameters
[out] ppSource: Address of the IDispatch interface pointer used to return the associated Simulation Group
ChildFolder object.

© 2022 Forsk. All Rights Reserved.

161

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

12.6.3

Statistics
Returns a TabularData object holding the statistics of the simulation group.
HRESULT get_Statistics(ITabularData **ppTable);
Remarks
This method is not implemented. Please don’t use this method.

12.6.4

MeanSimulation
Returns a Simulation Feature object giving access to the average simulation properties.
HRESULT get_MeanSimulation(ISimulation **ppMeanValues);
Parameters
[out] ppMeanValues: Address of the ISimulation interface pointer used to return the Simulation Feature object
corresponding to the average simulation.
Remarks
The returned Simulation Feature object is not associated with a particular ChildFolder object in the Atoll document.
An error is returned when no simulation in the simulation group has converged. The average simulation is not
available when no simulation in the simulation group has converged.
An error is returned when the simulation group has not been calculated yet, for instance when the simulation group
has been created with the check box "Execute Later" set.

12.6.5

StdDevSimulation
Returns a Simulation Feature object used to access the standard deviation simulation properties.
HRESULT get_StdDevSimulation(ISimulation **ppStdDevValues);
[out] ppStdDevValues: Address of the ISimulation interface pointer used to return the Simulation Feature object
corresponding to the standard deviation simulation.
Remarks
The returned Simulation Feature object is not associated with a particular ChildFolder object in the Atoll document.
An error is returned when no simulation in the simulation group has converged. The standard deviation simulation
is not available when no simulation in the simulation group has converged.
An error is returned when the simulation group has not been calculated yet, for instance when the simulation group
has been created with the check box "Execute Later" set.
An error is returned when the ATL document is based on the GSM, 5G NR, LTE, WiMAX 802.16e templates. The
standard deviation simulation is not available for GSM, 5G NR, LTE and WiMAX.

162

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

12.6.6

Accessing Mobiles, Cells, Sites, for Simulations and Simulation Groups
Here is a sample macro used to display the various available results for simulation groups and simulations in the
Atoll event viewer, for the active document:
’ Returns ’True’ if there is at least one group of simulation in ’doc’,
’ ’False’ ’ otherwise
' Params:
'

[in] doc : Atoll document object

'

[out] array: Array of simulation group feature objects

Private Function SimulationGroupFeatureObjects(doc, ByRef array)
Const OBJECTKIND_SIMULATIONS = "{CDDF1E1D-1963-4D80-A057-D23A19570984}"
Const
OBJECTKIND_SIMULATIONGROUP
8BFA2936ABF2}"

=

"{AF5E2B98-1D54-48FA-89C5-

Const atoData = 0
Dim oSimulations
' oSimulations is the "Simulations" ChildFolder object
On Error Resume Next
Set oSimulations = doc.GetRootFolder(atoData).Item(OBJECTKIND_SIMULATIONS)
If Err Then
' There is no "Simulations" folder
On Error Goto 0
SimulationGroupFeatureObjects = False
Exit Function
End If
On Error Goto 0
If oSimulations.Count = 0 Then
SimulationGroupFeatureObjects = False
Exit Function
End If
Redim array(oSimulations.Count - 1)
Dim oSimulationGroup
Dim n
n = 0
’ "Simulation Group" ChildFolder objects are located
’ in the "Simulations" folder
For Each oSimulationGroup In oSimulations
If oSimulationGroup.ObjectKind = OBJECTKIND_SIMULATIONGROUP Then
Set array(n) = oSimulationGroup.Dispatch
n = n + 1
End If
Next
SimulationGroupFeatureObjects = True
End Function
’ Returns 'True' if there is at least one simulation in 'oSimulationGroup',
’ ’False’ otherwise
’ Params:
’

[in] oSimulationGroup : Group of simulations ChildFolder object

’

[out] array: Array of simulation feature objects

© 2022 Forsk. All Rights Reserved.

163

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

Dim oSimulationGroup
Dim n
n = 0
’ "Simulation Group" ChildFolder objects are located
’ in the "Simulations" folder
For Each oSimulationGroup In oSimulations
If oSimulationGroup.ObjectKind = OBJECTKIND_SIMULATIONGROUP Then
Set array(n) = oSimulationGroup.Dispatch
n = n + 1
End If
Next
SimulationGroupFeatureObjects = True
End Function
’ Returns 'True' if there is at least one simulation in 'oSimulationGroup',
’ ’False’ otherwise
’ Params:

164

’

[in] oSimulationGroup : Group of simulations ChildFolder object

’

[out] array: Array of simulation feature objects

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

End If
If IsArray(values(c)) Then
values(c) = "(Array)"
End If
Next
LogMessage Join(values, ";")
Next
End Sub
Private Sub DumpSimulation(oSimulation, name)
LogMessage name
LogMessage "Cells..."
DumpTable(oSimulation.Cells)
LogMessage "End Cells."
LogMessage "Sites..."
DumpTable(oSimulation.Sites)
LogMessage "End Sites."
LogMessage "Mobiles..."
DumpTable(oSimulation.Mobiles)
LogMessage "End Mobiles."
LogMessage "End " & name & "."
End Sub
Public Sub DumpSimulationGroupAttributes
Dim f()
Dim arraySimulations()
If (SimulationGroupFeatureObjects(ActiveDocument, f) = False) Then
LogMessage "No Group of Simulations found in the document."
Exit Sub
End If
Dim oFeature
For Each oFeature In f
LogMessage "Group of Simulations [" & oFeature.Source.Name & "]..."
Dim average
Dim stddev
On Error Resume Next
Set average = oFeature.MeanSimulation
If Err Then
’ The average simulation is not available when
’ no simulation has converged in the group.
LogMessage "The average simulation is not available."
On Error Goto 0
Else
On Error Goto 0
DumpSimulation average, "Average Simulation"
On Error Resume Next
Set stddev = oFeature.StdDevSimulation
If Err Then
' The standard deviation simulation is not available
’ for LTE and WiMAX projects.
On Error Goto 0

© 2022 Forsk. All Rights Reserved.

165

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

Else
On Error Goto 0
DumpSimulation stddev, "Stddev Simulation"
End If
End If
' Dump all simulation in the group of simulations
Dim oSimulationGroup
Set oSimulationGroup = oFeature.Source
If (SimulationFeatureObjects(oSimulationGroup,
False) Then

arraySimulations)

=

LogMessage "There are no simulations in this group of simulations."
Else
Dim oSimulation
For Each oSimulation In arraySimulations
DumpSimulation oSimulation, oSimulation.Source.Name
Next
End If
LogMessage "End Group of Simulations."
Next
End Sub

12.7 Multi-RAT Simulation Group Feature Object
Multi-RAT Simulation Group Feature objects are available in Atolldocuments based on the templates:
◼

3GPP Multi-RAT

◼

3GPP2 Multi-RAT

◼

5G Multi-RAT

3GPP Multi-RAT Simulation Group Feature objects are similar to Simulation Group Feature objects available in
single-RAT documents, except some methods in 3GPP Multi-RAT Simulation Group Feature objects require the
name of the technology to be specified.
Multi-RAT Simulation Group Feature objects provide the following properties and methods:
Name

12.7.1

Description

Source

Returns the associated Simulation Group ChildFolder object.

Statistics

Returns a TabularData object holding the statistics of the simulation group
for the specified technology.

MeanSimulation

Returns a Simulation Feature object giving access to the average simulation
properties for the specified technology.

StdDevSimulation

Returns a Simulation Feature object used to access the standard deviation
simulation properties for the specified technology.

Source
Returns the associated Multi-RAT Simulation Group ChildFolder object.
HRESULT get_Source(IDispatch **ppSource);

166

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

Parameters
[out] ppSource: Address of the IDispatch interface pointer used to return the associated 3GPP Multi-RAT Simulation
Group ChildFolder object.

12.7.2

Statistics
Returns a TabularData object holding the statistics of the simulation group for the specified technology.
HRESULT get_Statistics(const BSTR bstrTechno, ITabularData **ppTable);
Remarks
This method is currently not applicable. Please do not use this method.

12.7.3

MeanSimulation
Returns a Simulation Feature object giving access to the average simulation properties for the specified technology.
HRESULT get_MeanSimulation(
const BSTR bstrTechno,
ISimulation **ppMeanValues
);
Parameters
[in] bstrTechno: A string used to specify the requested technology. Available values are "GSM", "UMTS", "LTE",
"1xRTT" or "5G".
[out] ppMeanValues: Address of the ISimulation interface pointer used to return the Simulation Feature object
corresponding to the average simulation.
Remarks
The returned Simulation Feature object is not associated with a particular ChildFolder object in the ATL document.
An error is returned when no simulation in the simulation group has converged. The average simulation is not
available when no simulation in the simulation group has converged.
An error is returned when the simulation group has not been calculated yet, for instance when the 3GPP simulation
group has been created with the check box "Execute Later" set.

12.7.4

StdDevSimulation
Returns a Simulation Feature object used to access the standard deviation simulation properties for the specified
technology.
HRESULT get_StdDevSimulation(
const BSTR bstrTechno,
ISimulation **ppStdDevValues
);
[in] bstrTechno: A string used to specify the requested technology. Available values are "GSM", "UMTS", "LTE",
"1xRTT", or "5G".
[out] ppStdDevValues: Address of the ISimulation interface pointer used to return the Simulation Feature object
corresponding to the standard deviation simulation.

© 2022 Forsk. All Rights Reserved.

167

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

Remarks
The returned Simulation Feature object is not associated with a particular ChildFolder object in the ATL document.
An error is returned when no simulation in the simulation group has converged. The standard deviation simulation
is not available when no simulation in the simulation group has converged.
An error is returned when the simulation group has not been calculated yet, for instance when the simulation group
has been created with the check box "Execute Later" set.
An error is returned when the ATL document is based on the GSM, 5G NR, LTE, WiMAX 802.16e templates. The
standard deviation simulation is not available for GSM, 5G NR, LTE and WiMAX.

12.8 GSM Interference Matrix Feature Object
GSM Interference Matrix Feature objects give access to GSM interference matrices. A document can contain zero,
one, or more interference matrices. They are located in the "Interference matrices" folder of the document.
GSM Interference Matrix Feature objects are available in documents based on the GSM GPRS EDGE template.
GSM Interference Matrix Feature objects provide the following properties and methods:
Name
Source

Description

Attributes

Returns the "Interference Matrices" ChildFolder object.

Type: ChildFolder
object
Access:Read

Load

Loads an interference matrix.

CompleteScopeInfo

Completes scope information.

Scope

Returns the scope of the interference matrix.

Type: Tabular Data
object
Access:Read

Active

Returns the interference matrix active state.

Type: Boolean
Access:Read/Write

Active

Sets the interference matrix active state.

Type: Boolean
Access:Read/Write

Type

Returns the type of the interference matrix.

Type: Integer
Access:Read/Write

Type

Sets the type of the interference matrix.

Type: Integer
Access:Read/Write

BasedOnTraffic

Type: Boolean
Access:Read/Write

BasedOnTraffic

Type: Boolean
Access:Read/Write

Resolution

Returns the resolution of the interference matrix calculation. Type: Integer
Access:Read/Write

Resolution

Sets the resolution of the interference matrix calculation.

Type: Integer
Access:Read/Write

StdDev

Returns the interference matrix standard deviation.

Type: Single
Access:Read/Write

StdDev

Sets the interference matrix standard deviation.

Type: Single
Access:Read/Write

InfoQuantityIndicator

168

Returns the interference matrix information quantity indicator.

Type: Integer
Access:Read/Write

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

Name
InfoQuantityIndicator

Description
Sets the interference matrix information quantity indicator.

Attributes
Type: Integer
Access:Read/Write

CdfTab

Returns the interference matrix CDF tabular data.

Type: Tabular Data
object
Access:Read

12.8.1

How to Access GSM Interference Matrix Feature Objects
The ObjectKind property for an Interference Matrix ChildFolder objects is:
{5144E1F9-E539-4F8C-BC0C-49A11C6389E8}
Interference Matrix ChildFolder objects are children of the folder named "Interference Matrices".
GSM Interference Matrix Feature objects are available through the Dispatch property of Interference Matrix
ChildFolder objects:
Dim oInterferenceMatrix
Dim oInterferenceMatricesChildFolder
Set oInterferenceMatricesChildFolder
= oDocument.GetRootFolder(atoData).Item("Interference Matrices")
Set oInterferenceMatrix = oInterferenceMatricesChildFolder.Dispatch

12.8.2

Source
Returns the "Interference Matrices" ChildFolder object.
HRESULT get_Source(IDispatch **ppSource);
Parameters
[out] ppSource: Address of the IDispatch interface pointer used to return the "Interference Matrices" ChildFolder
object.

12.8.3

Load
Loads an interference matrix.
HRESULT Load();

Remarks
This method must be called before any access to an interference matrix.

12.8.4

CompleteScopeInfo
Completes scope information.
HRESULT CompleteScopeInfo();

© 2022 Forsk. All Rights Reserved.

169

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

Remarks
This method must be called after transmitters are added to the scope.

12.8.5

Scope
Returns the scope of the interference matrix.
HRESULT get_Scope(ITabularData **ppTable);
Parameters
[out] ppTable : The address of the ITabularData interface pointer used to return the scope of the interference matrix.
Remarks
The scope of an interference matrix is a Tabular Data object containing a mapping from the row identifier for a
transmitter to the following information:
The coverage percentage as victim, and as interferer. The default values are 100.
The BSIC and BCCH when the interference matrix information was collected. The default values are -1.

12.8.6

Active
Sets the active state.
HRESULT put_Active( VARIANT_BOOL isActiveVal);
Parameters
[in] isActiveVal : The VARIANT_BOOL value used to specify the active state of the interference matrix.
Remarks
An active interference matrix is used by the automatic frequency planning process when the interference matrix
scope intersects the automatic frequency planning scope.

12.8.7

Active
Returns the active state.
HRESULT get_Active(VARIANT_BOOL *pIsActiveVal);
Parameters
[out] pIsActiveVal : Address of the VARIANT_BOOL used to return the active state of the interference matrix.
Remarks
An active interference matrix is used by the automatic frequency planning process when the interference matrix
scope intersects the automatic frequency planning scope.

170

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

12.8.8

Type
Returrns the interference matrix type.
HRESULT get_Type(IM_TYPE *pImTypeVal);
Parameters
[out] pImTypeVal : Address of the enumeration value used to return the interference matrix type.
Remarks:
Available enumeration values used to specify an interference matrix type are:
◼

1 : PROPAG_IM
For interference matrices based on propagation data. Their reliability depends on the accuracy and
correctness of network and geogrpahical data.

◼

2 : OMC_RESELCTION_IM
For interference matrices based on reselection statistics from the OMC. Their reliability is usually low due to
the difference between the locations where mobiles are switched on and where they are actually used to
access the network.

◼

3 : OMC_SIMPLE_HO_IM
Their reliability is usually low due to the fact that interference is measured only among existing neighbours,
which might not be correctly assigned. This type of interference matrix is highly correlated with the neighbour
relations. It can be used to remove excessive neighbour constraints. However, it cannot be used to complete
any missing neighbour information. Another reason for low reliability is that interference information is
collected from handover regions only, instead of from the service area.
4 : OMC_NEI_EXT_HO_IM
Interference matrices based on RXLEV statistics from the OMC (neighbours, as well as temporary
neighbours).
They can be a very good source of interference information if they are statistically stable because they are not
sensitive to data errors. On the other hand, they have many disadvantages, such as:
Transmitters with the same BSIC and BCCH cannot be differentiated.
Transmitters having the same BCCH will never have an interference entry.
Information is lost when more than 6 interferers exist at any location.
If many interferers share the same BCCH, they increase each other’s interference levels.
HCS layers can cause problems because there are more servers at any point, macro layer servers are stronger,
or a correction margin might be introduced for some equipment.
This type of interference matrix can be created using an extended neighbours list.

◼

5 : TEST_MOBILE_DATA_IM
Interference matrices based on test mobile data.
Reliability can be low because usually the test mobile data sampling zone and the traffic model are not related.
Secondly, the measurements are carried out for existing neighbours only.

◼

6 : CW_IM
Interference matrices based on CW measurements.
Their reliability can be low because the measurements usually do not reflect the traffic model. However, this
source of information can be very reliable for a subset of transmitters that were properly scanned. Carrying
out CW measurements is expensive which means that the collected information is often partial or out of date.

◼

7 : SCAN_DATA_IM
Interference matrices based on scan data drive tests.
They are highly reliable and an excellent source of information, but are not useful in a radio planning tool
because no information is available to map transmitters to the received signals at any pixel.

◼

8 : UPPER_BOUND_ENTRY_COLLECTION
Upper bound interference matrix.

© 2022 Forsk. All Rights Reserved.

171

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

The source of this type of interference matrix is not defined. It can be based on user experience. The
information contained in this interference matrix is used as an upper limit, i.e., if this interference matrix
indicates a certain level of interference, it should not be exceeded because other interference matrices show
higher interference. If an upper bound interference matrix does not contain information about an entry, it is
ignored.
◼

9 : LOWER_BOUND_ENTRY_COLLECTION
Lower bound interference matrix.
The source of this type of interference matrix is not defined. It can be based on user experience. The
information contained in this interference matrix is used as a lower limit. This type of interference matrix can
be very useful because you can edit entries in this interference matrix, and be certain that the interference will
be at least as high as the value you entered. This approach can be used when user experience shows a certain
level of interference which the radio network planning tool is unable to calculate.

12.8.9

Type
Sets the interference matrix type.
HRESULT put_Type(IM_TYPE imTypeVal);
Parameters
[in] imTypeVal : The enumeration value used to specify the interference matrix type.

12.8.10

BasedOnTraffic
Returns based on traffic.
HRESULT get_BasedOnTraffic(VARIANT_BOOL *pbBasedOntraf);
Parameters
[out] pbBasedOntraf: The address of the VARIANT_BOOL value used to return based on traffic.
Remark
This method only makes sense for interference matrices of type PROPAG_IM. In that case, the return value indicates
whether the interference matrix takes into account non uniform traffic distributions within each cell.

12.8.11

BasedOnTraffic
Sets based on traffic.
HRESULT put_BasedOnTraffic(VARIANT_BOOL bBasedOntraf) ;
Parameters
[in] bBasedOntraf : The VARIANT_BOOL value used to specify based on traffic.

172

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

12.8.12

Resolution
Returns the resolution of the interference matrix calculation.
HRESULT get_Resolution(long *piResolutionParamVal);
Parameters
[out] piResolutionParamVal : The address of the long integer used to return the resolution of the interference matrix
calculation.
Remarks
For interference matrices of type PROPAG_IM, the return value is the resolution of the interference matrix
calculation.
For interference matrices of type TEST_MOBILE_DATA_IM, CW_IM, or SCAN_DATA_IM, the return value is the
number of measurements per calculation point in the interference matrix.

12.8.13

Resolution
Sets the resolution of the interference matrix calculation.
HRESULT put_Resolution(long iResolutionParamVal) ;
Parameters
[in] :iResolutionParamVal : The long integer used to specify the resolution of the interference matrix calculation.

12.8.14

StdDev
Returns the interference matrix standard deviation.
HRESULT get_StdDev(float *pfStdDevParamVal);
Parameters
[out] pfStdDevParamVal: Address of the single precision floating point value used to return the interference matrix
standard deviation.
Remarks
For interference matrices of type PROPAG_IM, the return value is the standard deviation of the propagation model
used in the interference matrix calculation.
For interference matrices of type TEST_MOBILE_DATA_IM, CW_IM, or SCAN_DATA_IM, the return value is the
standard deviation of the measurement equipment.

12.8.15

StdDev
Sets the interference matrix standard deviation.
HRESULT put_StdDev(float fStdDevParamVal);

© 2022 Forsk. All Rights Reserved.

173

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

Parameters
[in] fStdDevParamVal: The single precision floating point value used to specify the interference matrix standard
deviation.

12.8.16

InfoQuantityIndicator
Returns the information quantity indicator.
HRESULT get_InfoQuantityIndicator(long *piInfoQuantIndic);
Parameters
[out] pilInfoQuantIndic: Address of the long integer used to return the information quantity indicator.
Remarks
For interference matrices of type PROPAG_IM, the return value is an information about the interference matrix
calculation parameters.
For interference matrices of type TEST_MOBILE_DATA_IM, CW_IM, or SCAN_DATA_IM, the return value is the
number of calculation points per victim.
For interference matrices of type OMC_RESELCTION_IM, OMC_SIMPLE_HO_IM, or OMC_NEI_EXT_HO_IM, the return
value is the number of days since the OMC statistics were collected.

12.8.17

InfoQuantityIndicator
Sets the information quantity indicator.
HRESULT put_fInfoQuantityIndicator(long iInfoQuantIndic) ;
Parameters
[in] ilInfoQuantIndic : The long integer used to specify the information quantity indicator.

12.8.18

CdfTab
Returns the interference matrix CDF tabular data.
HRESULT get_CdfTab(ITabularData **ppTable) ;
Parameters
[out] ppTable : Address of the ITabularData interface pointer used to return the inteference matrix tabular data.
Remarks
The structure of the Tabular Data object returned is:

174

◼

Column 1 : Row identifier of the victim transmitter

◼

Column 2 : Row identifier of the interferer transmitter

◼

Column 3 : A maximum loss value

◼

Column 4 : A safe array of type VT_ARRAY|VT_R4, VT_ARRAY|VT_R8, or VT_VARIANT having 1 dimension and
containing the C/I values of the CDF.

◼

Column 5 : A safe array of type VT_ARRAY|VT_R4, or VT_ARRAY|VT_R8, or VT_VARIANT having 1 dimension
and containing the probability values of the CDF.

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

AT350_TAG_E3

Performance considerations
When deleting elements, try to always delete the last element first.
When editing an existing element, do not change columns 1, 2, or 3.

© 2022 Forsk. All Rights Reserved.

175

Atoll 3.5.0 Task Automation Guide
Chapter 12: ChildFolder Feature Objects

176

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

13 Document Commands
The Atoll API enables executing commands on Atoll documents.
Commands are invoked by their names, which must be known in advance.
The following commands are available for all Atoll documents:
Name

Description

Attributes

IMPORTXML

This command performs the same task as the Atoll "File > Data Exchange > Version ≥:
XML File Import..." main menu command.
2.7.1

EXPORTXML

This command performs the same task as the Atoll "File > Data Exchange > Version ≥:
XML File Export..." main menu command.
2.7.0

APPENDTABLECOLUMN

This command adds a new column to a database table. This command is Version ≥:
only available for Atoll documents that are not connected to databases.
2.8.0

ARCHIVETODATABASE

Archives a project to the database.

REFRESHFROMDATABASE

Performs a refresh from the database and optionally generates a report that Version ≥:
summarises the differences between the data before and after refresh.
3.4.0

IMPORTVECTORFILE

Imports a vector file.

Version ≥:
3.4.1

IMPORTRASTERFILE

Imports a raster file.

Version ≥:
3.4.1

Version ≥:
3.2.1

The following commands are available for radio network technology documents:
Name

Description

Attributes

CALCULATEPOINTS

This command returns signal levels in dBm for a given set of points and a Version ≥:
set of transmitters.
2.6.0

IMPORTTESTMOBILEDATA

This command imports a set of drive test data files into an ATL document. Version ≥:
2.6.1

RUNNEIGHBOURALLOCATION

Performs neighbour allocation on a GSM network.

RUNINTERTECHNOLOGYNEIGHBOURALLOCATION

Performs inter technology neighbour allocation on a GSM or UMTS network. Version ≥:
2.6.1

RUNINTRACARRIERNEIGHBOURALLOCATION

Performs intra carrier neighbour allocation on a UMTS network.

Version ≥:
2.6.1

RUNINTERCARRIERNEIGHBOURALLOCATION

Performs inter carrier neighbour allocation on a UMTS network.

Version ≥:
2.6.1

CLONESTUDY

This command clones a coverage prediction.

Version ≥:
2.7.0

DUPLICATESTUDY

This command duplicates a coverage prediction.

Version ≥:
2.7.0

COMPARESTUDY

This command compares two coverage predictions.

Version ≥:
2.7.0

CALCULATEEQUIPMENTLOSSES

This command calculates equipment losses and noise figure for all trans- Version ≥:
mitters in the document transmitters folder.
2.7.0

CALCULATEREPEATERS

This command calculates propagation losses, azimuth, mechanical tilt, or Version ≥:
gains for all repeaters in the document transmitters folder.
2.7.0

CALCULATEREMOTEANTENNAS

This command calculates propagation losses, azimuth, mechanical tilt, or Version ≥:
gains for all remote antennas in the document transmitters folder.
2.7.0

© 2022 Forsk. All Rights Reserved.

Version ≥:
2.6.1

177

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Name

Description

Attributes

EXPORTACTIVESETANALYSIS

This command exports the active set analysis to text files.

Version ≥:
2.7.0

CALCULATEPOINTSECI0

This command returns Ec/I0 values in dB for a given set of points and a set Version ≥:
of transmitters.
2.7.0

RUNALLCARRIERSALLOCATION

Performs all carriers allocation on a TD-SCDMA network.

Version ≥:
2.8.1

RUNMASTERCARRIERALLOCATION

Performs master carrier allocation on a TD-SCDMA network.

Version ≥:
2.8.1

MWRUN

This command runs Microwave analysis for a given set of links.

Version ≥:
2.6.1

EXPORTMAPWINDOW

Exports a region of the map window as an image

Version ≥:
3.1.0

IMPORTPLANETDATAFILE

Imports a planet data file

Version ≥:
3.1.0

EXPORTMWLINKANALYSISPROFILEPICTURE

Exports a microwave link analysis profile picture to a Windows bitmap file. Version ≥:
3.1.0

MWCALCULATEPROFILES

Calculates Microwave profile files.

Version ≥:
3.3.0

Input Parameters
Commands may have input parameters. The types and names of input parameters are unique and are specific to
each command. PropertyContainer objects are used to hold input parameters.
Results
Commands may return results. Results are specific to each command. The results of a command are returned using
a PropertyContainer object. Each result has a unique name and an associated type.

13.1 How to Invoke a Document Command
The steps to invoke a command are the same for all commands.
Sample script invoking an Atoll document command:
Public Function ExecuteCommand(oDocument, strCommand, oParameters)
Set ExecuteCommand = oDocument.InvokeCommand(strCommand, oParameters)
End Function
oDocument is an Atoll Document Object. It can be the active document, or any document in the Documents
collection.
strCommand is a string holding the Atoll command name.
oParameters is an Atoll PropertyContainer object used to hold the parameters specific to strCommandName. It can
be a PropertyContainer object holding the default parameters obtained with the GetCommandDefaults method
available on the IDocument4 interface.
The ExecuteCommand function returns the command results as a PropertyContainer object.

13.2 IMPORTXML
This command performs the same task as the Atoll "File > Data Exchange > XML File Import..." main menu
command.

178

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Version
≥ 2.7.1
Input Parameters
Name
PATH

Description

Attributes

The PATH input parameter is used to specify the source folder containing Version ≥: 2.7.1
XML files to import.
Type: String

Default Parameters
None. GetCommandDefaults on IDocument4 interface for the command IMPORTXML returns an empty
PropertyContainer object.
Results
None. The data in the Atoll document are updated with the content of XML files.

13.3 EXPORTXML
This command performs the same task as the Atoll "File > Data Exchange > XML File Export..." main menu
command.
Version
≥ 2.7.1
Input Parameters
Name
PATH

Description

Attributes

The PATH input parameter is used to specify the destination folder where Version ≥: 2.7.1
XML files will be exported.
Type: String

Default Parameters
None. GetCommandDefaults for the command EXPORTXML returns an empty PropertyContainer object.
Results
None. The data in the Atoll document are exported to a set of XML files.

13.4 APPENDTABLECOLUMN
This command adds a new column to a database table. This command is only available for Atoll documents that
are not connected to databases.
Version
≥ 2.8.0

© 2022 Forsk. All Rights Reserved.

179

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Input Parameters
Name

Description

Attributes

TABLE

The TABLE input parameter is used to specify a table name. The new col- Version ≥: 2.8.0
umn will be added to the table named TABLE.
Type: String

NAME

The NAME input parameter is used to specify the database name of the Version ≥: 2.8.0
new column to add to the TABLE table. The value is case insensitive and Type: String
must not include spacesand dot characters.

LEGEND

The LEGEND input parameter is used to specify the display name of the Version ≥: 2.8.0
new column to add to the TABLE table. The value is case sensitive and Type: String
spaces characters are allowed.

TYPE

The TYPE input parameter is used to specify the data type of the new col- Version ≥: 2.8.0
umn to add to the table. Valid values are: 0=Text; 1=Short integer; 2=Long Type: Integer
integer; 3=Single; 4=Double; 5=True/False; 6=Date/Time; 7=Currency;

SIZE

The SIZE input parameter is used to specify the size, in bytes, for a column Version ≥: 2.8.0
of type 0 (Text). The SIZE input parameter is specific to the text data type. Type: Integer

DEFAULT

The DEFAULT input parameter is used to specify the default value of the
new column. The default value is the column value for new rows, when
the column value is not set explicitly. When the DEFAULT input parameter
is not specified, the default value for the new column is Null (VT_NULL).
The type of the DEFAULT input parameter value must match the data type
of the new column, as specified by the TYPE input parameter.

Version ≥: 2.8.0
Type: Null, String, Integer, Boolean, Single,
Double, Currency, or
Date

GROUP

The GROUP input parameter is used to specify the name of the group the Version ≥: 2.8.0
new column belongs to.
Type: String

CHOICELIST

The CHOICELIST input parameter is used to specify the list of possible Version ≥: 2.8.0
values for a new column of type 0 (Text). The CHOICELIST input param- Type: Array of Strings
eter is specific to text columns. The CHOICELIST parameter may be used
by Atoll to display preferred values to the user, for instance in a combobox
control.

DISPLAY_TYPE

The DISPLAY_TYPE input parameter is used to specify whether the new Version ≥: 3.4.0
column is read-only and/or hypertext.
Type: Integer
◼ 0: Not read-only and not hypertext.
◼ 1: Read-only and not hypertext.
◼ 2: Not read-only and hypertext.
◼ 3: Read-only and hypertext.

CHOICE_TYPE

The CHOICE_TYPE input parameter is used to specify whether a
CHOICELIST input is restricted to the values defined in the choice list.

Version ≥: 3.4.0
Type: Integer

◼ True: The choice list is not restricted.
◼ False: The choice list is restricted to the defined values.

Default Parameters
The TABLE, NAME, LEGEND, and TYPE input parameters have no default values, they must be specified. Default
values for other input parameters are returned by GetCommandDefaultsfor the command APPENDTABLECOLUMN:
Input Parameter Name

Default Value

LEGEND

Empty

SIZE

10 bytes

DEFAULT

Null

GROUP

Empty

CHOICELIST

Empty

DISPLAY_TYPE

0

CHOICE_TYPE

False

Results
None. Upon successful completion the new column is added to the table.

180

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

13.5 IMPORTVECTORFILE
Imports a vector file.
Version
≥ 3.4.1
Input Parameters
Name
PATH

Description
The full path of the vector file (.shp, .mif, .tab, .agd...) to be imported.

Attributes
Version ≥: 3.4.1
Type: String

DESTINATION

The ChildFolder object where the file should be imported.

EMBED

If true, the file content is embedded into the .ATL file. This parameter is Version ≥: 3.4.1
optional. By default, its value is False.
Type: Integer

DENSITY

If true, the file content is interpreted as a density; otherwise as a value. Version ≥: 3.4.1
This parameter is optional. By default, its value is False.
Type: Integer

CSCODE

The code of the projection coordinate system of the document. This
parameter is optional.

FIELD

Version ≥: 3.4.1

Version ≥: 3.4.1
Type: Integer

The field of the vector file to be interpreted as a value or as a density. This Version ≥: 3.4.1
parameter is optional. By default, its value is VT_NULL.
Type: String

Results
None. When successful, the vector file is imported in the destination document node.

13.6 IMPORTRASTERFILE
Imports a raster file.
Version
≥ 3.4.1
Input Parameters
Name
PATH

Description
The full path of the raster file (.bil, .bmp, .tif...) to be imported.

Attributes
Version ≥: 3.4.1
Type: String

DESTINATION

The ChildFolder object where the file should be imported.

Version ≥: 3.4.1

EMBED

If true, the file content is embedded into the .ATL file. This parameter is Version ≥: 3.4.1
optional. By default, its value is False.
Type: Integer

DENSITY

If true, the file content is interpreted as a density; otherwise as a value. Version ≥: 3.4.1
This parameter is optional. By default, its value is False.
Type: Integer

Results
None. When successful, the raster file is imported in the destination document node.

© 2022 Forsk. All Rights Reserved.

181

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

13.7 CALCULATEPOINTS
This command returns signal levels in dBm for a given set of points and a set of transmitters.
Path loss matrices, whether they are valid or not, are not used. Therefore the CalculatePoints command is not
dependent on the path loss matrices resolution. Signal levels are calculated using the propagation model of each
transmitter.
Version
≥ 2.6.0
Input Parameters
Name
POINTS

Description
The POINTS input parameter is used to define a set of points.

Attributes
Version ≥: 2.6.1
Type: Array of Integers

TRANSMITTERS

The TRANSMITTERS input parameter is used to define a set of transmit- Version ≥: 2.6.1
ters.
Type: Array of Strings

TECHNOLOGY

The TECHNOLOGY input parameter is used to specify the technology of Version ≥: 3.2.0
transmitters specified by the TRANSMITTERS input parameter.
Type: String
Available values are:
"GSM"
"UMTS"
"LTE"
"CDMA2000"
"5G" (Use "5G" also for LTE in a 5G Multi-RAT document)
This parameter is ignored for single-RAT documents.

The POINTS array must have 2 dimensions, 0 and 1. The size of dimension 0 is the number of points. The size of
dimension 1 is 2, index 0 and 1 for dimension 1 are the X and Y coordinates, respectively. The coordinates of points
are expressed in the projection coordinate system of the Atoll document.
The TRANSMITTERS array must have 1 dimension. The size of the array is the number of transmitters. Array values
are transmitters IDs, as they appear in the TX_ID field of the Transmitters table
Default Parameters
None. GetCommandDefaults for the command CALCULATEPOINTS returns an empty PropertyContainer object.
Results
Name
SIGNALS

Description
The SIGNALS result is used to return signals levels.

Attributes
Version ≥: 2.6.1
Type: TabularData
object

The SIGNALS TabularData object has one record for each transmitter belonging to the TRANSMITTERS input
parameter. The row number n gives the signal received on the point number n. The SIGNALS TabularData object has
the following structure:
Column Name

Description

Attributes

TX_ID

A string holding a transmitter identifier.

Type: String

Pn

The signal level received on point number n from the transmitter identi- Type: Single or Null
fied by the field TX_ID.
When the signal level is less than -200 dBm, the type of the variant
returned for the field Pn is VT_NULL.

182

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

13.8 IMPORTTESTMOBILEDATA
This command imports a set of drive test data files into an Atoll document.
Version
≥ 2.6.1
Input Parameters
Name
NAME

Description
Name of the Atoll Explorer item where the drive test data is imported.

Attributes
Version ≥: 2.6.1
Type: String

RECEIVERHEIGHT

Receiver height.

Version ≥: 2.6.1
Type: Double

RECEIVERGAIN

Receiver gain.

Version ≥: 2.6.1
Type: Double

RECEIVERLOSSES

Receiver losses.

Version ≥: 2.6.1
Type: Double

MEASUREMENTUNIT

Measurement unit. Valid values are: 0=dBm; 1=dBµV; 2=dBµV/m

Version ≥: 2.6.1
Type: Integer

MEASUREMENTCSCODE

Code of the coordinate system used for measurement points in the drive Version ≥: 2.6.1
test data to import.
Type: Integer
The code for a coordinate system is reported in the Atoll properties dialogue of the coordinate system.

CONFIGURATIONNAME

Atoll configuration name, as reported in the Atoll drive test data import Version ≥: 2.6.1
dialogue.
Type: String
Before importing drive test data, a drive test data configuration has to be
defined in Atoll. CONFIGURATIONNAME is the name given to the drive
test data configuration.

FILES

The FILES input parameter is used to define the set of files to import.

Version ≥: 2.6.1

Each file must be specified using its absolute path.

Type: Array of Strings

CONFIGURATIONFILE

The CONFIGURATIONFILE input parameter is used to specify the full path Version ≥: 3.2.0
to the initialization file (.ini) containing the CONFIGURATIONNAME. This
parameter is optional. When it is not specified the configuration file used
Type: String
is the one used in the project.

Default Parameters
None. GetCommandDefaults for the command IMPORTTESTMOBILEDATA returns an empty PropertyContainer
object.
Results
None.

13.9 RUNNEIGHBOURALLOCATION
Performs neighbour allocation on a GSM network.
Version
≥ 2.6.1

© 2022 Forsk. All Rights Reserved.

183

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Input Parameters
Name
TRANSMITTERFOLDER

Description

Attributes

A sub-folder of the transmitters folder, or the transmitters folder itself.

Version ≥: 2.6.1
Type: ChildFolder object

Default Parameters
None. GetCommandDefaults for the command RUNNEIGHBOURALLOCATION returns an empty PropertyContainer
object. The neighbour allocation parameters used to compute neighbours are the ones set into the Atoll document.
The neigbour allocation parameters can be set by importing a user configuration file containing neighbour
allocation parameters. Use the Atoll Document object SetConfig method to import the neighbour allocation
parameters.
Results
Name
NEIGHBOURS

Description

Attributes

The NEIGHBOURS result is used to return neighbour relations.

Version ≥: 2.6.1
Type: TabularData
object

The NEIGHBOURS TabularData object has one record for each neighbour relation between two transmitters
belonging to TRANSMITTERFOLDER.
Name

Description

Attributes

Transmitter

Type: String

Number

Type: Integer

Maximum number

Type: Integer

Neighbour

Type: String

Importance (%)

Type: Single

Cause

Type: String

Coverage (%)

Type: Single

Coverage (km²)

Type: Single

13.10 RUNINTERTECHNOLOGYNEIGHBOURALLOCATION
Performs inter technology neighbour allocation.
Version
≥ 2.6.1
Input Parameters
Name
TRANSMITTERFOLDER
NeighbourTechnologyName

Description
A sub-folder of a transmitters folder, or a transmitters folder
itself.

Attributes
Version ≥: 2.6.1
Type: ChildFolder object

A string used to specify the technology of allocated neighbours. Version ≥: 3.1.0
Available values are:

Type: String

"GSM",
"UMTS",
"LTE",
"5G"

184

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Default Parameters
None. GetCommandDefaults for the command RUNINTERTECHNOLOGYNEIGHBOURALLOCATION returns an
empty PropertyContainer object. The neighbour allocation parameters used to calculate neighbours are the ones
set in the Atoll document. The neigbour allocation parameters can be set by importing a user configuration file
containing neighbour allocation parameters. Use the Atoll Document object SetConfig method to import the
neighbour allocation parameters.
Results
Name
NEIGHBOURS

Description
The NEIGHBOURS result is used to return neighbour relations.

Attributes
Version ≥: 2.6.1
Type: TabularData
object

The NEIGHBOURS TabularData object has one record for each neighbour relation between two transmitters
belonging to TRANSMITTERFOLDER.
Name

Description

Attributes

Transmitter

Type: String

Number

Type: Integer

Maximum number

Type: Integer

Neighbour

Type: String

Cause

Type: String

Coverage (%)

Type: Single

Coverage (km²)

Type: Single

Distance (m)

Type: Single

13.11 RUNINTRACARRIERNEIGHBOURALLOCATION
Performs intra carrier neighbour allocation on a UMTS network.
Version
≥ 2.6.1
Input Parameters
Name
TRANSMITTERFOLDER

Description
A sub-folder of the transmitters folder, or the transmitters folder itself.

Attributes
Version ≥: 2.6.1
Type: ChildFolder object

Default Parameters
None. GetCommandDefaults for the command RUNINTRACARRIERNEIGHBOURALLOCATION returns an empty
PropertyContainer object. The neighbour allocation parameters used to calculate neighbours are the ones set in the
Atoll document. The neigbour allocation parameters can be set by importing a user configuration file containing
neighbour allocation parameters. Use the Atoll Document object SetConfig method to import the neighbour
allocation parameters.
Results
Name
NEIGHBOURS

Description
The NEIGHBOURS result is used to return neighbour relations.

Attributes
Version ≥: 2.6.1
Type: TabularData
object

© 2022 Forsk. All Rights Reserved.

185

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

The NEIGHBOURS TabularData object has one record for each neighbour relation between two transmitters
belonging to TRANSMITTERFOLDER.
Column Name

Description

Attributes

Cell

Type: String

Number

Type: Integer

Maximum number

Type: Integer

Neighbour

Type: String

Cause

Type: String

Coverage (%)

Type: Single

Coverage (km²)

Type: Single

Distance (m)

Type: Single

13.12 RUNINTERCARRIERNEIGHBOURALLOCATION
Performs inter carrier neighbour allocation on a UMTS network.
Version
≥ 2.6.1
Input Parameters
Name
TRANSMITTERFOLDER

Description

Attributes

A sub-folder of the transmitters folder, or the transmitters folder itself.

Version ≥: 2.6.1
Type: ChildFolder object

Default Parameters
None. GetCommandDefaults for the command RUNINTERCARRIERNEIGHBOURALLOCATION returns an empty
PropertyContainer object. The neighbour allocation parameters used to compute neighbours are the ones set into
the Atoll document. The neigbour allocation parameters can be set by importing a user configuration file containing
neighbour allocation parameters. Use the Atoll Document object SetConfig method to import the neighbour
allocation parameters.
Results
Name
NEIGHBOURS

Description
The NEIGHBOURS result is used to return neighbour relations.

Attributes
Version ≥: 2.6.1
Type: TabularData
object

The NEIGHBOURS TabularData object has one record for each neighbour relation between two transmitters
belonging to TRANSMITTERFOLDER.
Column Name

Description

Attributes

Cell

186

Cell

Type: String

Number

Type: Integer

Maximum number

Type: Integer

Neighbour

Type: String

Cause

Type: String

Coverage (%)

Type: Single

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Column Name

Description

Attributes

Coverage (km²)

Type: Single

Distance (m)

Type: Single

13.13 CLONESTUDY
This command clones a coverage prediction.
Version
≥ 2.7.0
Input Parameters
Name

Description

Attributes

STUDY

The STUDY input parameter holds the study to clone. The study to clone Version ≥: 2.7.0
is a study object contained in the Predictions folder of the Atoll document. Type: ChildFolder object

NEWSTUDYNAME

The NEWSTUDYNAME input parameter is used to define the name of the Version ≥: 2.7.0
new cloned study.
Type: String

Default Parameters
None. GetCommandDefaults for the command CLONESTUDY returns an empty PropertyContainer object.
Results
Name
NEWSTUDY

Description

Attributes

The NEWSTUDY result is used to return the new cloned study Version ≥: 2.7.0
object.
Type: ChildFolder object

13.14 DUPLICATESTUDY
This command duplicates a coverage prediction.
Version
≥ 2.7.0
Input Parameters
Name

Description

Attributes

STUDY

The STUDY input parameter holds the study to duplicate. The study to Version ≥: 2.7.0
duplicate is a study object contained in the Predictions folder of the Atoll Type: ChildFolder object
document.

NEWSTUDYNAME

The NEWSTUDYNAME input parameter is used to define the name of the Version ≥: 2.7.0
new duplicated study.
Type: String

NEWSTUDYPARENT

The NEWSTUDYPARENT input parameter is used to specify a sub folder Version ≥: 3.2.1
of the Predictions folder. The new study will be created in the NEWType: ChildFolder object
STUDYPARENT sub folder of the Predictions folder.
This parameter is optional. If not specified the new study will be created
at the root of the Predictions folder.

© 2022 Forsk. All Rights Reserved.

187

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Default Parameters
None. GetCommandDefaults for the command DUPLICATESTUDY returns an empty PropertyContainer object.
Results
Name
NEWSTUDY

Description

Attributes

The NEWSTUDY result is used to return the new duplicated study object. Version ≥: 2.7.0
Type: ChildFolder object

13.15 COMPARESTUDY
This command compares two coverage predictions.
Version
≥ 2.7.0
Input Parameters
Name

Description

Attributes

STUDY1

The STUDY1 input parameter holds the first study involved in the com- Version ≥: 2.7.0
parison. It is a study object contained in the Predictions folder of the Atoll Type: ChildFolder object
document.

STUDY2

The STUDY2 input parameter holds the second study involved in the com- Version ≥: 2.7.0
parison. It is a study object contained in the Predictions folder of the Atoll Type: ChildFolder object
document.

NEWSTUDYNAME

The NEWSTUDYNAME input parameter is used to define the name of the Version ≥: 2.7.0
comparison study.
Type: String

Default Parameters
None. GetCommandDefaults on IDocument4 interface for the command COMPARESTUDY returns an empty
PropertyContainer object.
Results
Name
NEWSTUDY

Description

Attributes

The NEWSTUDY result is used to return the comparison study object.

Version ≥: 2.7.0
Type: ChildFolder object

13.16 CALCULATEEQUIPMENTLOSSES
This command calculates equipment losses and noise figure for all transmitters in a document transmitters folder.
Version
≥ 2.7.0
Input Parameters
Name
TRANSMITTERFOLDER

188

Description

Attributes

A sub-folder of a transmitters folder, or a transmitters folder itself.

Version ≥: 3.1.0

≥ 3.

Type: ChildFolder object

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

None.
Default Parameters
None. GetCommandDefaults for the command CALCULATEEQUIPMENTLOSSES returns an empty
PropertyContainer object.
Results
None. The field "LOSSES" of the "TRANSMITTERS" table is updated for all transmitters in the document transmitters
folder. This command is the same as the "Equipment | Recalculate Losses" or the "Equipment | Recalculate Losses
and Noise Figure" menu option available in Atoll on the document transmitters folder.

13.17 CALCULATEREPEATERS
This command calculates propagation losses, azimuth, mechanical tilt, or gains for all repeaters in a document
transmitters folder.
Version
≥ 2.7.0
Input Parameters
Name

Description

Attributes

PROPAGATIONLOSSES

The PROPAGATIONLOSSES input parameter is used to specify whether Version ≥: 2.7.0
repeaters donor side propagation losses will be calculated.
Type: Boolean

AZIMUTHSANDTILTS

The AZIMUTHSANDTILTS input parameter is used to specify whether
repeaters donor side azimuths and tilts will be calculated.

Version ≥: 2.7.0

The GAINS input parameter is used to specify whether repeaters gains
will be calculated.

Version ≥: 2.7.0

A sub-folder of a transmitters folder, or a transmitters folder itself.

Version ≥: 3.1.0

≥ 3.

Type: ChildFolder object

GAINS
TRANSMITTERFOLDER

Type: Boolean
Type: Boolean

Default Parameters
GetCommandDefaults for the command CALCULATEREPEATERS returns a PropertyContainer object with the
properties:
Name

Description

Attributes

PROPAGATIONLOSSES

Boolean

True

AZIMUTHSANDTILTS

Boolean

True

GAINS

Boolean

True

Results
None. The "TRANSMITTERS" table content and the "REPEATERS" table content are updated depending on the
requested calculation.
If the PROPAGATIONLOSSES input parameter is set to True, then the calculation task "Repeaters | Calculate Donor
Side Propagation Losses" on the document transmitters folder is performed.
If the AZIMUTHSANDTILTS input parameter is set to True, then the calculation task "Repeaters | Calculate Donor
Side Azimuths and Tilts" on the document transmitters folder is performed.
If the GAINS input parameter is set to True, then the calculation task "Repeaters | Calculate Gains" on the document
transmitters folder is performed.

© 2022 Forsk. All Rights Reserved.

189

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

13.18 CALCULATEREMOTEANTENNAS
This command calculates propagation losses, azimuth, mechanical tilt, or gains for all remote antennas in a
document transmitters folder.
Version
≥ 2.7.0
Input Parameters
Name

Description

Attributes

PROPAGATIONLOSSES

The PROPAGATIONLOSSES input parameter is used to specify whether Version ≥: 2.7.0
remote antennas donor side propagation losses will be calculated.
Type: Boolean

AZIMUTHSANDTILTS

The AZIMUTHSANDTILTS input parameter is used to specify whether
remote antennas donor side azimuths and tilts will be calculated.

Version ≥: 2.7.0
Type: Boolean

GAINS

The GAINS input parameter is used to specify whether remote antennas Version ≥: 2.7.0
gains will be calculated.
Type: Boolean

TRANSMITTERFOLDER

A sub-folder of a transmitters folder, or a transmitters folder itself.

Version ≥: 3.1.0

≥ 3.

Type: ChildFolder object

Default Parameters
GetCommandDefaults for the command CALCULATEREMOTEANTENNAS returns a PropertyContainer object with
the properties:
Property Name

Type

Value

PROPAGATIONLOSSES

Boolean

True

AZIMUTHSANDTILTS

Boolean

True

GAINS

Boolean

True

Results
None. The "TRANSMITTERS" table content and the "REPEATERS" table content are updated depending on the
requested calculation.
If the PROPAGATIONLOSSES input parameter is set to True, then the calculation task "Remote Antennas | Calculate
Donor Side Propagation Losses" on the document transmitters folder is performed.
If the AZIMUTHSANDTILTS input parameter is set to True, then the calculation task "Remote Antennas | Calculate
Donor Side Azimuths and Tilts" on the document transmitters folder is performed.
If the GAINS input parameter is set to True, then the calculation task "Remote Antennas | Calculate Gains" on the
document transmitters folder is performed.

13.19 EXPORTACTIVESETANALYSIS
This command exports the active set analysis to text files.
Version
≥ 2.7.1

190

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Input Parameters
Input parameters include general parameters, simulation conditions (SIMULATIONCONDITIONS), shadowing and
indoor coverage conditions (CLUTTERCONDITIONS), and filtering parameters (RECORDSETCONDITIONS).
Name
SIMULATIONCONDITIONS

Description

Attributes

The SIMULATIONCONDITIONS PropertyContainer object used here has Version ≥: 2.7.1
a subset of the SIMULATIONCONDITIONS property of a "Pilot Quality
Type: PropertyContainer
Analysis (Ec/Io)" Prediction ChildFolder Object. Therefore the SIMULA- object
TIONCONDITIONS property of a "Pilot Quality Analysis (Ec/Io)" Prediction
ChildFolder Object can be used directly, additional content in this PropertyContainer object will be ignored.

CLUTTERCONDITIONS

Version ≥: 2.7.1
Type: PropertyContainer
object

RECORDSETCONDITIONS

The RECORDSETCONDITIONS PropertyContainer object used here has a Version ≥: 2.7.1
subset of the RECORDSETCONDITIONS property of a Prediction Child- Type: PropertyContainer
Folder Object. Therefore the RECORDSETCONDITIONS property of a Pre- object
diction ChildFolder Object can be used directly, additional content in this
PropertyContainer object will be ignored.

The general parameters include:
Name
RESOLUTION

Description
The resolution in meter used to export the activeset analysis.

Attributes
Version ≥: 2.7.1
Type: Integer

DEPTH

The maximum number of cells in the activeset analysis to export on a
given point.

Version ≥: 2.7.1
Type: Integer

TEXTSEPARATOR

The ASCII code of the character used as the field delimiter in the exported Version ≥: 2.7.1
text files.
Type: Integer

EXPORTFULLPATH

The full path of the file where the activeset is exported.

Version ≥: 2.7.1
Type: String

SIMULATIONCONDITIONS include:
Name
TERMINAL

Description
The name of the terminal used to export the active set.

Attributes
Version ≥: 2.7.1
Type: String

MOBILITY

The name of the mobility used to export the active set.

Version ≥: 2.7.1
Type: String

SERVICE

The name of the service used to export the active set.

Version ≥: 2.7.1
Type: String

CARRIER

The carrier number used to export the active set.

Version ≥: 2.7.1
Type: Integer

CLUTTERCONDITIONS include:
Name

Description

Attributes

SHADOWING

Whether to calculate shadowing margins related to the defined cell Version ≥: 2.7.1
edge coverage probability and the standard deviation(s) per clutter Type: Boolean
class or not. When set to False, no shadowing effect is considered.

INDOORCOVERAGE

Whether to decrease the received signal level at the receiver of the Version ≥: 2.7.1
indoor loss defined for the corresponding clutter class (clutter class Type: Boolean
properties).

EDGECOVERAGEPROBABILITY

A value between 0 and 100, expressing in percentage value the
required coverage probability at the cell edge.

© 2022 Forsk. All Rights Reserved.

Version ≥: 2.7.1
Type: Single

191

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

RECORDSETCONDITIONS include:
Name

Description

FILTER

Attributes

"Filter" part of the recordset conditions, applied to the transmitters table. Version ≥: 2.7.1
Type: String

Default Parameters
Property Name

Default Value

SIMULATIONCONDITIONS

The same as the SIMULATIONCONDITIONS property of a new "Pilot Quality Analysis (Ec/Io)" prediction.

RECORDSETCONDITIONS

The same as the RECORDSETCONDITIONS property of a new "Pilot Quality Analysis (Ec/Io)" prediction.

RESOLUTION

The same as the RESOLUTION property of a new "Pilot Quality Analysis
(Ec/Io)" prediction.

DEPTH

3, ie by default the maximum number of cells of the activeset analysis is≥
3.

TEXTSEPARATOR

59, ie the ASCII code of the ’;’ character. Fields in the exported fileswill be
separated by the ’;’ character.

Results
None. The active set analysis is exported to the file specified by the EXPORTFULLPATH input parameter.
The area exported is the computation zone of the document.
When the area on wich the activeset analysis has to be exported is too large, the export is splitted into several text
files. The number and the size of these text files cannot be controlled. The text files are numbered starting from 0.
For instance, when the EXPORTFULLPATH input parameter is set to "c:\activeset.txt", the following files may be
created:
c:\activeset-0.txt
c:\activeset-1.txt
c:\activeset-2.txt
Text File Format
The text file in which the active set analysis is exported has a header, followed by the data. The data and the header
are separated by a blank line.
◼

Header
The header is made of several [key;value] records. There is one [key;value] header record per line in the export
file:
type;[Technology of the document used to export the activeset]
timestamp;[Date and time when the activeset has been exported]
resolution;[Resolution in meter used to export the activeset]
xmin;[Minimum X value of the rectangular area for which the activeset is exported]
xmax;[Maximum X value of the rectangular area for which the activeset is exported]
ymin;[Minimum Y value of the rectangular area for which the activeset is exported]
ymax;[Maximum Y value of the rectangular area for which the activeset is exported]
x_num_pixels;[Number of pixels of the export area along the X axis]
y_num_pixels;[Number of pixels of the export area along the Y axis]

◼

Data
The data format is made of one line per pixel. The line format for one pixel is:
X;Y;[Carrier;][Transmitter_1;Ec/I0;I0]...[Transmitter_n;Ec/I0;I0]
X: X coordinate of the pixel, in meter
Y: Y coordinate of the pixel, in meter
When the activeset is not empty, it is listed thereafter on the same line:

192

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Carrier: Carrier of the activeset
There are at most n transmitters in the activeset analysis, where n is the DEPTH input parameter. Transmitter
names are listed along with the Ec/I0 and I0 value.
Transmitter_n : Name of the transmitter
Ec/I0: Ec/I0 in dB
I0: I0 in dB
Extract of an active set export file:
type;UMTS
timestamp;16:15:01 18-July-2008
resolution;50
xmin;23200
xmax;23700
ymin;-14250
ymax;-13650
x_num_pixels;10
y_num_pixels;12
[...]
23200;-14200;
23250;-14200;0;Site3_1;-10.06;-64.88;Site3_3;-12.62;-64.88;Site3_2;-13.56;64.88
23300;-14200;
23350;-14200;
[...]

13.20 CALCULATEPOINTSECI0
This command returns Ec/I0 values in dB for a given set of points and a set of transmitters.
Version
≥ 2.7.1
Input Parameters
Name
POINTS

Description
The POINTS input parameter is used to define a set of points.

Attributes
Version ≥: 2.7.1
Type: Array of Integers

TRANSMITTERS

The TRANSMITTERS input parameter is used to define a set of transmit- Version ≥: 2.7.1
ters.
Type: Array of Strings

STUDY

The STUDY input parameter is used to define the parameters used to cal- Version ≥: 2.7.1
culate the Ec/I0 values. It is a study object contained in the Predictions Type: ChildFolder object
folder of the Atoll document. The STUDY input parameter must be a study
of type "Pilot Quality Analysis (Ec/I0)".

The POINTS array must have 2 dimensions, 0 and 1. The size of dimension 0 is the number of points. The size of
dimension 1 is 2, index 0 and 1 for dimension 1 are the X and Y coordinates, respectively. The points coordinates
are expressed in the projection coordinate system of the Atoll document.
The TRANSMITTERS array must have 1 dimension. The size of the array is the number of transmitters. Array values
are transmitters IDs, as they appear in the TX_ID field of the Transmitters table.

© 2022 Forsk. All Rights Reserved.

193

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Default Parameters
None. GetCommandDefaults on the IDocument4 interface for the command CALCULATEPOINTSECI0 returns an
empty PropertyContainer object.
Results
Name
VALUES

Description

Attributes

The VALUES result is used to return Ec/I0 values.

Version ≥: 2.7.1
Type: TabularData
object

The VALUES tabular data object has one record for each transmitter belonging to the TRANSMITTERS input
parameter. The row number n gives the Ec/I0 value on the point number n.
Column Name

Description

Attributes

TX_ID

A string holding a transmitter identifier.

Type: String

Pn

The Ec/I0 value on point number n from the transmitter identified by the Type: Single or Null
field TX_ID.

13.21 RUNALLCARRIERSALLOCATION
Performs all carriers allocation on a TD-SCDMA network.
Version
≥ 2.8.1
Input Parameters
Name

Description

TRANSMITTERFOLDER

Attributes

A sub-folder of the transmitters folder, or the transmitters folder
itself.

Version ≥: 2.8.1
Type: ChildFolder object

CONFREQUENCYALLOCATION

A boolean value used to specify whether to perform Co-N frequency Version ≥: 2.8.1
allocation (True) or Diff-N frequency allocation (False).
Type: Boolean

COMMITRESULTS

A boolean value used to specify whether the allocation results will Version ≥: 2.8.1
be commited in the document (True), or not (False).
Type: Boolean

Default Parameters
None. GetCommandDefaults for the command RUNALLCARRIERSALLOCATION returns an empty
PropertyContainer object.
Results
Name
CARRIERS

Description

Attributes

The CARRIERS result is used to return carrier allocation information.

Version ≥: 2.8.1
Type: TabularData
object

The CARRIERS TabularData object has one record for each transmitter’s carrier allocation.
Name

194

Description

Attributes

Transmitter

Type: String

Carriers

Type: Integer

Master Carrier

Type: Integer

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

13.22 RUNMASTERCARRIERALLOCATION
Performs master carrier allocation on a TD-SCDMA network.
Version
≥ 2.8.1
Input Parameters
Name

Description

TRANSMITTERFOLDER

Attributes

A sub-folder of the transmitters folder, or the transmitters folder
itself.

Version ≥: 2.8.1
Type: ChildFolder object

DELETEEXISTINGALLOCATION

A boolean value used to specify whether to delete the existing allo- Version ≥: 2.8.1
cation (True), or not (False).
Type: Boolean

COMMITRESULTS

A boolean value used to specify whether the allocation results will be Version ≥: 2.8.1
commited in the document (True), or not (False).
Type: Boolean

Default Parameters
None. GetCommandDefaults for the command RUNMASTERCARRIERALLOCATION returns an empty
PropertyContainer object.
Results
Name
CARRIERS

Description

Attributes

The CARRIERS result is used to return carrier allocation Version ≥: 2.8.1
information.
Type: TabularData object

The CARRIERS TabularData object has one record for each transmitter’s carrier allocation.
Column Name

Description

Attributes

Transmitter

Type: String

Master Carrier

Type: Integer

13.23 MWRUN
This command runs analysis for a given set of links. The analysis can take into account interferers.
The results are provided in a tabular data format. The fields are all the columns displayed when running link budgets
or interference calculation on a whole links folder.
Version
≥ 2.6.1

© 2022 Forsk. All Rights Reserved.

195

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Input Parameters
All the parameters that the user can provide as input through the GUI can be provided to this command.
Name
QUALITYMODEL

Description

Attributes

Specifies the quality model to be used for analysis. Valid values are:

Version ≥: 2.6.1

◼ 1: ITU Rec 530-8

Type: Integer

◼ 2: ITU Rec 530-10

Default: 11

◼ 3: Vigants Barnett
◼ 4: KQ Factor
◼ 5: ITU Rec 530-11
◼ 6: ITU Rec 530-12
◼ 7: ITU Rec 530-13
◼ 8: ITU Rec 530-14
◼ 9: ITU Rec 530-15
◼ 10: ITU Rec 530-16
◼ 11: ITU Rec 530-17

QualityObjective0
QualityObjective1
QualityObjective2
QualityObjective3
QualityObjective4

Defines the priority of objectives that Atoll uses to find the appropriate Version ≥: 2.6.1
quality objective. QualityObjective0 contains the objectives which are the Type: Integer
highest-priority objectives. QualityObjective4 contains the lowest-priority
Defaults:
objectives. Each QualityObjectiveX is set to an integer:
QualityObjective0=3
◼ 0: As a function of Rate
QualityObjective1=4
◼ 1: ITU-T G821
QualityObjective2=5
◼ 2: ITU-T G826
QualityObjective3=2
◼ 3: Custom
QualityObjective4=1
◼ 4: UITT G828
◼ 5: UITT Y1541

AvailabilityObjective0
AvailabilityObjective1
AvailabilityObjective2

Defines the priority of objectives that Atoll uses to find the appropriate Version ≥: 2.6.1
availability objective. AvailabilityObjective0 contains the highest priority Type: Integer
objectives. AvailabilityObjective2 contains the lowest priority objectives.
Defaults:
Each AvailabilityObjectiveX is set to an integer:
AvailabilityObjective0=3
◼ 0: As a function of Rate
AvailabilityObjective1=2
◼ 1: ITU-T G821
AvailabilityObjective2=1
◼ 2: ITU-T G826
◼ 3: Custom
◼ 4: UITT G828
◼ 5: UITT Y1541

RainModel

Defines which rain model is to be used for analysis:

Version ≥: 2.6.1

◼ 1: ITU Rec 530-8

Type: Integer

◼ 2: ITU Rec 530-10

Default: 10

◼ 3: Crane
◼ 4: ITU Rec 530-11
◼ 5: ITU Rec 530-12
◼ 6: ITU Rec 530-13
◼ 7: ITU Rec 530-14
◼ 8: ITU Rec 530-15
◼ 9: ITU Rec 530-16
◼ 10: ITU Rec 530-17

196

RBER

Residual BER; used by ITU Recommendation 530-8 and above to calcu- Version ≥: 2.6.1
late performance parameters. Typically in the range from 10E-10 to 10E- Type: Double
13 for the bit rates of 2 to 155 Mbit/s, respectively.
Default: 1.00E-12

ALFA1

Used by ITU Recommendation 530-8 and above to calculate performance Version ≥: 2.6.1
parameters.
Type: Integer
10 to 30, number of errors per burst for the BER in the range from 10-3 Default: 10
to BERSES

ALFA2

Used by ITU Recommendation 530-8 and above to calculate performance Version ≥: 2.6.1
parameters.
Type: Integer
1 to 10, number of errors per burst for the BER in the range from BERSES Default: 1
to RBER

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Name

Description

Attributes

RefDelayM

Used by ITU Recommendation 530-8 and above to calculate prediction Version ≥: 2.6.1
of outage in unprotected digital systems.
Type: Single
RefDelayM is the reference delay (in nanoseconds) used to obtain the sig- Default: 6.3
nature for minimum phase.

RefDelayNM

Used by ITU Recommendation 530-8 and above to calculate prediction Version ≥: 2.6.1
of outage in unprotected digital systems.
Type: Single
RefDelayNM is the reference delay (in nanoseconds) used to obtain the Default: 6.3
signature for non-minimum phase.

EquipPercent

Used to calculate the availability objective which is compared to the out- Version ≥: 2.6.1
age due to equipment failures. Its value must be between 0 and 100.
Type: Single
Default: 33

RainPercent

This percent is used to calculate the availability objective which will be Version ≥: 2.6.1
compared to the availability outage. Its value must be between 0 and 100. Type: Single
Default: 33

kMoy

Defines the refractivity factor for the average earth curvature used in cal- Version ≥: 2.6.1
culations.
Type: Single
Default: 1.33

kMin

Defines the default refractivity factor for the earth curvature used to dis- Version ≥: 2.6.1
play the ellipsoid. (Not used during link budgets nor interference calcu- Type: Single
lations).
Default: 0.88

UseK1Global

Method for calculating the median refractivity factor.

UseK2Global

UseAtpc

Version ≥: 2.6.1

◼ True: Default method

Type: Boolean

◼ False: Use factors calculated from links

Default: True

Method for calculating the minimum refractivity factor.

Version ≥: 2.6.1

◼ True: Default method

Type: Boolean

◼ False: Use factors calculated from links

Default: True

Specifies whether power control must be reduced or not with the ATPC Version ≥: 2.6.1
value:
Type: Integer
◼ 0: Nominal power
Default: 0
◼ 1: Coordinated power
◼ 2: Power with minimum ATPC on correlated paths

UseAtpcForClearAir

Specifies whether power control must be reduced or not with the ATPC Version ≥: 2.6.1
value in clear air:
Type: Integer
◼ 0: Nominal power
Default: 1
◼ 1: Coordinated power
◼ 2: Power with minimum ATPC on correlated paths

UseOpModeAsModulationGroup

Specifies whether the ACM mode is considered when grouping equipment.
◼ False: Only radios using the same ACM mode can be grouped and

assigned to a link.

Version ≥: 3.4.1
Type: Boolean
Default: False

◼ True: ACM mode is ignored.

P0Method

IgnoreWetSnow

Specifies the calculation method for multiple paths:

Version ≥: 3.4.1

◼ 0: Simplified method.

Type: Integer

◼ 1: Method using terrain roughness.

Default: 1

Used by Recommendation ITU 530-16 and above to determine whether Version ≥: 2.6.1
wet snow is considered.
Type: Boolean
◼ False: Attenuation due to wet snow is calculated as per the ITU rec- Default: False
ommendation
◼ True: Wet snow is ignored

IgnoreXPD

Specifies whether the calculation of fading due to XPD must be taken into Version ≥: 2.6.1
account or not in the total result. Used by ITU 530 models.
Type: Boolean
◼ True: Fading due to XPD is considered.
Default: True
◼ False: Fading due to XPD is ignored.

IgnorePR

Specifies whether the calculation of fading due to enhancements must Version ≥: 2.6.1
be taken into account or not in the total result.
Type: Boolean
◼ True: Fading due to enhancements is considered.
Default: False
◼ False: Fading due to enhancements is ignored.

© 2022 Forsk. All Rights Reserved.

197

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Name
WhichBER

BER1

Description

Attributes

Specifies the method for calculating the binary error rate.

Version ≥: 3.4.1

◼ 1: Binary error rate is defined in each link.

Type: Integer

◼ 2: Binary error rate is a global value for all links.

Default: 1

First value of BER which is used when WhichBER = 1.

Version ≥: 2.6.1
Type: Double
Default: 1.00E-6

BER2

Second value of BER which is used when WhichBER = 1.

Version ≥: 2.6.1

Note that this value is not used when running calculations with this API. Type: Double
Using the API means that calculations are only displayed with BER1.
Default: 1.00E-3
Rec838

Defines which release of recommendation ITU-838 is used for rain atten- Version ≥: 2.6.1
uation:
Type: Double
◼ 0: Rec 838-1
Default: 1
◼ 1: Rec 838-3

MultilineShared

CALC_LINK_PORTS

Specifies the frequency diversity method:

Version ≥: 3.4.1

◼ 0: Continuous mode

Type: Integer

◼ 1: Shared mode

Default: 0

Specifies how the expected results are displayed:

Version ≥: 2.6.1

◼ "all": all the ports of each link are calculated and displayed in the final

result.

Type: String
Default: "worst"

◼ "worst" : the final result will display only the worst port.
◼ "selected": the final result will display the result for the port defined

in the port parameter.
CALC_WITH_NOI

Specifies whether the analysis is a link analysis without interferers (link Version ≥: 2.6.1
budgets) or if total interference must be taken into account.
Type: Integer
◼ 0: Calculation with interference
Default: 1
◼ 1: Calculation without interference

InterferenceDistanceMax

Specifies the maximum distance (in meters) to search for potential inter- Version ≥: 2.6.1
ferers.
Type: Double
Default: 50000

InterferenceDropMin

Specifies the threshold of drop margin (in dB) under which an interference level is not added to the total result.

Version ≥: 2.6.1
Type: Double
Default: 1

InterferenceDropMinGlobal

Specifies the threshold of drop margin (in dB) above which an excla;ation Version ≥: 3.4.1
mark ("!") is appended to the global drop margin result.
Type: Double
Default: 3

IgnoreCoSiteInterference

Specifies whether to consider interferers that are located on the same
site.
◼ False: Co-site interferers are ignored

Version ≥: 3.4.1
Type: Boolean
Default: False

◼ True: Co-site interferers are considered

InterferenceAutoWeight

Specifies the weight percentage that defines if an interferer level is more Version ≥: 2.6.1
important than interfering effects. This is only used for semi-automatic Type: Integer
channel allocation and has no influence when running calculations with Default: 50
this API.
◼ 0: Suffered interference is ignored
◼ 100: Caused interference is ignored

InterferenceUseAtpc

Specifies whether interferer power control must be reduced or not with Version ≥: 2.6.1
the ATPC value:
Type: Integer
◼ 0: Nominal power
Default: 0
◼ 1: Coordinated power
◼ 2: Power with minimum ATPC on correlated paths

InterferenceWidth

Percent of the channels width that can interfere or be interfered.

Version ≥: 2.6.1
Type: Integer
Default: 250

InterferenceBWidthConst

198

Specifies whether the interfered bandwidth is constant or not.

Version ≥: 2.6.1

◼ 0: The interfered bandwidth is not constant.

Type: Integer

◼ Other value: The interfered bandwidth in MHz.

Default: 0

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Name
COverIWithFKTB

InterferenceOverShoot

Description
Specifies whether FKTB is taken into account in C/I calculation.

Attributes
Version ≥: 2.6.1

◼ False: FKTB is considered.

Type: Boolean

◼ True: FKTB is ignored.

Default: False

Specifies whether passive repeaters are taken into account when running Version ≥: 2.6.1
interference:
Type: Integer
◼ 0: Interference through passive is ignored.
Default: 0
◼ 1: Links with passive repeaters may also interfere through their own

passive.
◼ 2: Qny signal can interfere through a repeater.;

InterferedEquipment
InterfererEquipment

Specifies the modulation for the interfered receiver and the interfering
transmitter.
◼ 0: Default modulation.

Version ≥: 2.6.1
Type: Integer
Default: 0

◼ 1: Lowest modulation.
◼ 2: Highest modulation.
◼ 3: All modulations.

CoChannelOnly

Specifies whether to only consider interference that occurs on the same Version ≥: 2.8.1
channel.
Type: Boolean
◼ True: Only co-channel interference is considered. InterferenceWidth Default: False
is ignored.
◼ False: All interference is considered.

Resolution

Sets the step for extracting profiles between an interferer and a victim. Version ≥: 2.6.1
Type: Integer
Default: 50

ClutterCategory0
...
ClutterCategory36

Qualifies the clutter categories. Combinations with logical OR are possi- Version ≥: 2.6.1
ble:
Type: Integer
◼ 0: Normal.
Default: See GUI
◼ 1: Reflective.
◼ 2: Foliage.
◼ 4: No foliage.

ClutterDryCategory0

Qualifies the ground by clutter category.

Version ≥: 2.6.1

...

◼ A: Sea water

Type: Integer

ClutterDryCategory36

◼ B: Humid soil

Default: See GUI

◼ C: Fresh water
◼ D: Medium dry soil
◼ E: Very dry soil
◼ F: Pure water
◼ G: Ice

TemplateFilePath

File path for the custom reports template

Version ≥: 2.6.1
Type: String

ExportPath

File path to the custom reports output folder

Version ≥: 2.6.1
Type: String

Analysis Results Without Interference Calculation
Name
LINKNAME

Description
Name (primary key) of the link whose results are given.

Attributes
Version ≥: 2.6.1
Type: String

BAND

Name (primary key) of the frequency band of the link.

Version ≥: 2.6.1
Type: String

LENGTH

Length of the link calculated along the Great Circle (with latitude, longi- Version ≥: 2.6.1
tude and heights).
Type: Single
This value is displayed as read-only in the first page of links properties but
is not saved in database.

WAY

Way of the link which is concerned with this result.

Version ≥: 2.6.1

"AB" means "go" (= Site A toward Site B)

Type: String

"BA" means "return" (= Site B toward Site A)

© 2022 Forsk. All Rights Reserved.

199

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Name
SUBBAND

Description

Attributes

Name (primary key) of the subband of the link with the suffix "[-]" or "[+]"
depending on the half subband of the link.

Version ≥: 2.6.1
Type: String

"[-]" means lowest part
"[+]" means highest part.
Can be null if the link has manual frequencies.
CHANNEL

The calculated channel number.

Version ≥: 2.6.1

If the link has manual frequency, channel number is "-1".

Type: String

POLAR

String which contains either "H" for horizontal polarization, either "V" for Version ≥: 2.6.1
vertical polarization.
Type: String
This value can be determined by the links properties (if no ports are
defined) or by the ports configuration if any.

SITE_TX

Name (primary key) of the transmitting site of the link being calculated Version ≥: 2.6.1
(site A is the way is "AB", site B if the way if "BA").
Type: String

ANT_TX

Name (primary key) of the transmitting antenna of the link. (antenna A Version ≥: 2.6.1
is the way is "AB", antenna B if the way if "BA").
Type: String

HEIGHT_TX

Value of the height of transmitting antenna (in meters).

Version ≥: 2.6.1
Type: Single

AZIMUTH_TX

Value of the azimuth of the transmitting antenna. (in degrees). This value Version ≥: 2.6.1
is calculated, not displayed in the links properties, nor saved in database. Type: Single
It takes into account the antenna misalignment and the direction of the
receiver. (latitude, longitude and height).

TILT_TX

Value of the tilt of the transmitting antenna. (in degrees). This value is cal- Version ≥: 2.6.1
culated, not displayed in the links properties, nor saved in database. It Type: Single
takes into account the antenna misalignment and the direction of the
receiver. (latitude, longitude and height).

ANTGAIN_TX

Value of the gain of the transmitting antenna (in dB). This value is displayed in the antenna properties.

Version ≥: 2.6.1
Type: Single

SITE_RX

Name (primary key) of the receiving site of the link being calculated (site Version ≥: 2.6.1
B is the way is "AB", site A if the way if "BA").
Type: String

ANT_RX

Name (primary key) of the receiving antenna of the link. (antenna B is the Version ≥: 2.6.1
way is "AB", antenna A if the way if "BA").
Type: String

HEIGHT_RX

Value of the height of receiving antenna (in meters).

Version ≥: 2.6.1
Type: Single

AZIMUTH_RX

Value of the azimuth of the receiving antenna. (in degrees). This value is Version ≥: 2.6.1
calculated, not displayed in the links properties, nor saved in database. Type: Single
It takes into account the antenna misalignment and the direction of the
receiver. (Latitude, longitude and height).

TILT_RX

Value of the tilt of the receiving antenna. (in degrees). This value is cal- Version ≥: 2.6.1
culated, not displayed in the links properties, nor saved in database. It Type: Single
takes into account the antenna misalignment and the direction of the
receiver. (Latitude, longitude and height).

ANTGAIN_RX

Value of the gain of the receiving antenna (in dB). This value is displayed Version ≥: 2.6.1
in the antenna properties.
Type: Single

EQ_TX

Name (primary key) of the transmitting equipment. (equipment A is the Version ≥: 2.6.1
way is "AB", equipment B if the way if "BA").
Type: String

POWER_NOM

Value of the nominal transmitted power, used if ATPC is not taken into Version ≥: 2.6.1
account.
Type: Single

POWER_COORD

Value of the coordinate transmitted power, used if ATPC is taken into
account.

Version ≥: 2.6.1

Value the system configuration of the equipment. String formatted as:

Version ≥: 2.6.1

SYS_CFG

Type: Single

"n+m" where n is an integer which corresponds to the main channels
Type: String
number, and "m" an interger which corresponds to the stad by channels
number. Ex: "1+1", "2+0" …

200

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Name

Description

Attributes

CAPA

Value the capacity of the equipment. String is formatted with the number Version ≥: 2.6.1
of trunks (depending on the digital hierarchy) and the trunk name.
Type: String
Example: "E1" or "3 x E1" or "2 x STM-16" depending for if the number of
trunks is more than one or not.

TX_LOSS

Value of the total losses on the transmitter side: Shared losses, Connec- Version ≥: 2.6.1
tion losses, Shielding factor, port losses (filter + attenuation), wave guide Type: Single
losses.

FSL

Value of the free space loss calculated between transmitter and receiver. Version ≥: 2.6.1
Type: Single

LA

Value of the attenuation due to dry air absorption.

Version ≥: 2.6.1
Type: Single

LV

Value of the attenuation due to vapor absorption.

Version ≥: 2.6.1
Type: Single

LD

Value of the total diffraction through the profile between the transmitter Version ≥: 2.6.1
and the receiver.
Type: Single

LVEG

Value of the vegetation loss along the profile.

Version ≥: 2.6.1
Type: Single

LBS

Value of the tropospheric loss along the profile.

Version ≥: 2.6.1
Type: Single

LTOT

Value of the total propagation loss along the profile. (Remember that veg- Version ≥: 2.6.1
etation loss is never added).
Type: Single

EQ_RX

Name (primary key) of the receiving equipment. (equipment B is the way Version ≥: 2.6.1
is "AB", equipment A if the way if "BA").
Type: String

RX_LOSS

Value of the total losses on the receiver side: Shared losses, Connection Version ≥: 2.6.1
losses, Shielding factor, port losses (filter + attenuation), wave guide
Type: Single
losses.

RX_THRESOLD

Value of the receiver threshold (dBm) defined as the sensitivity of the
receiver for the BER1 value.

Version ≥: 2.6.1

Value of the total decoupling (dB) : losses due co-polar patterns of the
requested polarization for transmitter and receiver antenna. (Generally
null if antennas are aligned.)

Version ≥: 2.6.1

DECOUPLING

Type: Single
Type: Single

XPD

Difference between the cross-polar value of the receiver antenna and its Version ≥: 2.6.1
co-polar value (dB).
Type: Single

XPI

Difference between the cross-polar value of the transmitter antenna and Version ≥: 2.6.1
its co-polar value (dB).
Type: Single

RX_LEVEL

Wanted signal level (dBm) Takes into account the transmitted power,
Version ≥: 2.6.1
transmitter and receiver losses, total propagation losses and decoupling. Type: Single

FADE_MARGIN

Calculated fade margin (uniform margin) which takes into account the
received signal level et the receiver threshold.

Version ≥: 2.6.1

Percent of outage due to uniform fadings.

Version ≥: 2.6.1

PNS

Type: String
Type: Single

PS

Percent of outage due to selective fadings.

Version ≥: 2.6.1
Type: Single

pXPD

Percent of outage due to cross-polar discrimination fadings.

Version ≥: 2.6.1
Type: Single

PT

Percent of outage which determined the quality of the link (i.e during clear Version ≥: 2.6.1
air conditions).
Type: Single

SESR

Probability of SESR outage.

Version ≥: 2.6.1
Type: Single

BBER

Probability of BBER outage.

Version ≥: 2.6.1
Type: Single

ESR

Probability of ESR outage.

Version ≥: 2.6.1
Type: Single

© 2022 Forsk. All Rights Reserved.

201

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Name
PR

Description

Attributes

Percent of fadings due to enhancements.

Version ≥: 2.6.1
Type: Single

P0

Percent of multipath occurrence.

Version ≥: 2.6.1
Type: Single

PP

Percent of fadings due to rain for the worst month.

Version ≥: 2.6.1
Type: Single

PPA

Percent of fadings due to rain for an average year.

Version ≥: 2.6.1
Type: Single

PXPD

Percent of rain fadings due to cross-polar discrimination.

Version ≥: 2.6.1
Type: Single

PPT

Total percent of unavailability for an average year.

Version ≥: 2.6.1
Type: Single

PFAILURES

Percent of fadings due to equipment failures.

Version ≥: 2.6.1
Type: Single

RAIN_SESR

Probability of rain SESR outage.

Version ≥: 2.6.1
Type: Single

RAIN_BBER

Probability of rain BBER outage.

Version ≥: 2.6.1
Type: Single

RAIN_ESR

Probability of Rain ESR outage.

Version ≥: 2.6.1
Type: Single

PASSIVE_GAIN

Total gain (dB) of the passive repeaters.

Version ≥: 2.6.1
Type: Single

AFF_RAIN

Total rain attenuation (dB) along the path.

Version ≥: 2.6.1
Type: Single

SEC_M_Q

Total time of outage during clear-air for the worst month. Value is formatted is unit (hour, mn, sec). Ex: "6 sec", "19mn 27 sec".

Version ≥: 2.6.1
Type: String

OBJ_M_Q

Quality objective during clear-air for the worst month. Value is formatted Version ≥: 2.6.1
is unit (hour, mn, sec)
Type: String

SEC_Y_Q

Total time of outage during clear-air for an average year month. Value is Version ≥: 2.6.1
formatted is unit (hour, mn, sec)
Type: String

SEC_M_RAIN

Total time of outage during rain condition for the worst month. Value is Version ≥: 2.6.1
formatted is unit (hour, mn, sec). Ex: "6 sec", "19mn 27 sec"
Type: String

OBJ_M_RAIN

Quality objective during rain condition for the worst month. Value is for- Version ≥: 2.6.1
matted is unit (hour, mn, sec)
Type: String

SEC_Y_RAIN

Total time of outage during rain condition for an average year month.
Value is formatted is unit (hour, mn, sec)

STATUS_Q

Version ≥: 2.6.1
Type: String

Status of the link for quality. Takes into account each probability and cor- Version ≥: 2.6.1
responding objective for SESR, ESR and BBER, according to the equip- Type: String
ment hierarchy too.
The status can have following values: "OK"; "Not Respected"; "Not Calculated"; "Not Defined";

STATUS_A

Status of the link for avalability. Takes into account each probability and Version ≥: 2.6.1
corresponding objective for SESR, ESR and BBER, according to the equip- Type: String
ment hierarchy too.
The status can have following values: "OK"; "Not Respected"; "Not Calculated"; "Not Defined";

CFM

Value of the composite fade margin (dB) which takes into account all the Version ≥: 2.6.1
margins; Corresponds to the SESR probability.
Type: String

REQ_CFM_Q

Value of the composite fade margin (dB) calculated from the quality
objectives set for the link.

REQ_TFM

202

Version ≥: 2.6.1
Type: String

Value of the uniform margin (dB) calculated from the quality objectives Version ≥: 2.6.1
set for the link. Corresponds to the non-selective outage probability.
Type: String

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Name

Description

Attributes

REQ_CFM_A

Value of the composite fade margin (dB) calculated from the availability Version ≥: 2.6.1
set for the link.
Type: String

TX_PORT

Transmission port.

Version ≥: 3.1.0
Type: String

RX_PORT

Reception port.

Version ≥: 3.1.0
Type: String

Analysis Results With Interference Calculation
Name
LINKNAME

Description
Name (primary key) of the link whose results are given.

Attributes
Version ≥: 2.6.1
Type: String

WAY

Way of the link which is concerned with this result.

Version ≥: 2.6.1

"AB" means "go" (= Site A toward Site B)

Type: String

"BA" means "return" (= Site B toward Site A)
CHANNEL_IRX
SUBBAND

Calculated interfered channel number.

Version ≥: 2.6.1

If the link has manual frequency, channel number is "-1".

Type: String

Name (primary key) of the subband of the link with the suffixe "[-]" or "[+]" Version ≥: 2.6.1
depending on the half subband of the link.
Type: String
"[-]" means lowest part
"[+]" means highest part.
Can be null if the link has manual frequencies.

C

Wanted signal level (dBm) Takes into account the transmitted power,
Version ≥: 2.6.1
transmitter and receiver losses, total propagation losses and decoupling. Type: Single
Same value as RX_LEVEL when running analysis without interference.

FLAT_MARGIN

Value of the uniform margin (dB) calculated from the wanted signal level Version ≥: 2.6.1
and the receiver threshold.
Type: Single

I

Aggregation of all the interferences (dBm) received from other links and Version ≥: 2.6.1
receiver thermal noise (FKTB).
Type: Single

MARGIN_REDUCT

Value of the differences between margin without interference and margin Version ≥: 2.6.1
with interferences.
Type: String

C_OVER_I

Value of C/I (dB) where C is the wanted signal level and I the total inter- Version ≥: 2.6.1
ference level.
Type: Single

IRAIN

Value of the total interference level during rain condition which can be dif- Version ≥: 2.6.1
ferent from the "general" interference level depending on correlation
Type: Single
between links.

MARGIN_REDUCT_RAIN

Value of the differences between margin without rain interference and
margin with interferences.

Version ≥: 2.6.1

Value of the margin calculated from the receiver threshold and the
received level when interference are taken into account.

Version ≥: 2.6.1

Value of the BER with which the current analysis is run.

Version ≥: 2.6.1

EFF_MARGIN
BER

Type: String
Type: Single
Type: Single

QUALITY

Percent of outage which determined the quality of the link. (i.e during
clear air conditions, and with interference).

Version ≥: 2.6.1
Type: Single

AVAIL

Percent of fadings due to rain for the worst month, when interference are Version ≥: 2.6.1
taken into account.
Type: Single

SEC_M_Q

Total time of outage with interference during clear-air for the worst
month. Value is formatted is unit (hour, mn, sec). Ex: "6 sec", "19mn 27
sec"

OBJ_M_Q

© 2022 Forsk. All Rights Reserved.

Version ≥: 2.6.1
Type: String

Quality objective during clear-air for the worst month. Value is formatted Version ≥: 2.6.1
is unit (hour, mn, sec)
Type: String

203

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Name

Description

Attributes

SEC_Y_Q

Total time of outage with interference during clear-air for an average year Version ≥: 2.6.1
month. Value is formatted is unit (hour, mn, sec)
Type: String

SEC_M_RAIN

Total time of outage with interference during rain condition for the worst Version ≥: 2.6.1
month. Value is formatted is unit (hour, mn, sec). Ex: "6 sec", "19mn 27 Type: String
sec"

OBJ_M_RAIN

Quality objective during rain condition for the worst month. Value is for- Version ≥: 2.6.1
matted is unit (hour, mn, sec)
Type: String

SEC_Y_RAIN

Total time of outage with interference during rain condition for an average Version ≥: 2.6.1
year month. Value is formatted is unit (hour, mn, sec)
Type: String

STATUS_Q

Status of the link for quality. Takes into account each probability and cor- Version ≥: 2.6.1
responding objective for SESR, ESR and BBER, according to the equip- Type: String
ment hierarchy too.
The status can have following values: "OK"; "Not Respected"; "Not Calculated"; "Not Defined";

STATUS_A

Status of the link for avalability. Takes into account each probability and Version ≥: 2.6.1
corresponding objective for SESR, ESR and BBER, according to the equip- Type: String
ment hierarchy too.
The status can have following values: "OK"; "Not Respected"; "Not Calculated"; "Not Defined";

PORT_IRX

Interferenced Port

Version ≥: 3.1.0
Type: Single

13.24 EXPORTMAPWINDOW
Exports a region of the map window as an image.
Version
≥ 3.1.0
Input Parameters
Name
REGION

Description

Attributes

The region to export. Available values are:

Version ≥: 3.1.0

0: The region to export is specified by SELECTIONXMIN, SELECTIONXMAX, SELECTIONYMIN, and SELECTIONYMAX input parameters.

Type: Integer

1:The region to export is the geographic export zone.
2:The region to export is the printing zone.
SELECTIONXMIN

The west coordinate of the region to export, expressed in meter in the pro- Version ≥: 3.1.0
jection coordinate system of the document.
Type: Double
Only used when the REGION input parameter is set to 0.

SELECTIONXMAX

The east coordinate of the region to export, expressed in meter in the pro- Version ≥: 3.1.0
jection coordinate system of the document.
Type: Double
Only used when the REGION input parameter is set to 0.

SELECTIONYMIN

The south coordinate of the region to export, expressed in meter in the Version ≥: 3.1.0
projection coordinate system of the document.
Type: Double
Only used when the REGION input parameter is set to 0.

SELECTIONYMAX

The north coordinate of the region to export, expressed in meter in the pro- Version ≥: 3.1.0
jection coordinate system of the document.
Type: Double
Only used when the REGION input parameter is set to 0.

PATH

The absolute path of the file where the map window image is exported. Version ≥: 3.1.0
Type: String

204

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Name
FORMAT

Description

Attributes

The file format used to export the map window image. Available values Version ≥: 3.1.0
are:
Type: String
BMP : BMP file format
PNG : PNG file format
ARCVIEWGRIDASCII : ArcView grid file format
TIF : TIFF file format
BIL : BIL file format
JP2 : JPEG 2000 file format

PIXELSIZE

Pixel size (meters), used to export the map window image.

Version ≥: 2.8.1

When the value specified is zero (0), then SCALE and RESOLUTION input Type: Integer
parameters are used to determine the pixel size.
SCALE

Scale of the map window used to export the map window image.

Version ≥: 3.1.0

Only used when the PIXELSIZE input parameter is set to 0.

Type: Integer

RESOLUTION

Resolution of the map window used to export the map window image, in Version ≥: 3.1.0
dot per inch.
Type: Integer
Only used when the PIXELSIZE input parameter is set to 0.

INCLUDERULERS

Boolean value used to specify whether to include rulers in the exported Version ≥: 3.1.0
image, or not.
Type: Boolean
Only used when the PIXELSIZE input parameter is set to 0.

INCLUDESCALE

Boolean value used to specify whether to include the scale in the exported Version ≥: 3.2.1
image, or not.
Type: Boolean

Default Parameters
None. GetCommandDefaults for the command EXPORTMAPWINDOW returns an empty PropertyContainer object.
Results
None. The map window image is exported to the file specified by the PATH input parameter.

13.25 IMPORTPLANETDATAFILE
Imports a planet data file.
Version
≥ 3.1.0
Input Parameters
Name
PATH

Description
The absolute path of the planet data file to import.

Attributes
Version ≥: 3.1.0
Type: String

EMBED

Whether to embed data, or not.

Version ≥: 3.1.0
Type: Boolean

© 2022 Forsk. All Rights Reserved.

205

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Name
TYPE

Description

Attributes

The type of the planet data file to import. Available values are:

Version ≥: 3.1.0

◼ 0 : Digital terrain model

Type: Integer

◼ 1: Digital height model
◼ 2 : Clutter classes
◼ 3 : Environment based traffic map
◼ 4: Planet vectors
◼ 5: Planet text data
◼ 6: Images
◼ 7: Antennas
◼ 8: Microwave antennas

BEAMTYPE

The type of beam to import. Available values are:

Version ≥: 3.4.1

◼ 0: All types

Type: Integer

◼ 1: Traffic
◼ 2: Control
◼ 3: Refinement

Default Parameters
None. GetCommandDefaults for the command IMPORTPLANETDATAFILE returns an empty PropertyContainer
object.
Results
None. The planet data is imported.

13.26 EXPORTMWLINKANALYSISPROFILEPICTURE
Exports a microwave link analysis profile picture to a Windows bitmap file.
Version
≥ 3.1.0
Input Parameters
Name
LINKNAME

Description
Name of the link.

Attributes
Version ≥: 3.1.0
Type: String

LINKTYPE

Link type. Available values are:

Version ≥: 3.1.0

0 : A -> B

Type: Integer

1 : B ->A
PICTUREWIDTH

Picture width, in pixels.

Version ≥: 3.1.0
Type: Integer

PICTUREHEIGHT

Picture height, in pixels.

Version ≥: 3.1.0
Type: Integer

FILEPATH

The absolute path of the Windows bitmap file where the link analysis pic- Version ≥: 3.1.0
ture is exported.
Type: String

Default Parameters
None.GetCommandDefaults for the command EXPORTMWLINKANALYSISPROFILEPICTURE returns an empty
PropertyContainer object.
Results
None. The picture of the link profile is exported to the file specified by FILEPATH input parameter.

206

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

13.27 GETPOWERMODE
Retreives the document current power mode.
This command is only available for UMTS or LTE technologies.
Version
≥ 3.1.0
Input Parameters
Name
TECHNOLOGY

Description

Attributes

For single RAT documents, this parameter is not used. For multi-RAT
Version ≥: 3.1.0
parameter, a string used to specify the technology. Available values are: Type: String
"UMTS",
"LTE"

Default Parameters
None. GetCommandDefaults for the command GETPOWERMODE returns an empty PropertyContainer object.
Results
Name
POWERMODE

Description

Attributes

The power mode for EIRP calculations. Available values are:

Version ≥: 3.1.0

0 : default

Type: Integer

1 : EIRP is calculated using the max power

13.28 SETPOWERMODE
Sets the document power mode for EIRP calculations.
This command is only available for UMTS, LTE, and 4G/5G technologies.
Version
≥ 3.1.0
Input Parameters
Name
TECHNOLOGY

Description

Attributes

For single RAT documents, this parameter is not used. For multi-RAT
Version ≥: 3.1.0
parameter, a string used to specify the technology. Available values are: Type: String
◼ "UMTS" for UMTS documents
◼ "LTE" for legacy LTE documents
◼ "XG" for 4G/5G documents

POWERMODE

The power mode. Available values are:
◼ 0 : default

Version ≥: 3.1.0
Type: Integer

◼ 1 : EIRP is calculated using the max power

Default Parameters
None. GetCommandDefaults for the command SETPOWERMODE returns an empty PropertyContainer object.
Results
None. The document power mode is changed.

© 2022 Forsk. All Rights Reserved.

207

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

13.29 APPENDVECTORDATACOLUMN
This command adds a new column to a vector data table.
Version
≥ 3.1.1
Input Parameters
Name

Description

Attributes

CHILDFOLDER

The CHILDFOLDER input parameter is used to specify a vector data table. Version ≥: 3.1.1
The ChildFolder object specified must support the VECTORDATA prop- Type: ChildFolder object
erty.

NAME

The NAME input parameter is used to specify the name of the new column Version ≥: 3.1.1
to add to the vector data table. The value is case insensitive and must not Type: String
include spacesand dot characters.

LEGEND

The LEGEND input parameter is used to specify the display name of the Version ≥: 3.1.1
new column to add to the vector data table. The value is case sensitive Type: String
and space characters are allowed.

TYPE

The TYPE input parameter is used to specify the data type of the new col- Version ≥: 3.1.1
umn to add to the vector data table. Valid values are:
Type: Integer
0=Text
1=Short integer
2=Long integer
3=Single
4=Double
5=True/False
6=Date/Time
7=Currency

SIZE

The SIZE input parameter is used to specify the size, in bytes, for a column Version ≥: 3.1.1
of type 0 (Text).
Type: Integer
The SIZE input parameter is specific to the text data type.

DEFAULT

The DEFAULT input parameter is used to specify the default value of the
new column. The default value is the column value for new rows, when
the column value is not set explicitly. When the DEFAULT input parameter
is not specified, the default value for the new column is Null (VT_NULL).
The type of the DEFAULT input parameter value must match the data type
of the new column, as specified by the TYPE input parameter.

CHOICELIST

Version ≥: 3.1.1
Type: Null, String, Integer, Boolean, Single,
Double, Currency, or
Date

The CHOICELIST input parameter is used to specify the list of possible Version ≥: 3.1.1
values for a new column of type 0 (Text).
Type: Array of Strings
The CHOICELIST input parameter is specific to text columns.
Please note that the actual column value is not restricted to the values
defined in the choice list. The CHOICELIST parameter may be used by
Atoll to display preferred values to the user, for instance in a combobox
control.

Default Parameters
None.
Results
None. Upon successful completion the new column is added to the table.

13.30 LOADSAVEPRINTSETUP
This command loads or saves the print setup configuration.

208

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

Version
≥ 3.1.1
Input Parameters
Name
DIRECTION

Description

Attributes

The DIRECTION input parameter is used to specify whether to load or
save the print setup configuration.

Version ≥: 3.1.1
Type: Integer

To load the print setup configuration, specify the value 1.
To save the print setup configuration, specify the value 0.
PRINTERNAME

PATH

The PRINTERNAME input parameter is used to specify the default printer Version ≥: 3.1.1
to use in the print setup configuration.
Type: String
This input parameter is not used when saving the print setup configuration.
When loading the print setup configuration, the CFGPATH input

Version ≥: 3.1.1

parameter is used to specify the file used to load the print setup config- Type: String
uration.
When saving the print setup configuration, the CFGPATH input
parameter is used to specify the file used to save the print setup configuration.

Default Parameters
None.
Results
Name
PRINTERNAME

Description
The PRINTERNAME output

Attributes
Version ≥: 3.1.1

parameter is used to return the default printer used int Type: String
the print setup configuration file..

13.31 CALCULATEPATHLOSS
Performs pathloss matrix calculation on a transmitter folder.
Version
≥ 3.2.0
Input Parameters
Name
TRANSMITTERFOLDER

Description
A sub-folder of the transmitters folder, or the transmitters folder itself.

Attributes
Version ≥: 2.6.1
Type: ChildFolder object

FORCECALCULATION

When True, the calculation is forced even for transmitters having avail- Version ≥: 3.2.0
able valid results. When
Type: Boolean
False, the calculation is made only for transmitters having unavailable or
invalid results.

BLOCKING

The boolean value used to specify whether the calculations will occur in Version ≥: 3.2.0
the background
Type: Boolean
(False), or if the method should wait for the calculations to finish before
returning (True).

FILTERED

When False, the calculation is made for all active transmitters in the trans- Version ≥: 3.2.0
mitter folder. When True, only
Type: Boolean
filtered transmitters are calculated

© 2022 Forsk. All Rights Reserved.

209

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Default Parameters
None. GetCommandDefaults for the command CALCULATEPATHLOSS returns an empty PropertyContainer object.

13.32 MWLINKSCUSTOMEXPORT
Performs microwave links custom export.
Version
≥ 3.2.0
Input Parameters
Name
EXPORTPATH

Description

Attributes

Full path to the folder where link reports are exported.

Version ≥: 2.6.1
Type: String

TEMPLATEFILEPATH

Full path to the custom template used to perform the export.

Version ≥: 3.2.0
Type: String

LINKSFOLDER

The microwave links folder containing links to export to the EXPORTPATH folder, using the TEMPLATEFILEPATH custom template.

Version ≥: 3.2.0
Type: ChildFolder object

Default Parameters
None. GetCommandDefaults for the command MWLinksCustomExport returns an empty PropertyContainer object.

13.33 ARCHIVETODATABASE
Archives a project to the database.
Version
≥ 3.2.1
Input Parameters
Name
IGNOREALLCONFLICTS

Description

Attributes

A boolean used to specify whether to ignore all conflicts when archiving. Version ≥: 3.2.1
Type: Boolean

Default Parameters
None. GetCommandDefaults for the command ARCHIVETODATABASE returns an empty PropertyContainer object.
Results
Name
ARCHIVESTATUS

Description

Attributes

The archive operation status.

Version ≥: 3.2.1

Available values are:

Type: Integer

◼ 0: The archive operation has succeeded.
◼ 1: The archive operation has been interrupted because of conflicts.

210

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

13.34 REFRESHFROMDATABASE
Performs a refresh from the database and optionally generates a report that summarises the differences between
the data before and after refresh.
Version
≥ 3.4.0
Input Parameters
Name
SKIPCHANGES

MODIFICATIONSREPORT

Description

Attributes

A boolean used to specify whether to ignore changes when refreshing
from the database.

Version ≥: 3.4.0

A string containing the absolute path of the report (optional).

Version ≥: 3.4.0

Type: Boolean

Type: String

Default Parameters
None. GetCommandDefaults for the command REFRESHFROMDATABASE returns an empty PropertyContainer
object.
Results
Name
REFRESHSTATUS

Description

Attributes

The refresh operation status.

Version ≥: 3.4.0

Available values are:

Type: Integer

◼ 0: The refresh operation has succeeded.
◼ 1: The refresh operation has been interrupted because of conflicts.

13.35 MWCALCULATEPROFILES
Calculates Microwave profile files.
Version
≥ 3.3.0
Input Parameters
Name
LINKS

Description

Attributes

Array containing the names of the links to be calculated. These include Version ≥: 3.3.0
the links which are filtered, active, and inside the focus zone.
Type: Array of Strings
This is the same list which is used by Atoll when running calculation on
the Links folder.
If not set, this defaults to the name of filtered links whose all sites are in
the computation zone. When there is no computation zone, this defaults
to all filtered links.

FORCECALCULATE

When True, the calculation is forced even for microwave profiles that
have available valid results.

Version ≥: 3.3.0
Type: Boolean

When False, the calculation is made only for microwave profiles that
have unavailable or invalid results.

© 2022 Forsk. All Rights Reserved.

211

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

Name

Description

Attributes

INTERFERENCEDISTANCEMAX

Defines the maximum distance (in meters) to search for potential inter- Version ≥: 3.3.0
ferers.
Type: Double
If not set, the default value is 50000.

PRIVATESTORAGE

Path to the profile files folder.

Version ≥: 3.3.0

If not set, the default value is the one set in the Atoll document.

Type: String

Default Parameters
None. GetCommandDefaults for the command MWCalculateProfiles an empty PropertyContainer object.

13.36 RUNBEAMUSAGECALCULATION
Calculates the beam usage ratios. The calculations occur in the background.
Version
≥ 3.4.1
Input Parameters
Name
RAT

Description

Attributes

The RAT for which you want to calculate the beam usage ratios
◼ 0: LTE.

Version ≥: 3.4.1
Type: Integer

◼ 2: 5GNR (default).

LAYERS

Names of the network layers that you want the calculations to take Version ≥: 3.4.1
into account, separated by ";"
Type: String
"-1" for all layers (default).
Example: "Macro Layer;Small Cell Layer"

CARRIERS

Names of the frequency carriers that you want the calculations to
take into account, separated by ";"

Version ≥: 3.4.1
Type: String

"-1" for all carriers (default).
Example: "50 MHz - NR-ARFCN 621667;10 MHz - NR-ARFCN 620333"
DIRECTIONS

The direction for which you want to calculate the beam usage ratios. Version ≥: 3.4.1
◼ 1: Downlink.

Type: Integer

◼ 2: Uplink.
◼ 3: Downlink and Uplink (default).

CELLTYPE

The Cell type for which you want to calculate beam usage, represented by a bitset combination of the aggregation levels

Version ≥: 3.4.1
Type: Integer

◼ 1: Primary Cell (default).
◼ 2: 1st aggregated cell.
◼ 4: 2nd aggregated cell.
◼ ...

5GMODE

The deployment Mode for which you want to calculate beam usage Version ≥: 3.4.1
ratios
Type: Integer
◼ 0: Stand-alone (default).
◼ 1: Non stand-alone.

SHADOWING

Whether to calculate shadowing margins related to the defined cell Version ≥: 3.4.1
edge coverage probability and the standard deviation(s) per clutter Type: Integer
class or not.
◼ True: Shadowing is considered (default).
◼ False: No shadowing effect is considered.

212

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

AT350_TAG_E3

EDGECOVERAGEPROBABILITY

A value between 0 and 100, expressing in percentage value the
required coverage probability at the cell edge.

Version ≥: 3.4.1
Type: Single

Default is 90.
INDOORCOVERAGE

Whether to decrease the received signal level at the receiver of the Version ≥: 3.4.1
indoor loss defined for the corresponding clutter class (clutter class Type: Integer
properties).
Default is False.

RESOLUTION
CALCULATIONCRITERION

The resolution in meters used to calculate the beam usage ratios.

Version ≥: 3.4.1

Default is 50.

Type: Double

The criterion on which the calculation is based.

Version ≥: 3.4.1

◼ 0: Surface areas covered by beams (default).

Type: Integer

◼ 1: Traffic Maps: Number of users covered by beams.

TRAFFIC3DDISTRIBUTION

Whether to calculate the best beams in 3D considering building
heights and floors or not.

Version ≥: 3.4.1
Type: Integer

Default is False.
AVERAGEFLOORHEIGHT
MAXIMUMBUILDINGHEIGHT
TERMINAL

The Average height of a storey in metres for 3D traffic distribution. Version ≥: 3.4.1
Default is 3.

Type: Single

The Building maximum height in metres for 3D traffic distribution.

Version ≥: 3.4.1

Default is 200.

Type: Single

The name of the terminal type. This parameter is mandatory.

Version ≥: 3.4.1
Type: String

MOBILITY

The name of the mobility type. This parameter is mandatory.

Version ≥: 3.4.1
Type: String

SERVICE

The name of the service type. This parameter is mandatory.

Version ≥: 3.4.1
Type: String

TRAFFICMAPS

One or more traffic maps to use for calculations based on Traffic
maps: Number of users covered by beams.

Version ≥: 3.4.1
Type: Array of Strings

Results
Upon successful execution, the beam usage ratios are calculated and stored in the cell table properties.

© 2022 Forsk. All Rights Reserved.

213

Atoll 3.5.0 Task Automation Guide
Chapter 13: Document Commands

214

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 14: Enumerations

AT350_TAG_E3

14 Enumerations
14.1 Enumerations
Enumerations are used to specify constants. Two categories of enumerations are defined hereafter.

14.1.1

14.1.1.1

◼

The first category refers to all enumerations defined in the Atoll type library. All of them are prefixed with Ato.

◼

The second category refers to all enumerations defined in the FSKGIS type library. All of them are prefixed with
fg.

Atoll Type Library Enumerations

AtoSaveStatus
Constant

14.1.1.2

Value

atoSaveSucceeded

0

Document has been successfully saved.

atoSaveCanceled

1

Changes in the document has been cancelled by the user.

AtoSaveChanges
Constant

14.1.1.3

Value

Description

atoSaveNo

0

Document is closed without being saved.

atoSaveYes

1

Document is saved before being closed.

atoSavePrompt

2

The user is prompted whether the document must be saved before being
closed.

AtoRefreshPriority
Constant

14.1.1.4

Description

Value

Description

atoCancelChanges

0

All changes are cancelled before the document is refreshed from the
database.

atoSkipChanges

1

Only refreshes data that have not been modified.

AtoArchiveStatus
Constant

Value

Description

atoArchiveSaveSucceeded

0

Archiving has succeeded without conflicts.

atoArchiveCanceled

1

Archiving has been cancelled, either by the user or because conflicts
occurred.

© 2022 Forsk. All Rights Reserved.

215

Atoll 3.5.0 Task Automation Guide
Chapter 14: Enumerations

14.1.1.5

AtoWindowStatus
Constant

14.1.1.6

Value

atoMaximized

0

Maximized (enlarged to maximum size).

atoNormal

1

Normal (Default).

atoMinimized

2

Minimized (minimized to an icon in the task bar).

AtoLogType
Constant

14.1.1.7

Value
0

Information.

atoError

1

Error.

atoWarning

2

Warning.

AtoCompareOp
Value
0

(Equal) The first value equal to searchVal is searched for.

atoLT

1

(Strictly Lower Than) The first value less than searchVal is searched for.

atoLE

2

(Lower or Equal) The first value less than or equal to searchVal is
searched for.

atoGE

3

(Greater or Equal) The first value greater than or equal to searchVal is
searched for.

atoGT

4

(Strictly Greater Than) The first value greater than searchVal is searched
for.

atoNE

5

(Not Equal) The first value not equal to searchVal is searched for.

AtoTransmissionUnit
Value

Description

atoDbm

0

Transmission unit is dBm.

atoWatt

1

Transmission unit is Watt.

atoKWatt

2

Transmission unit is kWatt.

AtoReceptionUnit
Constant

216

Description

atoEQ

Constant

14.1.1.9

Description

atoInfo

Constant

14.1.1.8

Description

Value

Description

atoDbmRx

0

Reception unit is dBm.

atoDbMicroVolt

1

Reception unit is dBV.

atoDbMicroVoltMeter

2

Reception unit is dBV/meter.

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 14: Enumerations

AT350_TAG_E3

14.1.1.10

AtoDistanceUnit
Constant

14.1.1.11

Value

atoM

0

Distance unit is meter.

atoKm

1

Distance unit is kilometer.

atoMiles

2

Distance unit is miles.

atoFeet

3

Distance unit is feet.

AtoRadiatedPowerUnit
Constant

14.1.1.12

Value
0

Radiated power is EIRP.

atoRadiatedPowerERP

1

Radiated power is ERP.

AtoAntennaGainUnit
Value
0

Antenna gain unit is dBi.

atoAntennaGainDbd

1

Antenna gain unit is dBd.

AtoHeightOffsetUnit
Value

Description

atoHeightOffsetM

0

Height offset unit is meter.

atoHeightOffsetFeet

1

Height offset unit is feet.

AtoRootType
Constant

14.1.1.15

Description

atoAntennaGainDbi

Constant

14.1.1.14

Description

atoRadiatedPowerEIRP

Constant

14.1.1.13

Description

Value

Description

atoData

0

Atoll explorer window data tab.

atoGeo

1

Atoll explorer window geo tab.

atoModule

2

Atoll explorer window modules tab.

atoParameters

2

Atoll explorer window parameters tab.

AtoRowFilter
Constants to filter only modified, added, or deleted rows.
Constant

Value

Description

atoRowFilterNone

0

No filter.

atoRowFilterModifiedOrNew

1

Filter to retain only modified or new rows.

atoRowFilterDeleted

2

Filter to retain only deleted rows.

© 2022 Forsk. All Rights Reserved.

217

Atoll 3.5.0 Task Automation Guide
Chapter 14: Enumerations

14.1.1.16

AtoRowStatus
All possible row statuses.
Constant

14.1.1.17

Value

atoRowStatusNew

1

Row has been added.

atoRowStatusModified

2

Row has been modified.

atoRowStatusDeleted

4

Row has been deleted.

atoRowStatusUnmodified

8

Row is unmodified.

AtoTemperatureUnit
Constant

14.1.2

14.1.2.1

Value
0

Temperature unit is degree Celsius (°C).

atoTempFarenheit

1

Temperature unit is degree Farenheit (°F).

FSKGISLib Type Library Enumerations

GeographicUnit
Value

Description

fgUnspecifiedUnit

-1

Value when nothing has been defined.

fgMeter

0

Length unit is meter.

fgKilometer

1

Length unit is kilometre.

fgFoot

2

Length unit is foot.

fgLink

3

fgChain

4

fgYard

5

Length unit is yard.

fgNauticalMile

6

Length unit is nautical mile.

fgMile

7

Length unit is mile.

fgRadian

100

Longitude / Latitude units are radian.

fgDegree

101

Longitude / Latitude units are degree.

fgGrad

102

Longitude / Latitude units are grads.

fgArcMinute

103

Longitude / Latitude units are minutes.

fgArcSecond

104

Longitude / Latitude units are seconds.

ProjectionMethod
Constant

218

Description

atoTempCelcius

Constant

14.1.2.2

Description

Value

Description

fgUndefinedProjection

0

Value when nothing has been defined.

fgNoProjection

1

This system has no projection method.

fgLambertConfConic1SP

2

Lambert Conformal Conic 1SP.

fgLambertConfConic2SP

3

Lambert Conformal Conic 2SP.

fgMercator

4

Mercator.

© 2022 Forsk. All Rights Reserved.

Atoll 3.5.0 Task Automation Guide
Chapter 14: Enumerations

AT350_TAG_E3

Constant

14.1.2.3

Value

Description

fgCassiniSoldner

5

Cassini Soldner.

fgTransverseMercator

6

Transverse Mercator.

fgTransvMercatorSouthOriented

7

Transverse Mercator South Oriented.

fgObliqueStereographic

8

Oblique Stereographic.

fgNewZealandMapGrid

9

New Zealand Map Grid.

fgHotineObliqueMercator

10

Hotine Oblique Mercator.

fgLabordeObliqueMercator

11

Laborde Oblique Mercator.

fgSwissObliqueCylindrical

12

Swiss Oblique Cylindrical.

fgObliqueMercator

13

Oblique Mercator.

fgUTMProjection

14

UTM Projection.

ProjParameterIndices
Constant

Value

Description

fgUTMZoneNumber

0

Number of UTM zone.

fgLongitudeOfOrigin

0

Longitude of the origin of the zone.

fgLatitudeOfOrigin

1

Latitude of the origin of the zone.

fgFalseEasting

2

False Easting.

fgFalseNorthing

3

False Northing.

fgScaleFactorAtOrigin

4

Scaling factor at the origin.

fgLatitudeOf1stParallel

4

Latitude of the first parallel.

fgAzimuthOfCentralLine

5

Azimuth of the central line.

fgLatitudeOf2ndParallel

5

Latitude of the second parallel.

fgAngleFromRectfifiedToSkewed- 6
Grid

© 2022 Forsk. All Rights Reserved.

219

Head Office

US Office

China Office

7 rue des Briquetiers
31700 Blagnac, France
Tel: +33 562 747 210
Fax: +33 562 747 211

200 South Wacker Drive – Suite 3100
Chicago, IL 60606, USA
Tel: +1 312 674 4800
Fax: +1 312 674 4847

Suite 302, 3/F, West Tower, Jiadu Commercial Building,
No. 66 Jianzhong Road, Tianhe Hi-Tech Industrial Zone,
Guangzhou, 510665, P. R. of China
Tel: +86 20 8553 8938 Fax: +86 20 8553 8285

AT350_TAG_E3

www.forsk.com

March 2022
